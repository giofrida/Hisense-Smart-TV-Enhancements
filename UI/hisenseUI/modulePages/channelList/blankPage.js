/**
 * Created by Administrator on 14-9-2.
 */

//try{
var chl_lang_text = {
    chi: {
        noSignal: "无信号",
        information: "信息",
        chlSelect: "频道列表选择",
        noProgram: "无节目",
        prgDetail: "节目详情",
        enterPwd: "请输入密码",
        reEnterPwd: "密码错误请重新输入",
        timerPowerOff: "1分钟后将关机",
        showInfo: "查看频道信息",
        showCHL: "查看频道列表",
        toSearch: "未保存任何频道列表，请开始搜索频道",
        startSearch: "开始搜台",
        cancel: "取消",
        ok: "确定",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"

    },
    eng: {
        noSignal: "No Signal",
        information: "Information",
        chlSelect: "Channel list selection",
        noProgram: "No Information Available",
        prgDetail: "Program details",
        enterPwd: "Please enter password",
        reEnterPwd: "Invalid password. Please re-enter",
        timerPowerOff: "Turn off in 1 minutes",
        showInfo: "View channel info",
        showCHL: "Call out channel list",
        toSearch: "No channel list is saved. Please scan channels",
        startSearch: "Begin scanning",
        cancel: "Cancel",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    ger: {
        noSignal: "Kein Signal",
        information: "Informationen",
        chlSelect: "Auswahl Senderliste",
        noProgram: "No Information Available",
        prgDetail: "Programmdetails",
        enterPwd: "Bitte Passwort eingeben",
        reEnterPwd: "Passwort ungültig. Bitte erneut eingeben",
        timerPowerOff: "In 1 Minuten ausschalten",
        showInfo: "Senderdaten anzeigen",
        showRecently: "Zuletzt angeschaute Sender aufrufen",
        toSearch: "Keine Senderliste gespeichert. Bitte nach Sendern suchen",
        startSearch: "Suche starten",
        cancel: "Abbrechen",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    ita: {
        noSignal: "Nessun segnale",
        information: "Informazioni",
        chlSelect: "Selezione lista di canali",
        noProgram: "No Information Available",
        prgDetail: "Dettagli di programma",
        enterPwd: "Si prega di inserire la password",
        reEnterPwd: "Password errata. Si prega di reinserirla",
        timerPowerOff: "Spegnere entro 1 minuti",
        showInfo: "Info per visualizzare il canale",
        showCHL: "Chiama la lista di canali",
        toSearch: "Non è stata salvata nessuna lista di canali. Si prega di eseguire la scansione dei canali.",
        startSearch: "Inizia la scansione",
        cancel: "Annulla",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    por: {
        noSignal: "Sem sinal",
        information: "Informação",
        chlSelect: "Seleção de lista de canais",
        noProgram: "No Information Available",
        prgDetail: "Detalhes do programa",
        enterPwd: "Introduza a palavra-passe",
        reEnterPwd: "Palavra-passe inválida. Volte a introduzi-la",
        timerPowerOff: "Desligar daqui a 1 minutos",
        showInfo: "Ver info. do canal",
        showCHL: "Chamar lista de canais",
        toSearch: "Não está guardada nenhuma lista de canais. Procure canais",
        startSearch: "Iniciar procura",
        cancel: "Cancelar",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    spa: {
        noSignal: "No hay señal",
        information: "Información",
        chlSelect: "Selección de la lista de canales ",
        noProgram: "No Information Available",
        prgDetail: "Detalles del programa",
        enterPwd: "Por favor, introduzca la contraseña",
        reEnterPwd: "Contraseña no válida. Por favor, vuelva a introducirla",
        timerPowerOff: "Apagar en 1 minutos",
        showInfo: "Ver info del canal",
        showCHL: "Diga en voz alta la lista de canales",
        toSearch: "No se guarda ninguna lista de canales. Por favor, busque canales",
        startSearch: "Comenzar la exploración",
        cancel: "Cancelar",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "estación de radio",
        moreInfo: "más información",
        sureExitPvr: "Sure to exit from PVR?"
    },
    fre: {
        noSignal: "Pas de signal",
        information: "Information",
        chlSelect: "Choix de liste de chaîne",
        noProgram: "No Information Available",
        prgDetail: "Détails programme",
        enterPwd: "Merci d'entrer le mot de passe",
        reEnterPwd: "Mot de passe incorrect. Merci de réessayer",
        timerPowerOff: "Extinction dans 1 minutes",
        showInfo: "Voir infos chaîne",
        showCHL: "Afficher liste de chaîne",
        toSearch: "Pas de liste de chaîne sauvegardée. Merci d'effectuer une recherche de chaînes",
        startSearch: "Démarrer la recherche",
        cancel: "Annuler",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "station de radio",
        moreInfo: "plus d'informations",
        sureExitPvr: "Sure to exit from PVR?"

    },
    nor: {
        noSignal: "Ingen signal",
        information: "Informasjon",
        chlSelect: "Kanalliste",
        noProgram: "No Information Available",
        prgDetail: "Programdetaljer",
        enterPwd: "Skriv inn passordet",
        reEnterPwd: "Ugyldig passord. Skriv inn på nytt",
        timerPowerOff: "Slå av om 1 minutter",
        showInfo: "Vis kanalinfo",
        showCHL: "Hent frem kanalliste",
        toSearch: "Ingen kanalliste er lagret. Søk etter kanaler",
        startSearch: "Start søk",
        cancel: "Avbryt",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    swe: {
        noSignal: "Ingen signal",
        information: "Information",
        chlSelect: "Val av kanal-lista",
        noProgram: "No Information Available",
        prgDetail: "Programdetaljer",
        enterPwd: "Ange lösenord",
        reEnterPwd: "Ogiltigt lösenord. Ange lösenordet igen",
        timerPowerOff: "Stäng av i 1 minuter",
        showInfo: "Visa kanalinformation",
        showCHL: "Utgående kanallista",
        toSearch: "Ingen kanallista har sparats. Skanna kanaler",
        startSearch: "Börja skanna",
        cancel: "Avbryt",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    dan: {
        noSignal: "Intet signal",
        information: "Oplysninger",
        chlSelect: "Kanalliste udvælgelse",
        noProgram: "No Information Available",
        prgDetail: "Program detaljer",
        enterPwd: "Indtast kodeord",
        reEnterPwd: "Ugyldig adgangskode. Prøv venligst igen",
        timerPowerOff: "Sluk i 1 minutter",
        showInfo: "Se kanal info",
        showCHL: "Ring ud kanalliste",
        toSearch: "Ingen kanalliste gemt. Venligst scan kanaler",
        startSearch: "Begynd at scanne",
        cancel: "Annuller",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    },
    fin: {
        noSignal: "Ei signaalia",
        information: "Informaatio",
        chlSelect: "Kanavalistan valinta",
        noProgram: "No Information Available",
        prgDetail: "Ohjelman tiedot",
        enterPwd: "Anna salasana",
        reEnterPwd: "Virheellinen salasana. Yritä uudelleen",
        timerPowerOff: "Sammuta 1 minuutin kuluttua",
        showInfo: "Katso kanavan tiedot",
        showCHL: "Pyydä kanavalista",
        toSearch: "Ei tallennettua kanavalistaa. Skannaa kanavia",
        startSearch: "Aloita skannaus",
        cancel: "Peruuta",
        ok: "OK",
        signalLevel: "Signal Level",
        signalQuality: "Signal Quality",
        cable: "Cable",
        antenna: "Antenna",
        mono: "Mono",
        stereo: "Stereo",
        sap: "SAP",
        fav: "Favorite",
        input:"Input",
        radioChannel: "Radio Channel",
        moreInfo: "More Info",
        sureExitPvr: "Sure to exit from PVR?"
    }
}
var chl_lang_map = {};
chl_lang_map[0] = "ger";
chl_lang_map[1] = "eng";
chl_lang_map[2] = "fre";
chl_lang_map[3] = "ita";
chl_lang_map[4] = "spa";
chl_lang_map[10] = "fin";
chl_lang_map[14] = "swe";
chl_lang_map[15] = "dan";
chl_lang_map[16] = "por";
chl_lang_map[18] = "nor";
chl_lang_map[19] = "chi";

var chl_currentLan = 'eng';
var chl_lang = null;
var chl_getNowEpg_status = false;
var chl_g_timeFormat = 1;
var chl_g_timeZone = 0;

var chl_keyValues = {
    "keyNum0": VK_0,
    "keyNum1": VK_1,
    "keyNum2": VK_2,
    "keyNum3": VK_3,
    "keyNum4": VK_4,
    "keyNum5": VK_5,
    "keyNum6": VK_6,
    "keyNum7": VK_7,
    "keyNum8": VK_8,
    "keyNum9": VK_9,
    "keyLeft": VK_LEFT,
    "keyUp": VK_UP,
    "keyRight": VK_RIGHT,
    "keyDown": VK_DOWN,
    "keyEnter": VK_ENTER,
    "keyReturn": VK_BACK,
    "keyChannelUp": VK_CHANNEL_UP,
    "keyChannelDown": VK_CHANNEL_DOWN,
    "keyInfo": VK_INFO,
    "keyRed": VK_RED,
    "keyGreen": VK_GREEN,
    "keyYellow": VK_YELLOW,
    "keyBlue": VK_BLUE,
    "keyPreCh": VK_PRE_CH,
    "keyChList": VK_CH_LIST,
    "keyTools": VK_TOOLS,
    "keyTimeShift": VK_T_SHIFT,
    "keyZoom": VK_ZOOM,
    "keyPicMode": VK_PICTURE,
    "keySoundMode": VK_S_MODE,
    "key3D": VK_CUSTOMER_3D,
    "keySubTitle": VK_SUBTITLE,
    "keyLanguage": VK_LANGUAGE,
    "keyPadUp": VK_KEYPAD_CHANNEL_UP,
    "keyPadDown": VK_KEYPAD_CHANNEL_DOWN,
    "keyShortLine": VK_SHORT_LINE,
    "keySource": VK_SOURCE,
    "keyText": VK_TELETEXT,
    "keyFAST_BKW": VK_FAST_BKW,
    "keyFAST_FWD": VK_FAST_FWD,
    "keyPause": VK_PAUSE,
    "keyPlay": VK_PLAY,
    "keyStop": VK_STOP,
    "keyEpg":VK_EPG,
    "keyPvr":VK_PVR


};

var chl_source_uid = [
    "TV", "AV", "COMPONENT","SCART","HDMI 1", "HDMI 2", "HDMI 3","HDMI 4"
];
var chl_liveTvUIShow = 0;
var chl_source_lock = [
    0, 0, 0, 0, 0, 0,0,0
];

var CHL_DTV_C = 3;
var CHL_DTV_T = 2;
var CHL_DTV_S = 4;
var CHL_ATV = 1;
var chl_g_wantShow = null;
var chl_g_blank_showStatus = true;
var chl_g_getChlistFinish = false;
var CHL_GET_DEFAULT = 1;
var CHL_GET_ING = 2;
var chl_g_getChlistStaus = CHL_GET_DEFAULT;
var chl_g_epgNow;
var chl_g_epgNext;
var CHL_ITEM_COUNT = 50;
var chl_g_chlCount = 0;

var chl_g_noSignal_cnt = 0;
var chl_g_channelInfo = null;
var chl_g_channelList = [];
var chl_g_channelListGlobal = [];
var chl_g_focusIndex = 0;
var chl_g_typeIndex = -1;
var chl_g_last_channelNum = null;
var chl_g_switchChannelNum = 0;
var chl_g_usbInfo = [];

var CHL_INFO_NORMAL = 0;
var CHL_INFO_NOW = 3;
var CHL_INFO_DETAIL = 1;
var CHL_INFO_NOPROGRAM = 2;

var chl_g_infoBar_mode = CHL_INFO_NOPROGRAM;

var chl_g_password = {
    pin: null,
    fullPin: null,
    allLock: 0,
    unLock: true //加锁不显示info
};

var chl_g_leftFocusLine = 0;

var chl_g_sourceInfo = {
    uid: null,
    channelNum: null,
    channelName: null,
    tvSource: null,
    tvStop: false,
    tvShowInfoBar: false,
    tvType: 0,
    signal: false,
    tvLock: false,
    lock: false
};

var chl_g_timer = {
    switchTvTimer: null,
    showChannelNumTimer: null,
    showInfoBarTimer: null,
    showInfoBarNoInforTimer: null,
    showOtherInfoBarTimer: null,
    showChannelListTimer: null,
    showChannelListLeftTimer: null,
    showProgramListTimer: null,
    showVolumeTimer: null,
    quickSwitchTvTimer: null,
    noSignalTimerShow: null,
    noSignalTimer: null,
    startToPowerOff: null,
    timerForQuick: null
};

var chl_g_timeout = {
    switchTvTimeout: 3 * 1000,
    showChannelNumTimeout: 3 * 1000,
    showInfoBarTimeout: 5 * 1000,
    showOtherInfoBarTimeout: 5 * 1000,
    showChannelListTimeout: 30 * 1000,
    showChannelListLeftTimeout: 30 * 1000,
    showProgramListTimeout: 30 * 1000,
    quickSwitchTimeout: 110
};

var chl_g_channelTypeList = [];


var chl_g_programList = {
    name: null,
    channelInfo: null,
    programInfo: []
};

var chl_g_channelNum = 0;
var chl_g_channelNumInput = false;
var chl_g_channelNumBits = 0;
var chl_g_keySimple_mode = false;
var chl_g_dpm_list = [];
var chl_g_keyFlag = true;
var chl_g_toRefresh = false;
var chl_g_dialogOpts = {
    okCommand: null,
    cancelCommand: null,
    focus: 1,
    status: false,
    info: null

};
var chl_g_inputPwdFocusIndex = 1;
var chl_g_tunerMode = 0;
var chl_g_showPowerOffTimerCnt = 60;
var chl_g_showPowerOffLan = 1;
var chl_g_keyManager = [
    {"name": "blankPage", "callback": chl_blankPageKeyProcess, "value": true, "hide": hideBlankNull, "startTimer": startBlankNull},
    {"name": "channelListPage", "callback": chl_channelListPageKeyProcess, "value": false, "hide": chl_forceHideChannelList, "startTimer": startNull},
    {"name": "channelListLeftPage", "callback": chl_channelListLeftPageKeyProcess, "value": false, "hide": chl_forceHideChannelListLeft, "startTimer": startNull},
    {"name": "programListPage", "callback": chl_programListPageKeyProcess, "value": false, "hide": chl_forceHideProgramList, "startTimer": startNull},
    {"name": "firstTvShowPage", "callback": chl_firstTvShowPageKeyProcess, "value": false, "hide": hideNull, "startTimer": startNull},
    {"name": "showDialog", "callback": chl_showDialogKeyProcess, "value": false, "hide": chl_forceHideDialog, "startTimer": startNull},
    {"name": "showInputPassword", "callback": chl_showInputPasswordKeyProcess, "value": false, "hide": chl_forceHideInputPassword, "startTimer": startNull},
    {"name": "showPowerOffDialog", "callback": chl_showPowerOffDialogKeyProcess, "value": false, "hide": chl_hideShowPowerOffDialog, "startTimer": startNull}
];

var chl_g_keyCodes = [VK_LEFT, VK_RIGHT, VK_UP, VK_DOWN, VK_ENTER, VK_MENU, VK_STOP, VK_EPG, VK_F1, VK_0, VK_1, VK_2,
    VK_3, VK_4, VK_5, VK_6, VK_7, VK_8, VK_9, VK_CHANNEL_UP, VK_CHANNEL_DOWN, VK_INFO, VK_RED, VK_GREEN, VK_YELLOW, VK_BLUE,
    VK_PIP, VK_HOME, VK_BACK, VK_PVR, VK_T_SHIFT, VK_PLAY, VK_PAUSE, VK_FAST_FWD, VK_FAST_BKW, VK_PRE_CH, VK_MEDIA, VK_LIVETV,
    VK_TOOLS, VK_LAST, VK_NEXT, VK_EXIT, VK_CH_LIST, VK_ZOOM, VK_PICTURE, VK_S_MODE, VK_CUSTOMER_3D, VK_LANGUAGE, VK_SUBTITLE,VK_TELETEXT,
    VK_KEYPAD_VOLUME_UP, VK_KEYPAD_VOLUME_DOWN, VK_KEYPAD_CHANNEL_UP, VK_KEYPAD_CHANNEL_DOWN, VK_SPACE, VK_A, VK_B, VK_C, VK_D,
    VK_E, VK_F, VK_G, VK_H, VK_I, VK_J, VK_K, VK_L, VK_M, VK_N, VK_O, VK_P, VK_Q, VK_R, VK_S, VK_T, VK_U, VK_V, VK_W, VK_X,
    VK_Y, VK_Z, VK_a, VK_b, VK_c, VK_d, VK_e, VK_f, VK_g, VK_h, VK_i, VK_j, VK_k, VK_l, VK_m, VK_n, VK_o, VK_p, VK_q, VK_r,
    VK_s, VK_t, VK_u, VK_v, VK_w, VK_x, VK_y, VK_z, VK_KB_Backspace, VK_KB_COMMA, VK_KB_DOT, VK_KB_SLASH, VK_KB_LT, VK_KB_GT,
    VK_KB_SEMICOLON, VK_KB_COLON, VK_KB_QUESTION, VK_KB_SQM, VK_KB_DQM, VK_KB_EM, VK_KB_AT, VK_KB_WELL, VK_KB_DOLLOR, VK_KB_PERSENT,
    VK_KB_JIAN, VK_KB_AND, VK_KB_STAR, VK_KB_LEFTBR, VK_KB_RIGHTBR, VK_KB_BIGLEFTBR, VK_KB_BIGRIGHTBR, VK_KB_LEFTBRACKET,
    VK_KB_RIGHTBRACKET, VK_KB_HOR, VK_KB_DASH, VK_KB_DUN, VK_KB_SUB, VK_KB_EQEAL, VK_KB_ADD, VK_KB_WAVE, VK_KB_RIGHTDASH,
    VK_KB_BlankString, VK_VOLUME_UP, VK_VOLUME_DOWN,
    // new added by bob
    VK_MUTE, VK_SOURCE, VK_SHORT_LINE, VK_ALLAPP, VK_NETFLIX, VK_AMAZON, VK_VUDU,
    VK_YOUTUBE, VK_CC, VK_INPUT, VK_SLEEP, VK_FAC_M, VK_KEYPAD_INPUT,VK_KEYPAD_MENU, VK_ASPECT];

function CHL_getRegKeySet(value)
{
    debugPrint("onHbbTvKeySetChanged:::::::::::::"+value,DebugLevel.ALWAYS);
    if(value == 0){
        keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(value)));
        return;
    }
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(value)));
}

function chl_getDivKeyCodes(value)
{
 var arrDivKeyCode= new Array();
 var j = 0;
 
 if(value & 0x1)
 {
	arrDivKeyCode[j++] = VK_RED;
 }
 
 if(value & 0x2)
 {
	arrDivKeyCode[j++] = VK_GREEN;
 }
 
 if(value & 0x4)
 {
	arrDivKeyCode[j++] = VK_YELLOW;
 }
 
 if(value & 0x8)
 {
	arrDivKeyCode[j++] = VK_BLUE;
 }
 
 if(value & 0x10)
 {
	arrDivKeyCode[j++] = VK_UP;
	arrDivKeyCode[j++] = VK_DOWN;
	arrDivKeyCode[j++] = VK_LEFT;
	arrDivKeyCode[j++] = VK_RIGHT;
	arrDivKeyCode[j++] = VK_ENTER;
	arrDivKeyCode[j++] = VK_BACK;
 }
 
 if(value & 0x20)
 {
	arrDivKeyCode[j++] = VK_PLAY;
	arrDivKeyCode[j++] = VK_PAUSE;
	arrDivKeyCode[j++] = VK_STOP;
	arrDivKeyCode[j++] = VK_NEXT;
	//arrDivKeyCode[j++] = VK_PREV;
	arrDivKeyCode[j++] = VK_LAST;
	arrDivKeyCode[j++] = VK_FAST_FWD;
	arrDivKeyCode[j++] = VK_FAST_BKW;
	//arrDivKeyCode[j++] = VK_PLAY_PAUSE;
 }
 
 if(value & 0x40)
 {
	arrDivKeyCode[j++] = VK_PAGE_UP;
	arrDivKeyCode[j++] = VK_PAGE_DOWN;
 }
 
 if(value & 0x80)
 {
	arrDivKeyCode[j++] = VK_INFO;
 }
 
 if(value & 0x100)
 {
	arrDivKeyCode[j++] = VK_0;
	arrDivKeyCode[j++] = VK_1;
	arrDivKeyCode[j++] = VK_2;
	arrDivKeyCode[j++] = VK_3;
	arrDivKeyCode[j++] = VK_4;
	arrDivKeyCode[j++] = VK_5;
	arrDivKeyCode[j++] = VK_6;
	arrDivKeyCode[j++] = VK_7;
	arrDivKeyCode[j++] = VK_8;
	arrDivKeyCode[j++] = VK_9;
 }
 
 if(value & 0x200)
 {
	arrDivKeyCode[j++] = VK_A;
	arrDivKeyCode[j++] = VK_B;
	arrDivKeyCode[j++] = VK_C;
	arrDivKeyCode[j++] = VK_D;
	arrDivKeyCode[j++] = VK_E;
	arrDivKeyCode[j++] = VK_F;
	arrDivKeyCode[j++] = VK_G;
	arrDivKeyCode[j++] = VK_H;
	arrDivKeyCode[j++] = VK_I;
	arrDivKeyCode[j++] = VK_J;
	arrDivKeyCode[j++] = VK_K;
	arrDivKeyCode[j++] = VK_L;
	arrDivKeyCode[j++] = VK_M;
	arrDivKeyCode[j++] = VK_N;
	arrDivKeyCode[j++] = VK_O;
	arrDivKeyCode[j++] = VK_P;
	arrDivKeyCode[j++] = VK_Q;
	arrDivKeyCode[j++] = VK_R;
	arrDivKeyCode[j++] = VK_S;
	arrDivKeyCode[j++] = VK_T;
	arrDivKeyCode[j++] = VK_U;
	arrDivKeyCode[j++] = VK_V;
	arrDivKeyCode[j++] = VK_W;
	arrDivKeyCode[j++] = VK_X;
	arrDivKeyCode[j++] = VK_Y;
	arrDivKeyCode[j++] = VK_Z;
	arrDivKeyCode[j++] = VK_a;
	arrDivKeyCode[j++] = VK_b;
	arrDivKeyCode[j++] = VK_c;
	arrDivKeyCode[j++] = VK_d;
	arrDivKeyCode[j++] = VK_e;
	arrDivKeyCode[j++] = VK_f;
	arrDivKeyCode[j++] = VK_g;
	arrDivKeyCode[j++] = VK_h;
	arrDivKeyCode[j++] = VK_i;
	arrDivKeyCode[j++] = VK_j;
	arrDivKeyCode[j++] = VK_k;
	arrDivKeyCode[j++] = VK_l;
	arrDivKeyCode[j++] = VK_m;
	arrDivKeyCode[j++] = VK_n;
	arrDivKeyCode[j++] = VK_o;
	arrDivKeyCode[j++] = VK_p;
	arrDivKeyCode[j++] = VK_q;
	arrDivKeyCode[j++] = VK_r;
	arrDivKeyCode[j++] = VK_s;
	arrDivKeyCode[j++] = VK_t;
	arrDivKeyCode[j++] = VK_u;
	arrDivKeyCode[j++] = VK_v;
	arrDivKeyCode[j++] = VK_w;
	arrDivKeyCode[j++] = VK_x;
	arrDivKeyCode[j++] = VK_y;
	arrDivKeyCode[j++] = VK_z;
 }
 
 if(value & 0x400)
 {
 }
 return arrDivKeyCode;
}

function chl_sortByNum(a,b)
{
	return a-b;
}

function chl_removeDivKeyCodes(allKeyCodes,divKeyCodes)
{
    if(divKeyCodes.length==0)
    {
	    return allKeyCodes;
    }
    allKeyCodes.sort(chl_sortByNum);
    divKeyCodes.sort(chl_sortByNum);
    var diff=[];
    var aIndex = 0;
    var dIndex= 0;
	
	while((aIndex < allKeyCodes.length)&&(dIndex < divKeyCodes.length))
	{
		if(allKeyCodes[aIndex] < divKeyCodes[dIndex])
		{
			diff.push(allKeyCodes[aIndex++]);
		}
		else if(allKeyCodes[aIndex] == divKeyCodes[dIndex]) 
		{
			aIndex++;
			dIndex++;
		}
		else
		{
			dIndex++;
		}
	}
	while(aIndex < allKeyCodes.length)
	{
		diff.push(allKeyCodes[aIndex++]);
	}
    
    return diff;
}

function chl_setRefreshChannelInfoCallback(callback) {
    chl_g_wantShow = callback;
}
function hideNull() {

}
function hideBlankNull() {
    clearTimeout(chl_g_timer.showOtherInfoBarTimer);
    clearTimeout(chl_g_timer.showInfoBarTimer);
    chl_g_timer.showOtherInfoBarTimer = null;
    chl_g_timer.showInfoBarTimer = null;
    chl_hideInfoBar();
    chl_clearNoSignalCounter();
    chl_ui_hideOtherSourceInfoBar();
}
function startNull() {

}
function startBlankNull() {
    if (chl_g_timer.showInfoBarTimer != null) {
        chl_g_timer.showInfoBarTimer = setTimeout(chl_ui_hideInfoBar, chl_g_timeout.showInfoBarTimeout);
    }
}

function CHL_initBlankPage() {
    return {};
}

function CHL_resumeBlankPage() {
    debugPrint('CHL_resumeBlankPage !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!' + chl_g_dpm_list.length);
    chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
}

function chl_callHideBlankPageBySelf() {
    debugPrint('chl_callHideBlankPageBySelf!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');
    //chl_liveTvUIOpen();
    for (var i = 0; i < chl_g_keyManager.length; i++) {
        if (chl_g_keyManager[i].value && !!chl_g_keyManager[i].hide) {
            debugPrint('CHL_hideBlankPage: ' + chl_g_keyManager[i].name);
            if (chl_getKeyManager() != "showInputPassword") {
                chl_g_keyManager[i].hide.call();
            }
            break;
        }
    }
    for (var j = 0; j < chl_g_dpm_list.length; j++) {
        if (chl_g_dpm_list[j].name == "showNoSignal") {
            chl_hideNoSignal();
            //break;
        } else if (chl_g_dpm_list[j].name == "showAudioOnly") {
            chl_hideAudioOnly();
        }

        if (chl_g_dpm_list[j].name == "showInputPassword") {
            // chl_ui_hideInputPassword();
        }
    }
}

function CHL_hideBlankPage() {
//    try {
//        closeMsgPage(false);
//    } catch (ex) {
//        debugE(ex.message);
//    }
    debugPrint('CHL_hideBlankPage !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!' + chl_g_dpm_list.length, DebugLevel.ALWAYS);

    try {
        chl_g_blank_showStatus = false;
        //chl_liveTvUIOpen();
        for (var i = 0; i < chl_g_keyManager.length; i++) {
            if (chl_g_keyManager[i].value && !!chl_g_keyManager[i].hide) {
                debugPrint('CHL_hideBlankPage: ' + chl_g_keyManager[i].name);
                chl_g_keyManager[i].hide.call();
                break;
            }
        }
        for (var j = 0; j < chl_g_dpm_list.length; j++) {
            if (chl_g_dpm_list[j].name == "showNoSignal") {
                chl_hideNoSignal();
                //break;
            } else if (chl_g_dpm_list[j].name == "showAudioOnly") {
                chl_hideAudioOnly();
            }

            if (chl_g_dpm_list[j].name == "showInputPassword") {
                // chl_ui_hideInputPassword();
            }
        }
    } catch (ex) {
        debugE(ex.message);
    }

    try {   //add by ghl, close the msg page
        // closeMsgPage(0, false);
        keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
    } catch (ex) {
        debugE(ex.message);
    }
    try {
        hiWebOsFrame.SendMheg5Status(0);
    } catch (ex) {
        debugE(ex.message);
    }
    debugPrint('CHL_hideBlankPage !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  end', DebugLevel.ALWAYS);
}

function CHL_setBlankPageShowInfoBar() {
    chl_g_sourceInfo.tvShowInfoBar = true;
}


function CHL_getChannelListSaved() {
    var status = false;
    for (var j = 0; j < chl_g_dpm_list.length; j++) {
        debugPrint("dpm name:" + chl_g_dpm_list[j].name);
        if (chl_g_dpm_list[j].name == "showStartToSearchCable" && chl_g_tunerMode == 2) {
            status = true;
        } else if (chl_g_dpm_list[j].name == "showStartToSearchAntenna" && chl_g_tunerMode == 1) {
            status = true;
        }
    }
    return status;
}
function CHL_focusBlankPage() {
    debugPrint('CHL_focusBlankPage !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!:' + chl_g_tunerMode, DebugLevel.ALWAYS);
    try{

    var lanNumber = model.language.getOsd();
    debugPrint('lanNumber: ' + lanNumber);
    chl_currentLan = chl_lang_map[lanNumber];
    chl_lang = (!!chl_lang_text[chl_currentLan]) ? chl_lang_text[chl_currentLan] : chl_lang_text['eng'];
    chl_g_showPowerOffLan = lanNumber;
    chl_getNoSignalMainChanged(null);//temp add.
    chl_g_password.pin = model.parentlock.getPin();
    chl_g_password.fullPin = g_SystemFallbackPwd;
    chl_g_timeFormat = model.timerfunc.getTimeFormat();
    var zone = model.timerfunc.getTimeZone();
    //chl_g_timeZone = model.timerfunc.getTimeZone();
    debugPrint("timezone:::::::::::::" + zone);
    //if(chl_g_timeZone<-13 || chl_g_timeZone>12){
    //   chl_g_timeZone = 0;
    //}
    try {
        switch (parseInt(zone)) {
            case 0:
                chl_g_timeZone = -5;//-5;
                break;
            case 1:
                chl_g_timeZone = -5;//-5;
                break;
            case 2:
                chl_g_timeZone = -6;//-6;
                break;
            case 3:
                chl_g_timeZone = -7;///-7;
                break;
            case 4:
                chl_g_timeZone = -7;//-7;
                break;
            case 5:
                chl_g_timeZone = -8;//-8;
                break;
            case 6:
                chl_g_timeZone = -9;//-9;
                break;
            case 7:
                chl_g_timeZone = -10;//-10;
                break;
            default:
                break;
        }
//    } catch (e) {
//        debugPrint(e.message);
//    }

    chl_g_tunerMode = model.channelSearch.getSource();
    for (var i = 0; i < chl_g_keyManager.length; i++) {
        if (chl_g_keyManager[i].value && !!chl_g_keyManager[i].startTimer) {
            chl_g_keyManager[i].startTimer.call();
            break;
        }
    }
    chl_playLastTv();
    if (getMainInputPasswordStatus()) {
        for (var j = 0; j < chl_g_dpm_list.length; j++) {
            if (chl_g_dpm_list[j].name == "showInputPassword") {
                chl_g_dpm_list.splice(i, 1);
                chl_g_inputPwdFocusIndex = 1;
                chl_ui_hideInputPassword();
                chl_g_password.unLock = true;
                break;
            }
        }
    } else {
        var lock = getCurrentLockTime();
        if (chl_source_lock[chl_g_sourceInfo.uid] == 1 && chl_g_sourceInfo.uid != 0 && lock) {
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "showInputPassword") {
                    chl_g_dpm_list.splice(i, 1);
                    break;
                }
            }
            var info = {};
            info.name = "showInputPassword";
            info.callback = "chl_showInputPassword";
            chl_g_dpm_list.push(info);
        }else if (chl_source_lock[chl_g_sourceInfo.uid] == 1 && chl_g_sourceInfo.uid != 0 && !lock) {
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "showInputPassword") {
                    chl_g_dpm_list.splice(i, 1);
                    break;
                }
            }
        }
    }

    var show = chl_refreshDpm();

    checkPageNeedShow();    //add by ghl

    debugPrint("chl_showInfoBar!!!!!!!!!!!" + chl_g_sourceInfo.tvShowInfoBar);
    if (chl_g_sourceInfo.tvShowInfoBar && chl_g_sourceInfo.tvSource && chl_g_channelInfo != null && !show) {
        debugPrint("chl_showInfoBar!!!!!!!!!!!");
        chl_g_timeout.showInfoBarTimeout = 5 * 1000;
        chl_showInfoBar(chl_g_channelInfo);
        //if (chl_g_channelInfo.tvType != CHL_ATV) {
        if (!chl_g_password.unLock) {
            return;
        }
        for (var j = 0; j < chl_g_dpm_list.length; j++) {
            if (chl_g_dpm_list[j].name == "showNoSignal") {
                return;
            }
        }
        chl_getNowEpg_status = false;
        model.tvservice.getChannelNowPfInfo();
        model.tvservice.getChannelNowPfInfoCallBack = chl_data_getDtvNowInfo;
        model.tvservice.getChannelNextPfInfo();
        model.tvservice.getChannelNextPfInfoCallBack = chl_data_getDtvNextInfo;
        chl_g_epgNow = null;
        chl_g_epgNext = null;
        chl_g_timer.showInfoBarNoInforTimer = setTimeout(function () {
            chl_showInfoBarRight(true, true,true);
        }, 3000);
        //setTimeout(chl_ui_showInfoBarNoProgram, 2000);
        // }
    } else if (chl_g_sourceInfo.tvShowInfoBar && !chl_g_sourceInfo.tvSource && chl_g_sourceInfo.channelName != null && !show) {
        chl_showOtherSourceInfoBar(chl_g_sourceInfo, true);
    }
    if (chl_g_sourceInfo.tvSource != null && chl_g_sourceInfo.tvSource && chl_g_channelInfo != null) {
//        for (var j = 0; j < chl_g_dpm_list.length; j++) {
//            if (chl_g_dpm_list[j].name == "showStartToSearchCable" && chl_g_tunerMode == 2) {
//                return;
//            } else if (chl_g_dpm_list[j].name == "showStartToSearchAntenna" && chl_g_tunerMode == 1) {
//                return;
//            }
//        }
        var playStatus = model.tvservice.getPlaySuccessLiveTV();
        var mode = model.hisfactory.getTofactoryOpition();
        debugPrint("chl_showFirstPlayTv  mode:::"+mode,DebugLevel.ALWAYS);
        if(mode != 0){
            if (playStatus == 0 && (chl_g_searchCntStatus||chl_g_searchByPlay ==2)) {
                if(chl_g_timeout.showInfoBarTimeout!= null || chl_g_timer.showInfoBarNoInforTimer!=null){
                    chl_hideInfoBar();
                }
                chl_showFirstPlayTv();
            }
        }
    }
    } catch (e) {
        debugPrint(e.message);
    }
    if (chl_getKeyManager() == "blankPage"){
        if(chl_g_sourceInfo.tvSource && chl_g_channelInfo!=null && chl_g_channelInfo.tvType!=CHL_ATV){
            var keySet = model.tvservice.getHbbTvKeySet();
            keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(keySet)));
        }else{
            keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
        }
    }else{
        keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
    }
    }catch(e){
        debugPrint(e.message, DebugLevel.ALWAYS);
    }

}

function CHL_getCurrentSource() {
    return $.extend({}, chl_g_sourceInfo);
}

function CHL_getCurrentChannelInfo() {
    return $.extend({}, chl_g_channelInfo);
}

function CHL_playTV() {

    chl_g_sourceInfo.tvSource = true;

}

function chl_refreshDpm() {
    chl_g_blank_showStatus = true;
    //chl_setKeyManager("blankPage");

    for (var j = 0; j < chl_g_dpm_list.length; j++) {
        debugPrint("dpm name:" + chl_g_dpm_list[j].name);
        if (chl_g_dpm_list[j].name == "chl_startAutoUpdate") {
            chl_startAutoUpdate();
            return true;
        } else if (chl_g_dpm_list[j].name == "chl_startHisenseAppUpdate") {
            chl_startHisenseAppUpdate();
            return true;
        }
        else if (chl_g_dpm_list[j].name == "showNoSignal") {
            chl_showNoSignal();
        } else if (chl_g_dpm_list[j].name == "showAudioOnly") {
            if (chl_g_sourceInfo.tvSource) {
                chl_showAudioOnly();
            }
        }
        else if (chl_g_dpm_list[j].name == "showInputPassword") {
            if ((chl_source_lock[chl_g_sourceInfo.uid] == 1 && !chl_g_sourceInfo.tvSource) || (!chl_g_password.unLock && chl_g_sourceInfo.tvSource)) {
                chl_showInputPassword();
                return true;
            }
        } else if (chl_g_dpm_list[j].name == "showStartToSearchCable") {
            if (chl_getKeyManager() == "blankPage" && chl_g_sourceInfo.tvSource && chl_g_tunerMode == 2) {
                chl_showStartToSearch();
                return true;
            }
        } else if (chl_g_dpm_list[j].name == "showStartToSearchAntenna") {
            if (chl_getKeyManager() == "blankPage" && chl_g_sourceInfo.tvSource && chl_g_tunerMode == 1) {
                chl_showStartToSearch();
                return true;
            }
        }
    }
    return false;
}

function CHL_clearInputPassword(){
    for (var i = 0; i < chl_g_dpm_list.length; i++) {
        if (chl_g_dpm_list[i].name == "showInputPassword") {
             chl_g_dpm_list.splice(i, 1);
             chl_g_password.unLock = true;
             //break;
        }else if(chl_g_dpm_list[i].name == "showNoSignal"){
             chl_g_dpm_list.splice(i, 1);
        }
    }
}
function chl_playLastTv() {

    if (chl_g_sourceInfo.tvSource != null) {
        debugPrint("launcher_player_stop:" + chl_g_sourceInfo.tvSource + ":" + chl_g_sourceInfo.tvStop);
        if (chl_g_sourceInfo.tvSource && chl_g_sourceInfo.tvStop) {
            chl_g_sourceInfo.tvStop = false;
            chl_g_sourceInfo.tvSource = true;
            if (0 == chl_g_sourceInfo.uid) {
                return;
            }
            CHL_clearInputPassword();
            model.source.InputSet(0);
            if (!getMainInputPasswordStatus()) {

            }else {
                model.parentlock.InputBlock(0, 0, 1);
            }
            ReadInputRecent("" + 0);
        }
    }

}

function CHL_DestroyPage() {
    debugPrint('who  Destroy me????????????????!!!');
    try {
        hiWebOsFrame.SendMheg5Status(0);
    } catch (ex) {
        debugE(ex.message);
    }
}

function CHL_blankPageKeyDown() {
    var keyInfo = {};
    keyInfo.keyCode = event.keyCode;
    keyInfo.state = "down";
    debugPrint("key manager:" + chl_getKeyManager());
    chl_processShortKey(keyInfo);
}

function CHL_blankPageKeyUp() {
    var keyInfo = {};
    keyInfo.keyCode = event.keyCode;
    keyInfo.state = "up";
    chl_processShortKey(keyInfo);
}

function CHL_blankPageKeyRepeated() {
    var keyInfo = {};
    keyInfo.keyCode = event.keyCode;
    keyInfo.state = "repeat";
    chl_processShortKey(keyInfo);
}
var chl_g_searchByPlay = 0;
function chl_initBlankPageData() {
    debugPrint('chl_initBlankPageData', DebugLevel.ALWAYS);
    chl_g_wantShow = null;

    chl_g_blank_showStatus = true;
    chl_g_getChlistFinish = false;

    chl_g_noSignal_cnt = 0;
    chl_g_channelInfo = null;
    chl_g_channelList = [];

    chl_g_focusIndex = 0;
    chl_g_typeIndex = -1;
    chl_g_last_channelNum = null;
    chl_g_switchChannelNum = 0;
    chl_g_searchByPlay = 0;


    chl_g_epgNow = {};
    chl_g_infoBar_mode = 2;

    chl_g_channelTypeList = [];
    chl_g_channelNum = 0;
    chl_g_channelNumInput = false;
    chl_g_channelNumBits = 0;
    chl_g_dpm_list = [];
    chl_g_keyFlag = true;
    chl_g_toRefresh = false;

    chl_g_password.pin = null;
    chl_g_password.fullPin = g_SystemFallbackPwd;
    chl_g_password.allLock = 0;
    chl_g_password.unLock = true;

    chl_g_tunerMode = model.channelSearch.getSource();
    chl_g_leftFocusLine = 0;
    chl_getNowEpg_status = false;

    chl_g_sourceInfo.uid = null;
    chl_g_sourceInfo.channelNum = null;
    chl_g_sourceInfo.channelName = null;
    chl_g_sourceInfo.tvSource = null;
    chl_g_sourceInfo.tvType = 0;
    chl_g_sourceInfo.signal = false;

    chl_g_programList.name = null;
    chl_g_programList.channelInfo = null;
    chl_g_programList.programInfo = [];
    if(hiWebOsFrame.getCurrentArea()=="EU"){
        chl_source_uid = [
            "TV", "AV", "COMPONENT", "SCART","HDMI 1", "HDMI 2", "HDMI 3","HDMI 4"
        ];

    }else{
        chl_source_uid = [
            "TV", "AV", "COMPONENT", "HDMI 1", "HDMI 2", "HDMI 3","HDMI 4","SCART"
        ];
    }


    chl_source_lock = [
        0, 0, 0, 0, 0, 0,0,0
    ];

    chl_g_searchCntStatus = false;
    chl_liveTvUIShow = 0;
    chl_g_sourceInfo.tvShowInfoBar = false;

    lastPlayUpTime = 0;
    lastPlayDownTime = 0;
    lastInputTime = 0;

    chl_keyRepeat = false;
    chl_firstRepeat = false;
    chl_g_getEpg = true;
    chl_g_getChlistStaus = CHL_GET_DEFAULT;

}

function CHL_initChannelList() {
    try{
        chl_initBlankPageData();
        CHL_startChannelList();
    }catch(e){
        debugPrint(e.message, DebugLevel.ALWAYS);
    }
}

function CHL_startChannelList() {
    try {
        hiWebOsFrame.clearEnablePageKeys(hiWebOsFrame.blankPage);
    } catch (e) {
        debugPrint(e.message);
    }
    model.tvservice.onMainPlayChanged = getCurrentPlay;
    model.source.onCurrentSourceChaged = chl_CurrentSourcePlay;
    model.channelSearch.onSourceChaged = chl_tunerModeChanged;
    chl_getNoSignalMainChanged(null);
    model.tvservice.onNoSignalMainChanged = chl_getNoSignalMainChanged;
    model.tvservice.onCurrentSourceVideoFormatChanged = chl_onCurrentSourceVideoFormatChanged;
    chl_getFirstPlay();

    chl_g_password.pin = model.parentlock.getPin();
    chl_g_password.fullPin = g_SystemFallbackPwd;
    model.softupdate.onAutoAnnouncementChaged = chl_softWareUpdateNotify;
    model.softupdate.onChagedHisenseAppUpdateAnnounced = onChagedHisenseAppUpdateAnnounced;
    model.tvservice.onHbbTvKeySetChanged = CHL_getRegKeySet;
    model.tvservice.onChannelListNameUpdate = onChannelListNameUpdate;
    model.tvservice.onChannelListUpdate = onChannelListUpdate;
    model.softupdate.StartSearch(100);
    debugPrint("start auto update thread");
    //chl_g_password.allLock = parseInt(model.parentlock.getAll());
}

function chl_softWareUpdateNotify(value) {
    debugPrint("!!!!!!!!!!!!!detect the software update notify!!!!!", DebugLevel.ALWAYS);

    if (value == 5) {
        if (chl_getKeyManager() != "blankPage" || !chl_g_blank_showStatus || hiWebOsFrame.getIsLoading()) {
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "chl_startAutoUpdate") {
                    chl_g_dpm_list.splice(i, 1);
                    break;
                }
            }
            var info = {};
            info.name = "chl_startAutoUpdate";
            info.callback = "chl_startAutoUpdate";
            chl_g_dpm_list.push(info);
        } else {
            debugPrint("start to upgrade");
            chl_startAutoUpdate();
        }
    }
}

function onChagedHisenseAppUpdateAnnounced(value) {
    debugPrint("!!!!!!!!!!!!!onChagedHisenseAppUpdateAnnounced!!!!!" + value, DebugLevel.ERROR);
    if (value == 5) {
        if (chl_getKeyManager() != "blankPage" || !chl_g_blank_showStatus) {
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "chl_startHisenseAppUpdate") {
                    chl_g_dpm_list.splice(i, 1);
                    break;
                }
            }
            var info = {};
            info.name = "chl_startHisenseAppUpdate";
            info.callback = "chl_startHisenseAppUpdate";
            chl_g_dpm_list.push(info);
        } else {
            chl_startHisenseAppUpdate();
        }
    }
}

function chl_startHisenseAppUpdate() {
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    for (var i = 0; i < chl_g_dpm_list.length; i++) {
        if (chl_g_dpm_list[i].name == "chl_startHisenseAppUpdate") {
            chl_g_dpm_list.splice(i, 1);
            break;
        }
    }
    hiWebOsFrame.lockAllKeys();
    try{
        closePagesOrModuleByPage(hiWebOsFrame.getCurrentPage());
        StartAppUpgrade(hiWebOsFrame.blankPage);
    }catch(e){
        debugE(e.message);
        hiWebOsFrame.unLockAllKeys();
    }

}

function chl_startAutoUpdate() {

    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    for (var i = 0; i < chl_g_dpm_list.length; i++) {
        if (chl_g_dpm_list[i].name == "chl_startAutoUpdate") {
            chl_g_dpm_list.splice(i, 1);
            break;
        }
    }
    hiWebOsFrame.lockAllKeys();
    try{
        closePagesOrModuleByPage(hiWebOsFrame.getCurrentPage());
        StartAutoUpdate(hiWebOsFrame.blankPage);
    }catch(e){
        debugE(e.message);
        hiWebOsFrame.unLockAllKeys();
    }

}
function chl_tunerModeChanged(value) {
    debugPrint("chl_tunerModeChanged: " + value, DebugLevel.ALWAYS);
    if (chl_g_tunerMode != value) {
        if (chl_g_channelInfo != null) {
            chl_savePreTVInfo();
            //chl_g_channelInfo = null;
            chl_g_typeIndex = 0;
            chl_g_focusIndex = 0;
        }
    } else {
        return;
    }
    chl_g_tunerMode = value;
}

function chl_getNoSignalMainChanged(value) {
    debugPrint("chl_getNoSignalMainChanged: " + value, DebugLevel.ALWAYS);
    if (value == null) {
        value = model.tvservice.getNoSignalMain();
        debugPrint("chl_getNoSignalMainChanged: " + value);
    }

    if (value == 1) {
        var valueGet = model.tvservice.getNoSignalMain();
        debugPrint("chl_getNoSignalMainChanged get: " + valueGet, DebugLevel.ALWAYS);
        if (valueGet != value) {
            debugPrint("nty and get is not ==: ", DebugLevel.ALWAYS);
            return;
        }
        for (var i = 0; i < chl_g_dpm_list.length; i++) {
            if (chl_g_dpm_list[i].name == "showNoSignal") {
                chl_g_dpm_list.splice(i, 1);
                break;
            }
        }
        var info = {};
        info.name = "showNoSignal";
        info.callback = "chl_showNoSignal";
        chl_g_dpm_list.push(info);
        chl_g_sourceInfo.signal = false;
        if (chl_g_blank_showStatus && chl_getKeyManager() == "blankPage") {
            chl_showNoSignal();
        }
        try {
            if (hiWebOsFrame.isCurrentModule("launcher")) {
                debugPrint("chl_getNoSignalMainChanged: " + launcherNBar.getCurPageId());
                if (launcherNBar.getCurPageId() == "liveTv_launcher") {
                    LauncherRefreshNoSignal(false);
                }
            }
        } catch (e) {
            debugE(e.message);
        }
    } else if (value == 0) {
        for (var i = 0; i < chl_g_dpm_list.length; i++) {
            if (chl_g_dpm_list[i].name == "showNoSignal") {
                chl_g_dpm_list.splice(i, 1);
                break;
            }
        }
        chl_g_sourceInfo.signal = true;
        chl_hideNoSignal();
        if (chl_getKeyManager() == "showPowerOffDialog") {
            chl_hideShowPowerOffDialog();
        }
        try {
            if (hiWebOsFrame.isCurrentModule("launcher")) {
                if (launcherNBar.getCurPageId() == "liveTv_launcher") {
                   LauncherRefreshNoSignal(true);
                }
            }
        } catch (e) {
            debugE(e.message);
        }
    }
}

function chl_setKeyManager(name) {
    for (var i = 0; i < chl_g_keyManager.length; i++) {
        chl_g_keyManager[i].value = false;
        if (chl_g_keyManager[i].name == name) {
            chl_g_keyManager[i].value = true;
            debugPrint("set manager start:" + chl_g_keyManager[i].name);
            if (name == "blankPage") {
                for (var j = 0; j < chl_g_dpm_list.length; j++) {
                    if (chl_g_dpm_list[j].name == "showNoSignal") {
                        chl_showNoSignal();
                    }
                    else if (chl_g_dpm_list[j].name == "showInputPassword") {
                        if ((chl_source_lock[chl_g_sourceInfo.uid] == 1 && !chl_g_sourceInfo.tvSource) || (!chl_g_password.unLock && chl_g_sourceInfo.tvSource)) {
                            chl_showInputPassword();
                            return;
                        }

                    } else if (chl_g_dpm_list[j].name == "chl_startAutoUpdate") {
                        chl_startAutoUpdate();
                        return;
                    }else if (chl_g_dpm_list[j].name == "chl_startHisenseAppUpdate") {
                        chl_startHisenseAppUpdate();
                        return;
                    }else if (chl_g_dpm_list[j].name == "showAudioOnly") {
                        if (chl_g_sourceInfo.tvSource) {
                            chl_showAudioOnly();
                        }
                    }
                }
                chl_liveTvUIShow = 0;
                chl_liveTvUIClose();
                if(chl_g_sourceInfo.tvSource && chl_g_channelInfo!=null && chl_g_channelInfo.tvType!=CHL_ATV){
                    var keySet = model.tvservice.getHbbTvKeySet();
                    keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(keySet)));
                }else{
                    keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
                }
            } else if (name != "showInputPassword") {
                for (var j = 0; j < chl_g_dpm_list.length; j++) {
                    if (chl_g_dpm_list[j].name == "showNoSignal") {
                        chl_hideNoSignal();

                    }
                    else if (chl_g_dpm_list[j].name == "showInputPassword") {
                        chl_ui_hideInputPassword();
                    }else if (chl_g_dpm_list[j].name == "showAudioOnly") {
                        chl_hideAudioOnly();
                    }
                }
                chl_liveTvUIShow = 1;
                chl_liveTvUIOpen();
                keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
            } else if (name == "showInputPassword") {
                for (var j = 0; j < chl_g_dpm_list.length; j++) {
                    if (chl_g_dpm_list[j].name == "showNoSignal") {
                        chl_hideNoSignal();
                    }else if (chl_g_dpm_list[j].name == "showAudioOnly") {
                        chl_hideAudioOnly();
                    }
                }
                chl_liveTvUIShow = 1;
                chl_liveTvUIOpen();
                keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
            } else {
                chl_liveTvUIShow = 1;
                chl_liveTvUIOpen();
                keyboard.registerKeyCodes(chl_removeDivKeyCodes(chl_g_keyCodes, chl_getDivKeyCodes(0)));
            }
            debugPrint("set manager end:" + chl_g_keyManager[i].name);
            chl_g_keyManager[i].value = true;
        }
    }
}
function chl_getKeyManager() {
    for (var i = 0; i < chl_g_keyManager.length; i++) {
        if (chl_g_keyManager[i].value) {
            return chl_g_keyManager[i].name;
        }
    }
    return null;
}

function chl_processShortKey(keyInfo) {
    for (var i = 0; i < chl_g_keyManager.length; i++) {
        if (chl_g_keyManager[i].value) {
            if (keyInfo.state == "down") {
                if (chl_g_keyManager[i].name == "blankPage") {

                } else {
                    for (var j = 0; j < chl_g_dpm_list.length; j++) {
                        if (chl_g_dpm_list[j].name == "showNoSignal" || chl_g_dpm_list[j].name == "showAvNoSignal") {
                            //chl_hideNoSignal();
                            break;
                        }
                    }
                }
            }
            // debugPrint("CHL_processShortKey"+chl_g_keyManager[i].name);
            chl_g_keyManager[i].callback(keyInfo);
            break;
        }
    }
}


function chl_firstTvShowPageKeyProcess(keyValue) {
    return;
}

function chl_showPowerOffDialogKeyProcess(keyValue) {
    return;
}


function chl_processQuickChannelKey(status, flag) {
    clearTimeout(chl_g_timer.quickSwitchTvTimer);
    var info = null;
    if (status == -1) {
        info = chl_data_getPreChannelInfo(chl_g_switchChannelNum);
    } else if (status == 1) {
        info = chl_data_getNextChannelInfo(chl_g_switchChannelNum);
    }

    if (info != null) {
        chl_g_switchChannelNum = info.uid;
        chl_showInfoBarQuick(info);
    }
    if (flag) {
        chl_g_timer.quickSwitchTvTimer = setTimeout(function () {
            chl_processQuickChannelKey(status, true);
        }, chl_g_timeout.quickSwitchTimeout);
    }
}

var lastPlayUpTime = 0;
var lastPlayDownTime = 0;
var lastInputTime = 0;
function chl_chl_processQuickChannelToPlay() {
    debugPrint("chl_chl_processQuickChannelToPlay", DebugLevel.WARNING);
    var info = null;
    info = chl_data_getChannelInfoByNum(chl_g_switchChannelNum);
    if (info != null) {
        chl_playTv(info, false);
    }
}
var chl_keyRepeat = false;
var chl_firstRepeat = false;
var chl_g_getEpg = true;
function chl_blankPageKeyProcess(keyInfo) {
    var keyValue = keyInfo.keyCode;
    var keyState = keyInfo.state;
    var hdmiIdList=[];
    if(hiWebOsFrame.getCurrentArea() == "EU"){
        hdmiIdList=[4,5,6,7];
    }else{
        hdmiIdList=[3,4,5,6];
    }

    var mhlAvailable =  model.source.getInputMhlAvailable();
    debugPrint("chl_blankPageKeyProcess:" + keyValue + ":  " + chl_g_getChlistFinish + ":keyState:" + keyState+","+chl_g_sourceInfo.uid+",mhlAvailable="+mhlAvailable);
    if ((keyValue >= chl_keyValues.keyNum0 && keyValue <= chl_keyValues.keyNum9) || keyValue == chl_keyValues.keyShortLine) {
        if (keyState == "up") {
            return;
        }
        if (!chl_g_getChlistFinish) {
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (chl_g_timer.showInfoBarTimer != null) {
            chl_ui_hideInfoBar();
        }
        if (!chl_g_channelNumInput && keyState == "repeat") {
            return;
        }
        var isShow = chl_getCurrentListIsDisplay(chl_g_channelInfo.folderUuid);
        if (!isShow) {
            debugPrint("current list  is  no show!!!!!!!!!!!!!!!!!!!!!");
            var index = chl_getChannelListIndexFromViewList();
            if (index != null) {
                chl_g_typeIndex = index;
                chl_processShortNumKey(keyInfo);
            } else {
                var i = chl_getChannelFolderIndexFromViewListNoGet();
                if (i != null) {
                    chl_setRefreshChannelInfoCallback(chl_playOtherListChannelByNumberKey);
                    chl_processShortNumKeyForListNoGet(keyInfo);
                    chl_data_getChannelList(i, 3);
                }
            }
            return;
        }
        chl_processShortNumKey(keyInfo);
    } else if (keyValue == chl_keyValues.keyEnter || keyValue == chl_keyValues.keyChList) {
        var cec = model.cec.getFunctionality();
        if (($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) && cec == 1) {
            if(mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
        if (!chl_g_getChlistFinish) {
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (keyState == "down") {
            var isShow = chl_getCurrentListIsDisplay(chl_g_channelInfo.folderUuid);
            if (!isShow) {
                debugPrint("current list  is  no show!!!!!!!!!!!!!!!!!!!!!");
                var index = chl_getChannelListIndexFromViewList();
                //debugPrint("current list  is  no show!!!!!:" + index);
                if (index != null) {
                    chl_g_focusIndex = 0;
                    chl_g_typeIndex = index;
                    chl_showChannelList(chl_g_focusIndex);
                } else {
                    var i = chl_getChannelFolderIndexFromViewListNoGet();
                    //debugPrint("current list  is  no show!!!!!:" + i);
                    if (i != null) {
                        chl_setRefreshChannelInfoCallback(chl_refreshChannelList);
                        clearTimeout(chl_g_timer.showChannelListTimer);
                        chl_g_timer.showChannelListTimer = 100;
                        chl_data_getChannelList(i, 3);
                    } else {
                        openChannelManager();
                    }
                }
            }else{
                if (chl_g_channelNumInput) {
                    if (chl_g_timer.switchTvTimer != null) {
                        clearTimeout(chl_g_timer.switchTvTimer);
                        chl_g_timer.switchTvTimer = null;
                    }
                    chl_playTvByChannelNum();
                } else {
                    if (chl_g_timer.showInfoBarTimer != null) {
                        chl_ui_hideInfoBar();
                    }
                //chl_data_getDtvNowInfo();
                    chl_showChannelList(chl_g_focusIndex);
                }
            }
        }

    } else if (keyValue == chl_keyValues.keyChannelDown || keyValue == chl_keyValues.keyPadDown) {
        if (!chl_g_getChlistFinish) {
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        var isShow = chl_getCurrentListIsDisplay(chl_g_channelInfo.folderUuid);
        if (!isShow) {
            debugPrint("current list  is  no show!!!!!!!!!!!!!!!!!!!!!");
            if (keyState == "down") {
                var info = chl_getChannelInfoFromViewList();
                debugPrint("chl_getChannelInfoFromViewList:" + info);
                if (info == null) {
                    var index = chl_getChannelFolderIndexFromViewListNoGet();
                    if (index != null) {
                        chl_setRefreshChannelInfoCallback(chl_playOtherListChannel);
                        chl_data_getChannelList(index, 3);
                    }
                } else {
                    chl_playTv(info, false);
                }
            }
            return;
        }
        if (keyState == "down") {

            chl_g_toRefresh = false;
            chl_keyRepeat = false;
            chl_g_getEpg = false;
            var currentTime = Date.now();
            var delay = currentTime - lastPlayDownTime;
            debugPrint("delay:::::::::::::::::::::::::::" + delay, DebugLevel.ERROR);
            if (delay > 1000) {
                var info = null;
                info = chl_data_getPreChannelInfo(chl_g_switchChannelNum);
                if (info != null) {
                    debugPrint("chl_data_getPreChannelInfo!!!!!!!!!!!!!!!:" + info.channelNum);
                    chl_showInfoBarQuick(info);
                    chl_playTv(info, false);
                }
            } else {
                clearTimeout(chl_g_timer.timerForQuick);
                chl_processQuickChannelKey(-1, false);
                chl_g_timer.timerForQuick = setTimeout(chl_chl_processQuickChannelToPlay, 600);
            }
            lastPlayDownTime = Date.now();
            chl_firstRepeat = false;
        }
        else if (!chl_g_keySimple_mode && keyState == "repeat") {
            if (!chl_firstRepeat) {
                chl_firstRepeat = true;
                var currentTime = Date.now();
                var delay = currentTime - lastPlayDownTime;
                if (delay < 1500) {
                    return;
                }
            }
            if (!chl_keyRepeat) {
                chl_keyRepeat = true;
                chl_g_toRefresh = true;
                clearTimeout(chl_g_timer.quickSwitchTvTimer);
                chl_processQuickChannelKey(-1, true);
            }
        }
        else if (keyState == "up") {
            if (chl_g_timer.quickSwitchTvTimer != null) {
                clearTimeout(chl_g_timer.quickSwitchTvTimer);
                chl_g_timer.quickSwitchTvTimer = null;
            }
            chl_keyRepeat = false;
            chl_firstRepeat = false;
            chl_g_getEpg = true;
            if (chl_g_toRefresh) {
                var info = null;
                info = chl_data_getChannelInfoByNum(chl_g_switchChannelNum);
                if (info != null) {
                    chl_playTv(info, false);
                }
            }
        }
        //debugPrint("keydown   end "+Date.now());
    } else if (keyValue == chl_keyValues.keyChannelUp || keyValue == chl_keyValues.keyPadUp) {
        if (!chl_g_getChlistFinish) {
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        var isShow = chl_getCurrentListIsDisplay(chl_g_channelInfo.folderUuid);
        if (!isShow) {
            debugPrint("current list  is  no show!!!!!!!!!!!!!!!!!!!!!");
            if (keyState == "down") {
                var info = chl_getChannelInfoFromViewList();
                debugPrint("chl_getChannelInfoFromViewList:" + info);
                if (info == null) {
                    var index = chl_getChannelFolderIndexFromViewListNoGet();
                    if (index != null) {
                        chl_setRefreshChannelInfoCallback(chl_playOtherListChannel);
                        chl_data_getChannelList(index, 3);
                    }
                } else {
                    chl_playTv(info, false);
                }
            }
            return;
        }
        if (keyState == "down") {
            chl_g_toRefresh = false;
            chl_keyRepeat = false;
            chl_g_getEpg = false;
            var currentTime = Date.now();
            var delay = currentTime - lastPlayDownTime;
            if (delay > 1000) {
                var info = null;
                info = chl_data_getNextChannelInfo(chl_g_switchChannelNum);
                if (info != null) {
                    debugPrint("chl_data_getNextChannelInfo!!!!!!!!!!!!!!!:" + info.channelNum);
                    chl_showInfoBarQuick(info);
                    chl_playTv(info, false);
                }
            } else {
                clearTimeout(chl_g_timer.timerForQuick);
                chl_processQuickChannelKey(1, false);
                chl_g_timer.timerForQuick = setTimeout(chl_chl_processQuickChannelToPlay, 600);
            }
            lastPlayDownTime = Date.now();
            chl_firstRepeat = false;
        }
        else if (!chl_g_keySimple_mode && keyState == "repeat") {
            if (!chl_firstRepeat) {
                chl_firstRepeat = true;
                var currentTime = Date.now();
                var delay = currentTime - lastPlayDownTime;
                if (delay < 1500) {
                    return;
                }
            }
            if (!chl_keyRepeat) {
                chl_keyRepeat = true;
                chl_g_toRefresh = true;
                clearTimeout(chl_g_timer.quickSwitchTvTimer);
                chl_processQuickChannelKey(1, true);
            }
        }
        else if (keyState == "up") {
            if (chl_g_timer.quickSwitchTvTimer != null) {
                clearTimeout(chl_g_timer.quickSwitchTvTimer);
                chl_g_timer.quickSwitchTvTimer = null;
            }
            chl_keyRepeat = false;
            chl_firstRepeat = false;
            chl_g_getEpg = true;
            if (chl_g_toRefresh) {
                var info = null;
                info = chl_data_getChannelInfoByNum(chl_g_switchChannelNum);
                if (info != null) {
                    chl_playTv(info, false);
                }
            }
        }
    }
    else if (keyValue == chl_keyValues.keyReturn || keyValue == chl_keyValues.keyPreCh) {
        var cec = model.cec.getFunctionality();
        if (($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) && cec == 1) {
            if(mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
        if (keyState == "down") {
            if (!chl_g_sourceInfo.tvSource) {
                if (chl_g_timer.showOtherInfoBarTimer != null) {
                    chl_ui_hideOtherSourceInfoBar();
                    return;
                }
            } else {
                if (chl_g_timer.showInfoBarTimer != null) {
                    chl_hideInfoBar();
                    return;
                }
            }
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (chl_g_last_channelNum == null) {
            return;
        }
        if (keyState == "down") {
            debugPrint("up::::::::::::" + chl_g_last_channelNum.channelNum);
            if (chl_g_timer.showInfoBarTimer != null) {
                chl_ui_hideInfoBar();
            }
            chl_playTv(chl_g_last_channelNum, false);
        }
    } else if (keyValue == chl_keyValues.keyInfo || keyValue == chl_keyValues.keyUp) {
        var cec = model.cec.getFunctionality();
        if (($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) && cec == 1) {
            if(mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
        if (keyState == "down") {
            if (!chl_g_sourceInfo.tvSource) {
                if (chl_g_timer.showOtherInfoBarTimer != null) {
                    chl_ui_hideOtherSourceInfoBar();
                } else {
                    chl_g_timeout.showOtherInfoBarTimeout = 10 * 1000;
                    chl_showOtherSourceInfoBar(chl_g_sourceInfo, true);
                }
            } else {
                if (chl_g_timer.showInfoBarTimer != null) {
                    chl_hideInfoBar();
                } else {
                    debugPrint("chl_showInfoBar!!!!!!!!!!!");
                    chl_g_timeout.showInfoBarTimeout = 10 * 1000;
                    if (chl_g_channelInfo != null) {
                        chl_showInfoBar(chl_g_channelInfo);
                        //if (chl_g_channelInfo.tvType != CHL_ATV) {
                        if (!chl_g_password.unLock) {
                            return;
                        }
                        for (var j = 0; j < chl_g_dpm_list.length; j++) {
                            if (chl_g_dpm_list[j].name == "showNoSignal") {
                                return;
                            }
                        }
                        chl_getNowEpg_status = false;
                        model.tvservice.getChannelNowPfInfo();
                        model.tvservice.getChannelNowPfInfoCallBack = chl_data_getDtvNowInfo;
                        model.tvservice.getChannelNextPfInfo();
                        model.tvservice.getChannelNextPfInfoCallBack = chl_data_getDtvNextInfo;
                        chl_g_epgNow = null;
                        chl_g_epgNext = null;
                        chl_g_timer.showInfoBarNoInforTimer = setTimeout(function () {
                            chl_showInfoBarRight(true, true,true);
                        }, 3000);
                        // }
                    }

                }
            }
        }

    }
    else if (keyValue == chl_keyValues.keyRight) {
        var cec = model.cec.getFunctionality();
        if (($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) && cec == 1) {
            if(mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (keyState == "down") {
            if (chl_g_timer.showInfoBarTimer != null) {
                if (chl_g_infoBar_mode == CHL_INFO_NORMAL || chl_g_infoBar_mode == CHL_INFO_NOPROGRAM || chl_g_infoBar_mode == CHL_INFO_NOW) {

                    if (chl_g_epgNow!=null && chl_g_epgNow.title.length > 0) {
                        chl_showInfoBarDetail();
                    } else {
                        var value = model.tvservice.getSignalMainLevels();
                        var level = value + "%";
                        try {
                            if (chl_g_channelInfo.channelName.length == 0) {
                                chl_ui_showInfoBarSignal(level, "20%", chl_g_channelInfo.channelNum);
                            } else {
                                chl_ui_showInfoBarSignal(level, "20%", chl_g_channelInfo.channelName);
                            }

                        } catch (e) {
                            debugPrint(e.message);
                        }
                        chl_showInfoBarRight(false, false,false);
                    }
                    chl_g_infoBar_mode = 1;
                }
            }
        }
    } else if (keyValue == chl_keyValues.keyLeft) {
        var cec = model.cec.getFunctionality();
        if (($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) && cec == 1) {
            if(mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (keyState == "down") {
            if (chl_g_timer.showInfoBarTimer != null) {
                if (chl_g_infoBar_mode == CHL_INFO_DETAIL) {
                    chl_showInfoBar(chl_g_channelInfo);
                    chl_showInfoBarRight(true, false,false);
                    chl_ui_showInfoBarRightNext(chl_g_epgNext);
                    chl_g_infoBar_mode = CHL_INFO_NORMAL;
                }
            }
        }
    }
    else if (keyValue == chl_keyValues.keyBlue) {
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (keyState == "down") {
            if(chl_g_channelInfo.tvType == CHL_ATV){
                return;
            }
            if (chl_g_infoBar_mode == CHL_INFO_DETAIL || chl_g_infoBar_mode == CHL_INFO_NORMAL || chl_g_infoBar_mode == CHL_INFO_NOW) {
                if (chl_g_epgNow.detail.length == 0) {
                    return;
                }
                if (chl_g_timer.showInfoBarTimer != null) {
                    clearTimeout(chl_g_timer.showInfoBarTimer);
                }
                var info = {};
                info.title = chl_g_epgNow.title;
                info.detail = chl_g_epgNow.detail;
                chl_showProgramDetail(info);
            }
        }
    } else if (keyValue == chl_keyValues.keyDown || keyValue == chl_keyValues.keyPvr || keyValue == chl_keyValues.keyTimeShift) {
        var cec = model.cec.getFunctionality();
        if (($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) && cec == 1) {
            if(mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
        if (chl_g_sourceInfo.tvSource)
        {
            if (keyState == "down")
            {
                for (var j = 0; j < chl_g_dpm_list.length; j++) {
                    if (chl_g_dpm_list[j].name == "showNoSignal") {
                        return;
                    }
                }
                if (chl_g_channelInfo.tvType == CHL_ATV) {
                    return;
                }
                //获取当前节目信息并打开pvr、tshift对话框
                //getCurrentDTVPragramInfo(keyValue);
            }
        }
    } else if (keyValue == chl_keyValues.keySource) {
        return;
    } else if (keyValue == chl_keyValues.keyText) {
        if (keyState == "down") {
            for (var j = 0; j < chl_g_dpm_list.length; j++) {
                if (chl_g_dpm_list[j].name == "showNoSignal") {
                    return;
                }
            }
            debugPrint("------------------------------------------------------");
            if (chl_g_sourceInfo.tvSource) {
                StartTeletextControl(hiWebOsFrame.blankPage);
            }
        }
    } else if (keyValue == chl_keyValues.keySubTitle) {
        if (keyState == "down") {
            for (var j = 0; j < chl_g_dpm_list.length; j++) {
                if (chl_g_dpm_list[j].name == "showNoSignal") {
                    return;
                }
            }
            debugPrint("------------------------------------------------------");
            if (chl_g_sourceInfo.tvSource) {
                StartSubtitleControl(hiWebOsFrame.blankPage);
            }
        }
    }
    else if (keyValue == chl_keyValues.keyFAST_BKW) {
        if ($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) {
            if(cec == 1 && mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
    } else if (keyValue == chl_keyValues.keyFAST_FWD) {
        if ($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) {
            if(cec == 1 && mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
    } else if (keyValue == chl_keyValues.keyPause) {
        if ($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) {
            if(cec == 1 && mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
    } else if (keyValue == chl_keyValues.keyPlay) {
        if ($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) {
            if(cec == 1 && mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }
            }
            keyboard.SendKeyResult(false);
            return;
        }
    } else if (keyValue == chl_keyValues.keyStop) {
        if ($.inArray(chl_g_sourceInfo.uid, hdmiIdList) == 0) {
            if(cec == 1 && mhlAvailable == 1){
                if(keyState == "down"){
                    sendKeyValueToMHL(keyValue);
                    keyboard.SendKeyResult(true);
                    return;
                }else{
                    keyboard.SendKeyResult(true);
                    return;
                }

            }
            keyboard.SendKeyResult(false);
            return;
        }
    }else if(keyValue == chl_keyValues.keyEpg){

        if (!chl_g_getChlistFinish) {
            return;
        }
        if (!chl_g_sourceInfo.tvSource) {
            return;
        }
        if (chl_g_channelInfo.tvType == CHL_ATV) {
            return;
        }
        if (keyState == "down") {

	        try {
		        debugPrint("logReport__________begin",DebugLevel.WARNING);
		        logReport('GTRemoteControl','EPG');
		        debugPrint("logReport__________end",DebugLevel.WARNING);
	        }
	        catch (ex) {
		        debugE(ex.message);
	        }

            //debugPrint("!!!! open epg");
            var info = {};
            info.listUid = chl_g_channelInfo.folderUuid;
            info.channelIndex = chl_g_focusIndex;
            chl_startEPG(info);

        }
    }
}
function chl_startEPG(currentPlay) {

    debugPrint(JSON.stringify(currentPlay));
    //hiWebOsFrame.blankPage.close();
    closePagesOrModuleByPage(hiWebOsFrame.getCurrentPage());

    hiWebOsFrame.createPage('epg', null, null, null, function (pageEPG) {

        hiWebOsFrame.epgPage = pageEPG;
        epg.openPage(currentPlay);

    });
}

function chl_getNumberTextByKey(keyValue) {
    var str = "";
    if (keyValue >= chl_keyValues.keyNum0 && keyValue <= chl_keyValues.keyNum9) {
        str = "" + (keyValue - chl_keyValues.keyNum0);
    } else if (keyValue == chl_keyValues.keyShortLine) {
        str = "-";
    }
    return str;
}

function chl_processShortNumKeyForListNoGet(keyInfo) {
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;
    if (keyInfo.state == "down") {
        if (chl_g_channelNum.length >= 4) {
            return;
        }
        if (!chl_g_channelNumInput) {
            //debugPrint("chl_processShortNumKey222:");
            chl_g_channelNum = 0;
            chl_g_channelNumInput = true;
            chl_g_channelNum = keyNum - chl_keyValues.keyNum0;
        } else {
            chl_g_channelNum = chl_g_channelNum * 10 + keyNum - chl_keyValues.keyNum0;
        }
        if (chl_g_timer.switchTvTimer != null) {
            clearTimeout(chl_g_timer.switchTvTimer);
        }
        chl_g_timer.switchTvTimer = setTimeout(chl_wantToPlayTvByChannelNum, chl_g_timeout.switchTvTimeout);
        chl_showChannelNum(chl_g_channelNum);
    }
}

function chl_processShortNumKey(keyInfo) {
    //console.log("CHL:","ShortNumKey");
    //debugPrint("chl_processShortNumKey:");
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;
    if (keyInfo.state == "down") {
        var tmpNum = 0;
        if (!chl_g_channelNumInput) {
            if (keyNum < chl_keyValues.keyNum0 || keyNum > chl_keyValues.keyNum9) {
                return;
            }
            tmpNum = chl_data_getMaxChannelNum();
            debugPrint(" return max: " + tmpNum);
            if (tmpNum != 0) {
                chl_g_channelNumBits = tmpNum;
            }
            chl_g_channelNum = 0;
            chl_g_channelNumInput = true;
            chl_g_channelNum = chl_getNumberTextByKey(keyNum);
        } else {
            chl_g_channelNum = chl_g_channelNum + chl_getNumberTextByKey(keyNum);
        }
        chl_showChannelNum(chl_g_channelNum);
        if (chl_g_timer.switchTvTimer != null) {
            clearTimeout(chl_g_timer.switchTvTimer);
        }
        var tmpBits = 0;
        var tmpStr = "" + chl_g_channelNum;
        tmpBits = tmpStr.length;
        if (tmpBits == chl_g_channelNumBits) {
            setTimeout(chl_playTvByChannelNum,100);
            //chl_playTvByChannelNum();
        }
        else {
            chl_g_timer.switchTvTimer = setTimeout(chl_playTvByChannelNum, chl_g_timeout.switchTvTimeout);
        }
        lastInputTime = Date.now();
        chl_firstRepeat = false;
    } else if (keyInfo.state == "repeat") {
        if (!chl_firstRepeat) {
            chl_firstRepeat = true;
            var currentTime = Date.now();
            var delay = currentTime - lastInputTime;
            if (delay < 1500) {
                return;
            }
        }
        if (chl_g_timer.switchTvTimer != null) {
            clearTimeout(chl_g_timer.switchTvTimer);
        }
        chl_playTvByChannelNum();
    } else if (keyInfo.state == "up") {
        chl_firstRepeat = false;
    }
}

function chl_clearFirstNumber0ForChannelNum(num) {
    var tmp = num;
    var i = 0;
    for (i = 0; i < num.length; i++) {
        tmp = num.substring(i, i + 1);
        if (tmp != 0) {
            break;
        }
    }
    tmp = num.substring(i, num.length);
    return tmp;
}
function chl_wantToPlayTvByChannelNum() {
    if (chl_g_timer.switchTvTimer != null) {
        clearTimeout(chl_g_timer.switchTvTimer);
    }
    chl_g_timer.switchTvTimer = null;
    chl_g_channelNumInput = false;
}

function chl_playTvByChannelNum() {
    if (chl_g_timer.switchTvTimer != null) {
        clearTimeout(chl_g_timer.switchTvTimer);
    }
    chl_g_timer.switchTvTimer = null;
    chl_g_channelNumInput = false;
    var info = null;
    debugPrint("chl_playTvByChannelNum:" + chl_g_channelNum);
    var tmp_num = chl_g_channelNum;
    if (chl_g_channelNum.length > 1) {
        tmp_num = chl_clearFirstNumber0ForChannelNum(chl_g_channelNum);
    }
    if(hiWebOsFrame.getCurrentArea()=="SA"){
        info = chl_data_getChannelInfoByInputNumForSA(tmp_num);
    }else{
        info = chl_data_getChannelInfoByInputNum(tmp_num);
    }
    if (info != null && !info.isSkip) {
        chl_playTv(info, false);
        chl_g_channelNum = 0;
    } else if (info != null && info.isSkip) {
        debugPrint("the channel is  skip!!!!!!!!!" + tmp_num, DebugLevel.ALWAYS);
        chl_g_channelNum = 0;
    }else{
        if(hiWebOsFrame.getCurrentArea()=="SA"){
            if (tmp_num.indexOf(".") >= 0) {
                chl_g_channelNum = 0;
                return;
            }
            if (chl_g_tunerMode == 0) {
                if (parseInt(tmp_num) >= 2 && parseInt(tmp_num) <= 69) {
                    debugPrint("chl_playTvByChannelNum  to search!!!!!!!!!" + tmp_num, DebugLevel.ALWAYS);
                    chl_g_epgNow = null;
                    chl_g_epgNext = null;
                    //model.tvservice.playChannel(2, tmp_num);
                    chl_g_channelNum = 0;
                    chl_g_searchByPlay = 1;
                }
            } else if (chl_g_tunerMode == 1) {
                if (parseInt(tmp_num) >= 1 && parseInt(tmp_num) <= 135) {
                    debugPrint("chl_playTvByChannelNum  to search!!!!!!!!!" + tmp_num, DebugLevel.ALWAYS);
                    chl_g_epgNow = null;
                    chl_g_epgNext = null;
                    //model.tvservice.playChannel(2, tmp_num);
                    chl_g_channelNum = 0;
                    chl_g_searchByPlay = 1;
                }
            }
        }
    }
}

function chl_setChannelListDataForKeyUp(status) {
    clearTimeout(chl_g_timer.quickSwitchTvTimer);
    var len = 0;
    len = chl_g_channelList[chl_g_typeIndex].list.length;

    if (chl_g_focusIndex == 0) {
        chl_g_focusIndex = len - 1;
    } else {
        chl_g_focusIndex--;
    }
    chl_ui_setChannelListData(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list, status, chl_g_channelList[chl_g_typeIndex].tvType);
    if (!status) {
        chl_ui_showChannelListShadow(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list);
    }
    if (!status) {
        chl_g_timer.quickSwitchTvTimer = setTimeout(function () {
            chl_setChannelListDataForKeyUp(status);
        }, 80);
    }

}
function chl_setChannelListDataForKeyDown(status) {
    clearTimeout(chl_g_timer.quickSwitchTvTimer);
    var len = 0;
    len = chl_g_channelList[chl_g_typeIndex].list.length;
    if (chl_g_focusIndex == len - 1) {
        chl_g_focusIndex = 0;
    } else {
        chl_g_focusIndex++;
    }
    chl_ui_setChannelListData(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list, status, chl_g_channelList[chl_g_typeIndex].tvType);
    if (!status) {
        chl_ui_showChannelListShadow(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list);
    }
    if (!status) {
        chl_g_timer.quickSwitchTvTimer = setTimeout(function () {
            chl_setChannelListDataForKeyDown(status);
        }, 80);
    }

}
function chl_setChannelListDataForChannelDown(status) {
    clearTimeout(chl_g_timer.quickSwitchTvTimer);
    var len = 0;
    len = chl_g_channelList[chl_g_typeIndex].list.length;
    if (chl_g_focusIndex == len - 1) {
        chl_g_focusIndex = 0;
    } else {
        chl_g_focusIndex = chl_g_focusIndex + 7;
        if (chl_g_focusIndex > len - 1) {
            chl_g_focusIndex = len - 1;
        }
    }
    chl_ui_setChannelListData(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list, status, chl_g_channelList[chl_g_typeIndex].tvType);
    if (!status) {
        chl_ui_showChannelListShadow(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list);
    }
    if (!status) {
        chl_g_timer.quickSwitchTvTimer = setTimeout(function () {
            chl_setChannelListDataForChannelDown(status);
        }, 80);
    }
}

function chl_setChannelListDataForChannelUp(status) {
    clearTimeout(chl_g_timer.quickSwitchTvTimer);

    var len = 0;
    len = chl_g_channelList[chl_g_typeIndex].list.length;
    if (chl_g_focusIndex == 0) {
        chl_g_focusIndex = len - 1;
    } else {
        chl_g_focusIndex = chl_g_focusIndex - 7;
        if (chl_g_focusIndex < 0) {
            chl_g_focusIndex = 0;
        }
    }
    chl_ui_setChannelListData(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list, status, chl_g_channelList[chl_g_typeIndex].tvType);
    if (!status) {
        chl_ui_showChannelListShadow(chl_g_focusIndex, chl_g_channelList[chl_g_typeIndex].list);
    }
    if (!status) {
        chl_g_timer.quickSwitchTvTimer = setTimeout(function () {
            chl_setChannelListDataForChannelUp(status);
        }, 80);
    }
}


function chl_channelListPageKeyProcess(keyInfo) {
    //debugPrint();
    if (chl_g_timer.showChannelListTimer != null) {
        clearTimeout(chl_g_timer.showChannelListTimer);
        chl_g_timer.showChannelListTimer = setTimeout(function () {
            chl_hideChannelList(true);
        }, chl_g_timeout.showChannelListTimeout);
    }
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;
    debugPrint("keystate :" + keyState);
    if (keyNum == chl_keyValues.keyUp) {
        if (keyState == "down") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_setChannelListDataForKeyUp(true);
            chl_firstRepeat = false;
            chl_g_toRefresh = false;
            lastPlayUpTime = Date.now();
        }
        else if (!chl_g_keySimple_mode && keyState == "repeat") {
            if (!chl_firstRepeat) {
                chl_firstRepeat = true;
                var currentTime = Date.now();
                var delay = currentTime - lastPlayUpTime;
                if (delay < 1200) {
                    return;
                }
            }
            if (!chl_keyRepeat) {
                chl_keyRepeat = true;
                chl_setChannelListDataForKeyUp(false);
            }
        } else if (keyState == "up") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_ui_hideChannelListShadow();
        }

    } else if (keyNum == chl_keyValues.keyDown) {

        if (keyState == "down") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_setChannelListDataForKeyDown(true);
        }
        else if (!chl_g_keySimple_mode && keyState == "repeat") {
            if (!chl_keyRepeat) {
                chl_keyRepeat = true;
                chl_setChannelListDataForKeyDown(false);
            }
        } else if (keyState == "up") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_ui_hideChannelListShadow();
        }

    } else if (keyNum == chl_keyValues.keyChannelUp) {
        if (keyState == "down") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_setChannelListDataForChannelUp(true);
        }
        else if (!chl_g_keySimple_mode && keyState == "repeat") {
            if (!chl_keyRepeat) {
                chl_keyRepeat = true;
                chl_setChannelListDataForChannelUp(false);
            }
        } else if (keyState == "up") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_ui_hideChannelListShadow();
        }

    } else if (keyNum == chl_keyValues.keyChannelDown) {
        if (keyState == "down") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_setChannelListDataForChannelDown(true);
        }
        else if (!chl_g_keySimple_mode && keyState == "repeat") {
            if (!chl_keyRepeat) {
                chl_keyRepeat = true;
                chl_setChannelListDataForChannelDown(false);
            }
        } else if (keyState == "up") {
            chl_keyRepeat = false;
            clearTimeout(chl_g_timer.quickSwitchTvTimer);
            chl_ui_hideChannelListShadow();
        }
    }
    else if (keyNum == chl_keyValues.keyLeft || keyNum == chl_keyValues.keyTools) {

        if (keyState == "down") {
            chl_showChannelListLeft();
        }

    } else if (keyNum == chl_keyValues.keyEnter) {
        if (keyState == "down") {
            var info = null;
            info = chl_g_channelList[chl_g_typeIndex].list[chl_g_focusIndex];
            debugPrint("CHL list play :" + info.channelNum);
            if (info != null) {
                chl_hideChannelList(false);
                chl_playTv(info, false);

            } else {
                chl_hideChannelList(true);
            }

        }

    } else if (keyNum == chl_keyValues.keyReturn || keyNum == chl_keyValues.keyChList) {
        if (keyState == "down") {
            chl_hideChannelList(true);
        }
    } else if (keyNum == chl_keyValues.keyRight) {
        return;
        if (keyState == "down") {
            for (var j = 0; j < chl_g_dpm_list.length; j++) {
                if (chl_g_dpm_list[j].name == "showNoSignal") {
                    return;
                }
            }
            if (chl_g_channelList[chl_g_typeIndex].tvType == CHL_ATV) {
                return;
            }
            chl_hideChannelList(false);
            var info = null;
            info = chl_g_channelList[chl_g_typeIndex].list[chl_g_focusIndex];
            //console.log("CHL:","chl_g_focusIndex :"+chl_g_focusIndex);
            if (info != null) {
                chl_g_programList.channelInfo = info;
                chl_g_programList.name = chl_g_channelList[chl_g_typeIndex].name;
                //debugPrint("prgm:" + JSON.stringify(chl_g_programList.channelInfo));
                //chl_data_getDtvNowInfo();
                chl_showProgramList();
            }
        }
    }
}


function chl_channelListLeftPageKeyProcess(keyInfo) {
    if (chl_g_timer.showChannelListLeftTimer != null) {
        clearTimeout(chl_g_timer.showChannelListLeftTimer);
        chl_g_timer.showChannelListLeftTimer = setTimeout(chl_hideChannelListLeft, chl_g_timeout.showChannelListLeftTimeout);
    }
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;


    //debugPrint("code:"+keyNum);
    if (keyNum == chl_keyValues.keyUp) {
        if (keyState == "up") {
            return;
        }
        var current = 0;

        for (var i = 0; i < chl_g_channelTypeList.length; i++) {

            if (chl_g_channelTypeList[i].focus && i > 0) {

                for (var j = i; j > 0; j--) {
                    if (!chl_g_channelTypeList[j - 1].display) {
                        continue;
                    } else {
                        chl_g_channelTypeList[i].focus = false;
                        chl_g_channelTypeList[j - 1].focus = true;
                        break;
                    }
                }
                break;
            }
        }
        var len = 0;
        for (var i = 0; i < chl_g_channelTypeList.length; i++) {
            if (!chl_g_channelTypeList[i].display) {
                continue;
            }
            len++;
            if (chl_g_channelTypeList[i].current) {
                current = i;
            }
        }
        if (len > 11 && chl_g_leftFocusLine > 0) {
            chl_g_leftFocusLine--;
        }
        chl_ui_setChannelListLeftData(chl_g_channelTypeList, "up", chl_g_leftFocusLine, current);
    } else if (keyNum == chl_keyValues.keyDown) {
        if (keyState == "up") {
            return;
        }
        var current = 0;
        for (var i = 0; i < chl_g_channelTypeList.length; i++) {
            if (chl_g_channelTypeList[i].focus && i < chl_g_channelTypeList.length) {
                for (var j = i; j < chl_g_channelTypeList.length - 1; j++) {
                    if (!chl_g_channelTypeList[j + 1].display) {
                        continue;
                    } else {
                        chl_g_channelTypeList[i].focus = false;
                        chl_g_channelTypeList[j + 1].focus = true;
                        break;
                    }
                }
                break;
            }
        }
        var len = 0;
        for (var i = 0; i < chl_g_channelTypeList.length; i++) {
            if (!chl_g_channelTypeList[i].display) {
                continue;
            }
            len++;
            if (chl_g_channelTypeList[i].current) {
                current = i;
            }
        }
        if (len > 11 && chl_g_leftFocusLine < 10) {
            chl_g_leftFocusLine++;
        }

        debugPrint("ss:" + JSON.stringify(chl_g_channelTypeList));
        chl_ui_setChannelListLeftData(chl_g_channelTypeList, "down", chl_g_leftFocusLine, current);
    }
    else if (keyNum == chl_keyValues.keyRight || keyNum == chl_keyValues.keyTools) {
        //console.log("CHL:", "hide channel list left");
        if (keyState == "up" || keyState == "repeat") {
            return;
        }
        chl_hideChannelListLeft();
    } else if (keyNum == chl_keyValues.keyReturn) {
        //console.log("CHL:", "hide channel list left");
        if (keyState == "up" || keyState == "repeat") {
            return;
        }
        chl_hideChannelListLeft();
        chl_hideChannelList(true);
    } else if (keyNum == chl_keyValues.keyEnter) {

        if (keyState == "up" || keyState == "repeat") {
            return;
        }
        if (!chl_g_getChlistFinish) {
            return;
        }
        for (var i = 0; i < chl_g_channelTypeList.length; i++) {
            if (chl_g_channelTypeList[i].focus) {
                if (!chl_g_channelTypeList[i].get) {
                    // chl_g_getChlistFinish = false;
                    //chl_ui_showLoading();
                    chl_setRefreshChannelInfoCallback(chl_refreshChannelList);
                    chl_data_getChannelList(i, 0);
                }
                else {
                    //debugPrint("uid:" + chl_g_channelTypeList[i].uid);
                    //debugPrint("type:" + chl_g_channelList[chl_g_typeIndex].type);
                    if (chl_g_channelTypeList[i].uid != chl_g_channelList[chl_g_typeIndex].type) {
                        chl_hideChannelListLeft();
                        chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelTypeList[i].uid);
                        chl_g_focusIndex = 0;
                        chl_showChannelList(chl_g_focusIndex);
                    } else {
                        chl_hideChannelListLeft();
                    }
                }
                break;
            }
        }
    }
}
function chl_programListPageKeyProcess(keyInfo) {
    if (chl_g_timer.showProgramListTimer != null) {
        clearTimeout(chl_g_timer.showProgramListTimer);
        chl_g_timer.showProgramListTimer = setTimeout(function () {
            chl_hideProgramList(true);
        }, chl_g_timeout.showProgramListTimeout);
    }
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;
    if (keyState == "up" || keyState == "repeat") {
        return;
    }
    if (keyNum == chl_keyValues.keyUp) {
        for (var i = 0; i < chl_g_programList.programInfo.length; i++) {
            if (chl_g_programList.programInfo[i].programStatus == "true" && i > 0) {
                chl_g_programList.programInfo[i].programStatus = "false";
                chl_g_programList.programInfo[i - 1].programStatus = "true";
                break;
            }
        }
        chl_ui_setProgramListData(chl_g_programList);

    } else if (keyNum == chl_keyValues.keyDown) {
        for (var i = 0; i < chl_g_programList.programInfo.length; i++) {
            if (chl_g_programList.programInfo[i].programStatus == "true" && i < chl_g_programList.programInfo.length - 1) {
                chl_g_programList.programInfo[i].programStatus = "false";
                chl_g_programList.programInfo[i + 1].programStatus = "true";
                break;
            }
        }
        chl_ui_setProgramListData(chl_g_programList);
    } else if (keyNum == chl_keyValues.keyReturn) {
        //chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.channelNum, chl_g_channelInfo.channelType);
        chl_hideProgramList(false);
        chl_hideChannelList(true);
    } else if (keyNum == chl_keyValues.keyLeft) {
        chl_hideProgramList(false);
        chl_showChannelList(chl_g_focusIndex);
    }
    else if (keyNum == chl_keyValues.keyEnter) {
        if (chl_g_programList.programInfo[0].programStatus == "true") {
            if (chl_g_programList.channelInfo != null) {
                chl_playTv(chl_g_programList.channelInfo, false);
            }
            chl_hideProgramList(false);
        } else {
            for (i = 0; i < chl_g_programList.programInfo.length; i++) {
                if (chl_g_programList.programInfo[i].programStatus == "true") {
                    clearTimeout(chl_g_timer.showProgramListTimer);
                    break;
                }
            }

        }
    } else if (keyNum == chl_keyValues.keyBlue) {
        if (chl_g_timer.showProgramListTimer != null) {
            clearTimeout(chl_g_timer.showProgramListTimer);
        }
        var info = null;
        for (var i = 0; i < chl_g_programList.programInfo.length; i++) {
            if (chl_g_programList.programInfo[i].programStatus == "true") {
                info = chl_g_programList.programInfo[i];
                break;
            }
        }
        chl_showProgramDetail(info);

    } else if (keyNum == chl_keyValues.keyChannelUp || keyNum == chl_keyValues.keyChannelDown) {
        chl_hideProgramList(true);
        chl_showChannelList(chl_g_focusIndex);
    }
}

function chl_showDialogKeyProcess(keyInfo) {
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;
    if (keyState == "up" || keyState == "repeat") {
        return;
    }
    if (keyNum == chl_keyValues.keyReturn) {
        chl_forceHideDialog();
    } else if (keyNum == chl_keyValues.keyLeft) {
        if (chl_g_dialogOpts.focus == 2) {
            chl_g_dialogOpts.focus = 1;
            chl_ui_setDialogData(1);
        }
    } else if (keyNum == chl_keyValues.keyRight) {
        if (chl_g_dialogOpts.focus == 1) {
            chl_g_dialogOpts.focus = 2;
            chl_ui_setDialogData(2);
        }
    } else if (keyNum == chl_keyValues.keyEnter) {
        if (chl_g_dialogOpts.focus == 1) {
            chl_ui_hideDialog();
            //chl_setKeyManager("blankPage");
            chl_g_dialogOpts.okCommand.call();
        } else if (chl_g_dialogOpts.focus == 2) {
            if (chl_g_dialogOpts.cancelCommand != null) {
                chl_g_dialogOpts.cancelCommand.call();
            }
            chl_ui_hideDialog();
            //chl_setKeyManager("blankPage");
        }
    }
}

function chl_clearInputPassword() {
    for (var i = 0; i < chl_g_dpm_list.length; i++) {
        if (chl_g_dpm_list[i].name == "showInputPassword") {
            chl_g_dpm_list.splice(i, 1);
            chl_g_inputPwdFocusIndex = 1;
            chl_ui_hideInputPassword();
            chl_g_password.unLock = true;
            chl_setKeyManager("blankPage");
            break;
        }
    }
}

function chl_showInputPasswordKeyProcess(keyInfo) {
    var keyNum = keyInfo.keyCode;
    var keyState = keyInfo.state;

    if (keyNum >= chl_keyValues.keyNum0 && keyNum <= chl_keyValues.keyNum9) {
        if (keyState == "down") {
            if (chl_g_inputPwdFocusIndex < 4 && chl_g_inputPwdFocusIndex > 0) {
                chl_g_inputPwdFocusIndex++;
                chl_ui_setInputPasswordFocus(chl_g_inputPwdFocusIndex, keyNum - chl_keyValues.keyNum0);
            } else if (chl_g_inputPwdFocusIndex == 4) {
                chl_g_inputPwdFocusIndex = 1;
                chl_ui_setInputPasswordFocus(chl_g_inputPwdFocusIndex, keyNum - chl_keyValues.keyNum0);
                chl_g_inputPwdFocusIndex = 0;
                var password = "";
                password = chl_getPasswordFromInput();
                debugPrint("password:" + password);
                debugPrint("password:" + chl_g_password.pin);
                if (password == chl_g_password.pin || password == chl_g_password.fullPin) {
                    try {
                        model.parentlock.InputBlock(parseInt(chl_g_sourceInfo.uid), 0, 1);
                        if (chl_g_sourceInfo.uid == 0) {
                            if (chl_g_channelInfo != null) {
                                model.tvservice.unLockPlayChannel(chl_g_channelInfo.uid);
                            } else {
                                model.tvservice.unLockPlayChannel(0);
                            }
                        } else {
                            model.tvservice.unLockPlayChannel(0);
                        }

                    } catch (e) {
                        debugPrint(e.message);
                    }
                    setTimeout(chl_clearInputPassword, 100);
                    setMainInputPasswordStatus(true,true);
                } else {
                    chl_g_inputPwdFocusIndex = 1;
                    chl_ui_showInputPassword(chl_lang.reEnterPwd);
                }
            }
        }

    } else if (keyNum == chl_keyValues.keyEnter || keyNum == chl_keyValues.keyChList) {
        chl_blankPageKeyProcess(keyInfo);
    } else if (keyNum == chl_keyValues.keyChannelDown) {
        chl_blankPageKeyProcess(keyInfo);
    } else if (keyNum == chl_keyValues.keyChannelUp) {
        chl_blankPageKeyProcess(keyInfo);
    } else if (keyNum == chl_keyValues.keyReturn) {
        chl_blankPageKeyProcess(keyInfo);
    } else if (keyNum == chl_keyValues.keyInfo || keyNum == chl_keyValues.keyUp) {
        chl_blankPageKeyProcess(keyInfo);
    }
}

function chl_savePreTVInfo() {
    debugPrint("chl_savePreTVInfo:::::::::::::::::::"+chl_g_channelInfo.folderUuid);
    debugPrint("chl_savePreTVInfo:::::::::::::::::::"+chl_g_channelInfo.uid);
    chl_g_last_channelNum = {};
    chl_g_last_channelNum.folderUuid = chl_g_channelInfo.folderUuid;
    chl_g_last_channelNum.uid = chl_g_channelInfo.uid;
    chl_g_last_channelNum.channelNum = chl_g_channelInfo.channelNum;
    chl_g_last_channelNum.channelName = chl_g_channelInfo.channelName;
    chl_g_last_channelNum.isRadio = chl_g_channelInfo.isRadio;
    chl_g_last_channelNum.playId = chl_g_channelInfo.playId;

}

function chl_startToPlayTv(channelInfo, status) {
    debugPrint("ui start to play channel  ::" + channelInfo.folderUuid + ":" + channelInfo.uid, DebugLevel.ALWAYS);
    debugPrint("ui start to play channel  ::" + channelInfo.channelNum + ":" + channelInfo.channelName, DebugLevel.ALWAYS);
    //debugPrint("ui start to play channel  ::" + channelInfo.isRadio);
    for (var i = 0; i < chl_g_dpm_list.length; i++) {
        if (chl_g_dpm_list[i].name == "showInputPassword") {
            chl_g_dpm_list.splice(i, 1);
            chl_g_inputPwdFocusIndex = 1;
            chl_ui_hideInputPassword();
            chl_setKeyManager("blankPage");
            break;
        }
    }
    model.tvservice.playChannel(channelInfo.playId, channelInfo.uid);
    setWindowSize(0,0,1920,1080);
    debugPrint("ui  play channel  end!!!!!!!!!!!!!! ", DebugLevel.ALWAYS);
}

function chl_playTv(channelInfo, status) {
    //chl_startToPlayTv(channelInfo, status);
    if(isTimeShiftStatus() || isMainArchiveRecording()){
        chl_showStopTimeShiftDialog(channelInfo, null);
        return;
    }

    chl_startToPlayTv(channelInfo, status);
}


function chl_ui_showFirstPlayTv() {
    $("#chl_firstPlayTV").css("display", "block");
    $("#chl_fpt_list_text").text(chl_lang.showCHL);
    $("#chl_fpt_list").css("visibility", "visible");

}

function chl_ui_showFirstPvr() {
    $("#chl_fpt_pvr").css("visibility", "visible");
    $("#chl_fpt_pvr_text").text(chl_lang.showPvr);
    //$("#chl_fpt_list").css("visibility","hidden");
}
function chl_ui_showFirstWatch() {
    $("#chl_fpt_watch").css("visibility", "visible");
    $("#chl_fpt_watch_text").text("PRE-CH");
    //$("#chl_fpt_pvr").css("visibility","hidden");
}
function chl_ui_showFirstInfo() {
    $("#chl_fpt_info").css("visibility", "visible");
    $("#chl_fpt_info_text").text(chl_lang.showInfo);
    //$("#chl_fpt_watch").css("visibility","hidden");
}

function chl_ui_hideFirstPlayTv() {
    $("#chl_firstPlayTV").css("display", "none");
    $("#chl_fpt_list").css("visibility", "hidden");
    $("#chl_fpt_pvr").css("visibility", "hidden");
    $("#chl_fpt_watch").css("visibility", "hidden");
    $("#chl_fpt_info").css("visibility", "hidden");
}

function chl_ui_showChannelNum(number) {
    $("#chl_showChannelNum").css("display", "block");
    $("#chl_scn_text").text("" + number);
}
function chl_ui_hideChannelNum() {
    $("#chl_showChannelNum").css("display", "none");
}

function chl_ui_showOtherSourceInfoBar(info, flag) {

    $("#chl_showOtherSourceInfoBar").css("display", "block");
    $("#chl_sos_icon").css("display", "none");
    var imgPath ="img/infobar/";
    if(hiWebOsFrame.getCurrentArea()=="EU"){
        if (info.uid == 4 || info.uid == 5 || info.uid == 6|| info.uid == 7) {
            var mhlAvailable =  model.source.getInputMhlAvailable();
            //imgPath = "img/infobar/";
            $("#chl_sos_icon36").attr("src", imgPath + "hdmi"+(info.uid-3)+".png");
            if(mhlAvailable == 1){
                $("#chl_sos_icon").css("display", "block");
            }else{
                $("#chl_sos_icon").css("display", "none");
            }

        } else if (info.uid == 2) {
            $("#chl_sos_icon36").attr("src", imgPath + "component.png");
        } else if (info.uid == 1) {
            $("#chl_sos_icon36").attr("src", imgPath + "av.png");
        }else if (info.uid == 3) {
            $("#chl_sos_icon36").attr("src", imgPath + "scart.png");
        }
    }else{
        if (info.uid == 3 || info.uid == 4 || info.uid == 5|| info.uid == 6) {
            var mhlAvailable =  model.source.getInputMhlAvailable();
            //imgPath = "img/infobar/";
            $("#chl_sos_icon36").attr("src", imgPath + "hdmi"+(info.uid-2)+".png");
            if(mhlAvailable == 1){
                $("#chl_sos_icon").css("display", "block");
            }else{
                $("#chl_sos_icon").css("display", "none");
            }

        } else if (info.uid == 2) {
            $("#chl_sos_icon36").attr("src", imgPath + "component.png");
        } else if (info.uid == 1) {
            $("#chl_sos_icon36").attr("src", imgPath + "av.png");
        }
    }


    if (info.channelName.length >= 13) {
        var str1 = info.channelName.substring(0, 13);
        var str2 = info.channelName.substring(13, info.channelName.length);
        $("#chl_sos_name").text(str1);
        $("#chl_sos_name1").text(str2);
    } else {
        $("#chl_sos_name").text(info.channelName);
        $("#chl_sos_name1").html("&nbsp");
    }
    $("#chl_sos_text").text("");
    $("#chl_sos_hz").text("");

    var wide_str = " ";
    var hz_str = " ";
    var hd_str = " ";
    if (flag) {
        var value = model.tvservice.getCurrentSourceVideoFormat();
        debugPrint("getVideoFormatInfo:" + JSON.stringify(value));
        for (var j = 0; j < chl_g_dpm_list.length; j++) {
            if (chl_g_dpm_list[j].name == "showNoSignal") {
                return;
            }
        }
        if (value.length > 0) {
            var array = value.split(",");
            if (array.length > 1) {
                if (array[0] == 0) {
                    return;
                }
                if (chl_g_sourceInfo.uid != 1) {
                    wide_str = array[0] + "*" + array[1];
                    if (wide_str != "640*480" && wide_str != "800*600" && wide_str != "1024*768") {
                        if (array[2] == 0) {
                            wide_str = array[0] + "*" + array[1] + "i";
                        } else if (array[2] == 1) {
                            wide_str = array[0] + "*" + array[1] + "p";
                        }
                    }
                } else {
                    if (array[1] == 576) {
                        wide_str = array[1];
                        hz_str = "PAL";
                    } else if (array[1] == 480) {
                        wide_str = array[1];
                        hz_str = "NTSC";
                    }
                    if (array[2] == 0) {
                        wide_str = wide_str + "i";
                    } else if (array[2] == 1) {
                        wide_str = wide_str + "p";
                    }
                }
            }
        }
    } else {
        wide_str = " ";
        hz_str = " ";
    }
    $("#chl_sos_text").text(wide_str);
    $("#chl_sos_hz").text(hz_str);

}

function chl_ui_hideOtherSourceInfoBar() {
    if (chl_liveTvUIShow == 2) {
        chl_liveTvUIShow = 0;
    }
    chl_liveTvUIClose();
    $("#chl_showOtherSourceInfoBar").css("display", "none");
    clearTimeout(chl_g_timer.showOtherInfoBarTimer);
    chl_g_timer.showOtherInfoBarTimer = null;
    chl_g_timeout.showOtherInfoBarTimeout = 5 * 1000;
}

function chl_ui_showInfoBarQuick(info) {
    $("#chl_showInfoBar").css("display", "block");
    $("#chl_sib_left_signal").css("display", "none");
    $("#chl_sib_left").css("display", "block");
    debugPrint("chl_ui_showInfoBarQuick:::" + info.channelNum);
    $("#chl_sib_ch_num").text(info.channelNum);
    if (info.channelName.length > 0) {
        $("#chl_sib_channel_name").text(info.channelName);
    } else {
        $("#chl_sib_channel_name").html("&nbsp");
    }

    //$("#chl_sib_date").html("");
    var imgPath = "img/common/";
//    if(chl_g_tunerMode == 1){
//        $("#chl_sib_ch_format").text(chl_lang.antenna);
//    }else if(chl_g_tunerMode == 2){
//        $("#chl_sib_ch_format").text(chl_lang.cable);
//    }
    if (info.isEncrypt) {
        $("#chl_sib_icon30_1").css("display", "inline");
        $("#chl_sib_icon30_1").attr("src", imgPath + "encrypt30.png");
    } else {
        $("#chl_sib_icon30_1").css("display", "none");
    }
    if (info.isLock) {
        $("#chl_sib_icon30_2").css("display", "inline");
        $("#chl_sib_icon30_2").attr("src", imgPath + "lock30.png");
    } else {
        $("#chl_sib_icon30_2").css("display", "none");
    }
    if (info.isFav) {
        $("#chl_sib_icon30_3").css("display", "inline");
        $("#chl_sib_icon30_3").attr("src", imgPath + "favorite30.png");
    } else {
        $("#chl_sib_icon30_3").css("display", "none");
    }
}

function chl_ui_showInfoBar(info, time, signal) {

    $("#chl_showInfoBar").css("display", "block");
    chl_ui_showInfoBarLeft(info, time, signal);
}

function chl_ui_showInfoBarLeft(info, time, signal) {
    $("#chl_sib_left_signal").css("display", "none");
    $("#chl_sib_left").css("display", "block");
    $("#chl_sib_ch_num").text(info.channelNum);

    $("#chl_sib_channel_name").text(info.channelName);
    //time = liveTv_getCurrentTime();
    $("#chl_sib_date").html(time);
//    if(signal == 1){
//        $("#chl_sib_ch_format").text(chl_lang.antenna);
//    }else if(signal == 2){
//        $("#chl_sib_ch_format").text(chl_lang.cable);
//    }

    var imgPath = "img/common/";
    if (info.isEncrypt) {
        $("#chl_sib_icon30_1").css("display", "inline");
        $("#chl_sib_icon30_1").attr("src", imgPath + "encrypt30.png");
    } else {
        $("#chl_sib_icon30_1").css("display", "none");
    }
    if (info.isLock) {
        $("#chl_sib_icon30_2").css("display", "inline");
        $("#chl_sib_icon30_2").attr("src", imgPath + "lock30.png");
    } else {
        $("#chl_sib_icon30_2").css("display", "none");
    }
    if (info.isFav) {
        $("#chl_sib_icon30_3").css("display", "inline");
        $("#chl_sib_icon30_3").attr("src", imgPath + "favorite30.png");
    } else {
        $("#chl_sib_icon30_3").css("display", "none");
    }
    if (signal == 1) {
        $("#chl_sib_icon30_4").css("display", "inline");
        $("#chl_sib_icon30_4").attr("src", imgPath + "Antenna.png");
    }
//    else {
//        $("#chl_sib_icon30_4").css("display", "none");
//    }
    if (signal == 2) {
        $("#chl_sib_icon30_4").css("display", "inline");
        $("#chl_sib_icon30_4").attr("src", imgPath + "Cable.png");
    }
//    else {
//        $("#chl_sib_icon30_4").css("display", "none");
//    }

}

function chl_ui_showInfoBarRight(currentTime, videoInfo, audioInfo, epgNow, flag, sap) {

    $("#chl_sib_detail").css("display", "none");
    $("#chl_sib_noprogram").css("display", "none");
    $("#chl_sib_right").css("display", "block");
    for (var i = 1; i <= 11; i++) {
        $("#chl_sib_pro_para_" + i).css("display", "none");
        if (i > 1) {
            $("#chl_sib_pro_para_line_" + i).css("display", "none");
        }

    }
    if (epgNow != null && epgNow.startTime.length > 0 && chl_g_channelInfo.tvType!=CHL_ATV) {
        $("#chl_sib_progress_bg").css("visibility", "visible");
        var str = "";
        chl_g_infoBar_mode = CHL_INFO_NOW;
        if (chl_g_timeFormat == 0) {
            str = utcTimeToLocalTime12(parseInt(epgNow.startTime) * 1000 + (3600000 * chl_g_timeZone));
        } else {
            str = utcTimeToLocalTime24(parseInt(epgNow.startTime) * 1000 + (3600000 * chl_g_timeZone));
        }
        $("#chl_sib_startTime").text(str);
        if (chl_g_timeFormat == 0) {
            str = utcTimeToLocalTime12(parseInt(epgNow.endTime) * 1000 + (3600000 * chl_g_timeZone));
        } else {
            str = utcTimeToLocalTime24(parseInt(epgNow.endTime) * 1000 + (3600000 * chl_g_timeZone));
        }


        $("#chl_sib_endTime").text(str);
        $("#chl_sib_nowName").text(epgNow.title);

        //var currentTime = model.datetime.getDVBTime();
//    debugPrint("current time:" + currentTime);
//    debugPrint("start   time:" + epgNow.startTime);
//    debugPrint("end     time:" + epgNow.endTime);
        if (epgNow.startTime > currentTime || epgNow.endTime < currentTime) {
            debugPrint("start is bigger than current  time or end time is smaller than current!!!!!!!!!!!!!:");
            //$("#chl_sib_progress_color").css("width",270);
        } else {
            if (epgNow.startTime == currentTime) {
                $("#chl_sib_progress_color").css("width", 0);
            } else if (currentTime == epgNow.endTime) {
                $("#chl_sib_progress_color").css("width", 270);
            } else {
                var width = (currentTime - epgNow.startTime) / (epgNow.endTime - epgNow.startTime) * 270;
                $("#chl_sib_progress_color").css("width", width);
            }
        }
        if (epgNow.detail.length > 0) {
            $("#chl_sib_more_info_normal").css("display", "block");
            $("#chl_sib_bottom_info_normal").text(chl_lang.moreInfo);
        } else {
            $("#chl_sib_more_info_normal").css("display", "none");
        }
    } else {
        chl_g_infoBar_mode = CHL_INFO_NOPROGRAM;
        $("#chl_sib_progress_bg").css("visibility", "hidden");
        $("#chl_sib_startTime").html("&nbsp");
        $("#chl_sib_endTime").html("&nbsp");
        $("#chl_sib_nowName").text(chl_lang.noProgram);
        $("#chl_sib_more_info_normal").css("display", "none");
        $("#chl_sib_nextTime").text(" ");
        $("#chl_sib_nextName").text(" ");
    }
//    $("#chl_sib_nextTime").text(" ");
//    $("#chl_sib_nextName").text(" ");

    var list = [];
    var index = 0;
    if (epgNow != null) {
        debugPrint("dd:" + JSON.stringify(epgNow));
        if (epgNow.parentalRating.length > 0) {
            list[index] = epgNow.parentalRating;
        }
        if (epgNow.cc == 1) {
            if (list.length > 0) {
                index = 1;
            }
            list[index] = "CC";
        }
    }
    if (videoInfo != null) {
        if (videoInfo.hd_str.length > 2) {
            index = list.length;
            list[index] = videoInfo.hd_str;
        }
    }
    if (videoInfo != null) {
        if (videoInfo.wide_str) {
            if (videoInfo.wide_str.length <= 4) {
                if (videoInfo.wide_str.indexOf("0") == -1) {
                    index = list.length;
                    list[index] = videoInfo.wide_str;
                }else{
                    if(chl_g_channelInfo.tvType==CHL_ATV){
                        index = list.length;
                        list[index] = "4:3";
                    }
                }
            }
        }
    }
    if (audioInfo != null) {
        if (chl_g_channelInfo.tvType != CHL_ATV) {
            if (audioInfo.str.length > 4) {
                index = list.length;
                list[index] = audioInfo.str;
            }
        }
    }
    if (sap != null) {
        index = list.length;
        if (sap == 1) {
            list[index] = chl_lang.mono;
        } else if (sap == 2) {
            list[index] = chl_lang.stereo;
        } else if (sap == 3) {
            list[index] = chl_lang.sap;
        }
    }
    debugPrint("dd:" + JSON.stringify(list));
    if (list.length <= 7) {
        for (var i = 0; i < list.length; i++) {
            $("#chl_sib_pro_para_" + (i + 1)).css("display", "inline-block");
            $("#chl_sib_pro_para_" + (i + 1)).text(list[i]);
            if (i > 0) {
                $("#chl_sib_pro_para_line_" + (i + 1)).css("display", "inline-block");
            }
        }
    }
    if (audioInfo.dolby == "ac3" || audioInfo.dolby == "eac3") {
        if (list.length > 0) {
            $("#chl_sib_pro_para_line_" + (list.length + 1)).css("display", "inline-block");
        }
        $("#chl_sib_pro_para_" + (list.length + 1)).text("");
        $("#chl_sib_pro_para_" + (list.length + 1)).css("display", "inline-block");
        try {
            $("#chl_sib_pro_para_" + (list.length + 1)).removeClass("chl_sib_pro_para_1");
            $("#chl_sib_pro_para_" + (list.length + 1)).addClass("chl_sib_pro_para_3");
        } catch (e) {
            debugPrint(e.message);
        }
    }
    if (flag) {
       // $("#chl_sib_rarrow").css("display", "inline-block");
        $("#chl_sib_rarrow").css("visibility", "visible");
    } else {
       // $("#chl_sib_rarrow").css("display", "none");
       $("#chl_sib_rarrow").css("visibility", "hidden");
    }

    if (chl_g_epgNext != null) {
        chl_ui_showInfoBarRightNext(chl_g_epgNext);
    }

}

function chl_ui_showInfoBarRightNext(next) {
    var startStr = " ";
    var endStr = " ";
    if (next != null) {
        if (chl_g_timeFormat == 0) {
            startStr = utcTimeToLocalTime12(parseInt(next.startTime) * 1000 + (3600000 * chl_g_timeZone));
        } else {
            startStr = utcTimeToLocalTime24(parseInt(next.startTime) * 1000 + (3600000 * chl_g_timeZone));
        }
        if (chl_g_timeFormat == 0) {
            endStr = utcTimeToLocalTime12(parseInt(next.endTime) * 1000 + (3600000 * chl_g_timeZone));
        } else {
            endStr = utcTimeToLocalTime24(parseInt(next.endTime) * 1000 + (3600000 * chl_g_timeZone));
        }

        $("#chl_sib_nextTime").text(startStr + " - " + endStr);
        $("#chl_sib_nextName").text(next.title);
    }
}

function chl_ui_showInfoBarNoProgram() {
    if (chl_getNowEpg_status) {
        return;
    }
    chl_g_infoBar_mode = CHL_INFO_NOPROGRAM;
    $("#chl_sib_detail").css("display", "none");
    $("#chl_sib_right").css("display", "none");
    $("#chl_sib_noprogram").css("display", "block");
    $("#chl_sib_noprogram_text").text(chl_lang.noProgram);
}

function chl_ui_showInfoBarDetail(epgNow) {

    $("#chl_sib_noprogram").css("display", "none");
    $("#chl_sib_right").css("display", "none");
    $("#chl_sib_detail").css("display", "block");
    if (epgNow.title.length > 0) {
        $("#chl_sib_prgm_title").text(epgNow.title);
        $("#chl_sib_prgm_detail").text(epgNow.detail);
    }
    if (epgNow.detail.length > 0) {
        $("#chl_sib_more_info_detail").css("display", "block");
        $("#chl_sib_bottom_info").text(chl_lang.moreInfo);
    } else {
        $("#chl_sib_more_info_detail").css("display", "none");
    }

}

function chl_ui_showInfoBarSignal(level, quality, name) {
    $("#chl_sib_left").css("display", "none");
    $("#chl_sib_left_signal").css("display", "block");

    $("#chl_sib_left_signal_name").text(name);
    var lstr = chl_lang.signalLevel + " : " + level;
    $("#chl_sib_left_signal_level").text(lstr);
//    var qstr = chl_lang.signalQuality + " : " + quality;
//    $("#chl_sib_left_signal_strength").text(qstr);
}

function chl_ui_hideInfoBarLeft() {
    $("#chl_sib_left").css("display", "none");
    for (var i = 1; i <= 5; i++) {
        $("#chl_sib_icon30_1" + i).css("display", "none");
    }
}

function chl_ui_hideInfoBarSignal() {
    $("#chl_sib_left_signal").css("display", "none");
}

function chl_ui_hideInfoBarRight() {
    $("#chl_sib_right").css("display", "none");
    for (var i = 1; i <= 11; i++) {
        $("#chl_sib_pro_para_" + i).css("display", "none");
        $("#chl_sib_pro_para_" + i).removeClass("chl_sib_pro_para_3");
        $("#chl_sib_pro_para_" + i).addClass("chl_sib_pro_para_1");
        if (i > 1) {
            $("#chl_sib_pro_para_line_" + i).css("display", "none");
        }

    }
    $("#chl_sib_nextTime").text(" ");
    $("#chl_sib_nextName").text(" ");
}
function chl_ui_hideInfoDetail() {
    $("#chl_sib_detail").css("display", "none");
    $("#chl_sib_noprogram").css("display", "none");
}
function chl_ui_hideInfoBar() {
    if (chl_liveTvUIShow == 2) {
        chl_liveTvUIShow = 0;
    }
    chl_liveTvUIClose();
    $("#chl_showInfoBar").css("display", "none");
    chl_ui_hideInfoBarSignal();
    chl_ui_hideInfoBarRight();
    chl_ui_hideInfoDetail();
    $("#chl_sib_noprogram").css("display", "none");
    clearTimeout(chl_g_timer.showInfoBarTimer);
    clearTimeout(chl_g_timer.showInfoBarNoInforTimer);
    chl_g_timer.showInfoBarTimer = null;
    chl_g_infoBar_mode = 2;
    chl_g_timeout.showInfoBarTimeout = 5 * 1000;

}

var channelListShow = [false, false, false, false, false, false, false,false];

function chl_ui_clearChannelList() {
    for (var i = 1; i <= 7; i++) {
        $("#chl_scl_middle_ch_num" + i).text("");
        $("#chl_scl_middle_ch_name" + i).text("");
        $("#chl_scl_middle_ch_prgm" + i).text("");
        $("#chl_scl_middle_icon30_" + i + "1").attr("src", "");
        $("#chl_scl_middle_icon30_" + i + "2").attr("src", "");
        $("#chl_scl_middle_icon30_" + i + "3").attr("src", "");
        channelListShow[i] = false;
    }

}

function chl_ui_showChannelList(focusIndex, list) {

    $("#chl_showChannelList").css("display", "block");
    $("#chl_scl_top_title").text(list.name);
    if (list.tvType == CHL_ATV) {
        $("#chl_scl_progress_bg").css("display", "none");
    } else {
        $("#chl_scl_progress_bg").css("display", "none");
    }
    $("#chl_scl_top_title_list").css("display", "block");
    $("#chl_scl_bottom_info").text(chl_lang.information);
    $("#chl_scl_top_info").text(chl_lang.information);
    $("#chl_scl_bottom_channellist").text(chl_lang.chlSelect);
    chl_ui_setChannelListData(focusIndex, list.list, true, list.tvType);
}

function chl_ui_setChannelListIconData(info, n) {
    var imgPath = "img/common/";
    if (info.isEncrypt) {
        $("#chl_scl_middle_icon30_" + n + "1").attr("src", imgPath + "encrypt30.png");
    }
    if (info.isFav) {

        $("#chl_scl_middle_icon30_" + n + "2").attr("src", imgPath + "favorite30.png");
    }
    if (info.isLock) {
        $("#chl_scl_middle_icon30_" + n + "3").attr("src", imgPath + "lock30.png");
    }

}

function chl_ui_setChannelListData(focusIndex, list, status, tvType) {
    //debugPrint("status:"+status);
    chl_ui_clearChannelList();

    if (list.length == 0 || focusIndex < 0) {
        $("#chl_scl_middle_ch_prgm4").html("&nbsp");
        return;
    }
    $("#chl_scl_middle_ch_num4").text(list[focusIndex].channelNum);
    $("#chl_scl_middle_ch_name4").text(list[focusIndex].channelName);

    // $("#chl_scl_middle_ch_prgm4").html("&nbsp");

    if (status) {
        chl_ui_setChannelListIconData(list[focusIndex], 4);
        //if (tvType != CHL_ATV) {
            // $("#chl_scl_middle_ch_prgm4").text(chl_lang.noProgram);
            // chl_data_getProgramForCList(list[focusIndex], 3 + str, true);
            channelListShow[4] = true;
        //}
    }
    var i = 0;
    var n = 0;
    //debugPrint("focusIndex:" + focusIndex);
    if (focusIndex <= 3) {
        for (i = focusIndex - 1, n = 3; i >= 0; i--, n--) {
            $("#chl_scl_middle_ch_num" + n).text(list[i].channelNum);
            $("#chl_scl_middle_ch_name" + n).text(list[i].channelName);
            if (status) {
                chl_ui_setChannelListIconData(list[i], n);
               // if (tvType != CHL_ATV) {
                    // $("#chl_scl_middle_ch_prgm" + n).text(chl_lang.noProgram);
                    // chl_data_getProgramForCList(list[i], n + str, false);
                    channelListShow[n] = true;
               //}
            }
        }
    } else {
        for (i = focusIndex - 1, n = 3; i >= focusIndex - 3; i--, n--) {
            $("#chl_scl_middle_ch_num" + n).text(list[i].channelNum);
            $("#chl_scl_middle_ch_name" + n).text(list[i].channelName);
            if (status) {
                chl_ui_setChannelListIconData(list[i], n);
                //if (tvType != CHL_ATV) {
                    //  $("#chl_scl_middle_ch_prgm" + n).text(chl_lang.noProgram);
                    // chl_data_getProgramForCList(list[i], n + str, false);
                    channelListShow[n] = true;
                //}
            }
        }
    }
    if (list.length <= focusIndex + 3) {
        for (i = focusIndex + 1, n = 5; i < list.length; i++, n++) {

            $("#chl_scl_middle_ch_num" + n).text(list[i].channelNum);
            $("#chl_scl_middle_ch_name" + n).text(list[i].channelName);
            if (status) {
                chl_ui_setChannelListIconData(list[i], n);
               // if (tvType != CHL_ATV) {
                    // $("#chl_scl_middle_ch_prgm" + n).text(chl_lang.noProgram);
                    // chl_data_getProgramForCList(list[i], n + str, false);
                    channelListShow[n] = true;
               // }
            }
        }
    } else {
        for (i = focusIndex + 1, n = 5; i <= focusIndex + 3; i++, n++) {
            $("#chl_scl_middle_ch_num" + n).text(list[i].channelNum);
            $("#chl_scl_middle_ch_name" + n).text(list[i].channelName);
            if (status) {
                chl_ui_setChannelListIconData(list[i], n);
                //if (tvType != CHL_ATV) {
                    // $("#chl_scl_middle_ch_prgm" + n).text(chl_lang.noProgram);
                    //  chl_data_getProgramForCList(list[i], n + str, false);
                    channelListShow[n] = true;
                //}
            }
        }
    }
    return true;
}
function chl_ui_showChannelListShadow(focusIndex, list) {
    var str = "";
    var height = 921;
    var strStyle = document.getElementById("chl_scl_top_shadow" + str).style.display;
    //debugPrint("strStyle::::::::"+strStyle);
    if (strStyle === "block") {
        //$("#chl_scl_bar"+str).css("top", ((height - height / (list.length) * item) / (list.length - 1)) * focusIndex);
    }
    else {
        $("#chl_scl_top_shadow" + str).css("display", "block");
        $("#chl_scl_bottom_shadow" + str).css("display", "block");
        $("#chl_scl_bar" + str).css("display", "block");
        if (list.length <= 7) {
            $("#chl_scl_bar" + str).css("height", height / 7 * list.length);
        } else {
            $("#chl_scl_bar" + str).css("height", height / (list.length) * 5);
        }
    }
    if (list.length <= 7) {
        $("#chl_scl_bar" + str).css("top", ((height - height / (7) * list.length) / (list.length - 1)) * focusIndex);
    } else {
        $("#chl_scl_bar" + str).css("top", ((height - height / (list.length) * 5) / (list.length - 1)) * focusIndex);
    }
}
function chl_ui_hideChannelList() {

    $("#chl_showChannelList").css("display", "none");

    chl_ui_hideChannelListShadow();
}
function chl_ui_hideChannelListShadow() {
    $("#chl_scl_top_shadow").css("display", "none");
    $("#chl_scl_bottom_shadow").css("display", "none");
    $("#chl_scl_bar").css("display", "none");
}


function chl_ui_showChannelListLeft(allList, focus) {

    $("#chl_scl_type_listr").html("");
    $("#chl_scl_type_list").html("");

    $("#chl_scl_left").css("display", "block");
    $("#chl_scl_left_top").css("display", "block");
    $("#chl_scl_top_title_list").css("display", "none");
    $("#chl_scl_top_title").removeClass("chl_scl_top_title_focus");
    $("#chl_scl_top_title").addClass("chl_scl_top_title_unfocus");

    $("#chl_scl_middle_focus").removeClass("chl_scl_middle_focus");
    $("#chl_scl_middle_focus").addClass("chl_scl_middle_focus_cancel");
    var info = "";
    var list = [];
    for (var i = 0; i < allList.length; i++) {
        if (allList[i].display) {
            list.push(allList[i]);
        }
    }
    if (list.length > 11) {
        $("#chl_scl_type_list").css("height", 1005);
        $("#chl_scl_left_bottom").css("display", "none");
        $("#chl_scl_left_shadow").css("display", "block");

        var i = 0;
        var n = 0;
        if (focus >= 11) {
            n = focus - 10;
        }
        debugPrint("n:" + n);
        for (i = 0; i < 11; i++, n++) {
            info = info + '<li id="chl_scl_type_list_div' + i + '" class="chl_scl_left_list_unfocus">' +
                '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/><span>' +
                list[n].name + '</span></li>';
        }
        if (focus < list.length - 1) {
            info = info + '<li id="chl_scl_type_list_div' + i + '" class="chl_scl_left_list_shadow">' +
                '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                '<span id="chl_left_bottom_text">' +
                list[n].name + '</span></li>';
        }

        $("#chl_scl_type_list").html(info);
        $("#chl_left_bottom_text").css("margin-top", -10);
        $("#chl_scl_left_bar").css("display", "block");
        $("#chl_scl_left_bar").css("height", 935 / list.length);
        $("#chl_scl_left_bar").css("top", 935 / list.length * focus + 30);

        if (focus < 11) {
            $("#chl_scl_type_list_div" + focus).removeClass("chl_scl_left_list_unfocus");
            $("#chl_scl_type_list_div" + focus).addClass("chl_scl_left_list_focus");
            $("#chl_scl_type_list_img" + focus).attr("src", "img/channellist/current_focus.png");

        } else {
            $("#chl_scl_type_list_div" + 10).removeClass("chl_scl_left_list_unfocus");
            $("#chl_scl_type_list_div" + 10).addClass("chl_scl_left_list_focus");
            $("#chl_scl_type_list_img" + 10).attr("src", "img/channellist/current_focus.png");
        }


    } else {
        $("#chl_scl_type_list").css("height", "auto");
        for (var i = 0; i < list.length; i++) {
            info = info + '<li id="chl_scl_type_list_div' + i + '" class="chl_scl_left_list_unfocus">' +
                '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                '<span>' +
                list[i].name + '</span></li>';
        }

        $("#chl_scl_type_list").html(info);
        $("#chl_scl_left_bottom").css("display", "block");
        $("#chl_scl_left_shadow").css("display", "none");
        for (var i = 0; i < list.length; i++) {
            if (list[i].focus) {
                $("#chl_scl_type_list_div" + i).removeClass("chl_scl_left_list_unfocus");
                $("#chl_scl_type_list_div" + i).addClass("chl_scl_left_list_focus");
                $("#chl_scl_type_list_img" + i).attr("src", "img/channellist/current_focus.png");
                break;
            }
//            if(list[i].current){
//                $("#chl_scl_type_list_img" + i).attr("src","img/channellist/current_focus.png");
//            }
        }
    }
}

function chl_ui_setChannelListLeftData(allList, action, line, current) {


    var list = [];
    for (var i = 0; i < allList.length; i++) {
        if (allList[i].display) {
            list.push(allList[i]);
        }
    }
    debugPrint("all show type list len:" + list.length);
    for (var i = 0; i < list.length; i++) {
        if (list[i].focus) {
            if (list.length <= 11) {
                // $("#chl_scl_type_list_div" + i).removeClass("chl_scl_left_list_current");
                $("#chl_scl_type_list_div" + i).removeClass("chl_scl_left_list_unfocus");
                $("#chl_scl_type_list_div" + i).addClass("chl_scl_left_list_focus");
            }
            if (action == "down") {
                if (list.length > 11) {
                    if (line < 10) {
                        // $("#chl_scl_type_list_div" + line).removeClass("chl_scl_left_list_current");
                        $("#chl_scl_type_list_div" + line).removeClass("chl_scl_left_list_unfocus");
                        $("#chl_scl_type_list_div" + line).addClass("chl_scl_left_list_focus");

                        $("#chl_scl_type_list_div" + (line - 1)).removeClass("chl_scl_left_list_focus");
                        if (list[i - 1].current) {
                            $("#chl_scl_type_list_div" + (line - 1)).addClass("chl_scl_left_list_unfocus");
                            $("#chl_scl_type_list_img" + (line - 1)).attr("src", "img/channellist/current_focus.png");
                        } else {
                            $("#chl_scl_type_list_div" + (line - 1)).addClass("chl_scl_left_list_unfocus");
                        }
                        $("#chl_scl_left_bar").css("top", 935 / list.length * i + 30);
                        return;
                    }
                    var info = "";
                    var len = 11;
                    if (i == list.length - 1) {
                        len = 10;
                    }
                    var n = -10;
                    var j = 0;
                    var current_div = 0;
                    if (len == 10) {
                        for (j = 0; j < len + 1; j++, n++) {
                            info = info + '<li id="chl_scl_type_list_div' + j + '" class="chl_scl_left_list_unfocus">' +
                                '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                                '<span>' +
                                list[i + n].name + '</span></li>';
                        }

                        $("#chl_scl_type_list").html(info);
                        current_div = 13 - (i + n) - current;
                    } else {
                        for (j = 0; j < len; j++, n++) {
                            info = info + '<li id="chl_scl_type_list_div' + j + '" class="chl_scl_left_list_unfocus">' +
                                '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                                '<span>' +
                                list[i + n].name + '</span></li>';
                        }
                        info = info + '<li id="chl_scl_type_list_div' + j + '" class="chl_scl_left_list_shadow">' +
                            '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                            '<span id="chl_left_bottom_text">' +
                            list[i + n].name + '</span></li>';
                        $("#chl_scl_type_list").html(info);
                        $("#chl_left_bottom_text").css("margin-top", -10);
                    }
                    //debugPrint("i:" + i);
                    if (i > 10) {
                        //debugPrint("i22:" + i);
                        current_div = current - (i - 10);
                    } else {
                        current_div = current;
                        //debugPrint("i33:" + i);
                    }
                    //debugPrint("current:" + current);
                    //debugPrint("current_div:" + current_div);

                    if (current_div >= 0 && current_div < 11) {
                        //$("#chl_scl_type_list_div" + current_div).removeClass("chl_scl_left_list_unfocus");
                        //$("#chl_scl_type_list_div" + current_div).addClass("chl_scl_left_list_current");
                    }
                    //$("#chl_scl_type_list_div" + 10).removeClass("chl_scl_left_list_current");
                    $("#chl_scl_type_list_div" + 10).removeClass("chl_scl_left_list_unfocus");
                    $("#chl_scl_type_list_div" + 10).addClass("chl_scl_left_list_focus");

                }
                else {

                    $("#chl_scl_type_list_div" + (i - 1)).removeClass("chl_scl_left_list_focus");
                    if (list[i - 1].current) {
                        $("#chl_scl_type_list_div" + (i - 1)).addClass("chl_scl_left_list_unfocus");
                        $("#chl_scl_type_list_img" + (i - 1)).attr("src", "img/channellist/current_focus.png");
                    } else {
                        $("#chl_scl_type_list_div" + (i - 1)).addClass("chl_scl_left_list_unfocus");
                    }
                }
                $("#chl_scl_left_bar").css("top", 935 / list.length * i + 30);
            } else {
                if (list.length > 11) {
                    if (line > 0) {
                        if (line == 10) {
                            //$("#chl_scl_type_list_div" + 9).removeClass("chl_scl_left_list_current");
                            $("#chl_scl_type_list_div" + 9).removeClass("chl_scl_left_list_unfocus");
                            $("#chl_scl_type_list_div" + 9).addClass("chl_scl_left_list_focus");

                            $("#chl_scl_type_list_div" + 10).removeClass("chl_scl_left_list_focus");
                            if (list[i + 1].current) {
                                $("#chl_scl_type_list_div" + 10).addClass("chl_scl_left_list_unfocus");
                                $("#chl_scl_type_list_img" + 10).attr("src", "img/channellist/current_focus.png");
                            } else {
                                $("#chl_scl_type_list_div" + 10).addClass("chl_scl_left_list_unfocus");
                            }
                            $("#chl_scl_left_bar" + str).css("top", 935 / list.length * i + 30);
                            return;
                        } else {
                            //$("#chl_scl_type_list_div" + (line)).removeClass("chl_scl_left_list_current");
                            $("#chl_scl_type_list_div" + (line)).removeClass("chl_scl_left_list_unfocus");
                            $("#chl_scl_type_list_div" + (line)).addClass("chl_scl_left_list_focus");

                            $("#chl_scl_type_list_div" + (line + 1)).removeClass("chl_scl_left_list_focus");
                            if (list[i + 1].current) {
                                $("#chl_scl_type_list_div" + (line + 1)).addClass("chl_scl_left_list_unfocus");
                                $("#chl_scl_type_list_img" + (line + 1)).attr("src", "img/channellist/current_focus.png");
                            } else {
                                $("#chl_scl_type_list_div" + (line + 1)).addClass("chl_scl_left_list_unfocus");
                            }
                            $("#chl_scl_left_bar" + str).css("top", 935 / list.length * i + 30);
                            return;
                        }

                    } else {
                        if (i == list.length - 11) {
                            //$("#chl_scl_type_list_div" + (line)).removeClass("chl_scl_left_list_current");
                            $("#chl_scl_type_list_div" + (line)).removeClass("chl_scl_left_list_unfocus");
                            $("#chl_scl_type_list_div" + (line)).addClass("chl_scl_left_list_focus");

                            $("#chl_scl_type_list_div" + (line + 1)).removeClass("chl_scl_left_list_focus");
                            if (list[i + 1].current) {
                                $("#chl_scl_type_list_div" + (line + 1)).addClass("chl_scl_left_list_unfocus");
                                $("#chl_scl_type_list_img" + (line + 1)).attr("src", "img/channellist/current_focus.png");
                            } else {
                                $("#chl_scl_type_list_div" + (line + 1)).addClass("chl_scl_left_list_unfocus");
                            }
                            $("#chl_scl_left_bar").css("top", 935 / list.length * i + 30);
                            return;
                        }
                        //debugPrint("i up:" + i);
                        //debugPrint("current:" + current);
                        var info = "";

                        for (var j = 0; j < 11; j++) {
                            info = info + '<li id="chl_scl_type_list_div' + j + '" class="chl_scl_left_list_unfocus">' +
                                '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                                '<span>' +
                                list[i + j].name + '</span></li>';
                        }
                        info = info + '<li id="chl_scl_type_list_div' + j + '" class="chl_scl_left_list_shadow">' +
                            '<img src="img/channellist/current_unfocus.png" id="chl_scl_type_list_img' + i + '"/>' +
                            '<span id="chl_left_bottom_text">' +
                            list[i + j].name + '</span></li>';
                        $("#chl_scl_type_list").html(info);
                        $("#chl_left_bottom_text").css("margin-top", -10);
                        if (current > i) {
                            if (current - i < 11) {
                                //$("#chl_scl_type_list_div" + (current - i)).removeClass("chl_scl_left_list_unfocus");
                                //$("#chl_scl_type_list_div" + (current - i)).addClass("chl_scl_left_list_current");
                                $("#chl_scl_type_list_img" + (current - i)).attr("src", "img/channellist/current_focus.png");
                            }
                        }
                        // $("#chl_scl_type_list_div" + 0).removeClass("chl_scl_left_list_current");
                        $("#chl_scl_type_list_div" + 0).removeClass("chl_scl_left_list_unfocus");
                        $("#chl_scl_type_list_div" + 0).addClass("chl_scl_left_list_focus");
                    }
                    $("#chl_scl_left_bar" + str).css("top", 935 / list.length * i + 30);
                }
                else {

                    $("#chl_scl_type_list_div" + (i + 1)).removeClass("chl_scl_left_list_focus");
                    if (list[i + 1].current) {
                        $("#chl_scl_type_list_div" + (i + 1)).addClass("chl_scl_left_list_unfocus");
                        $("#chl_scl_type_list_img" + (i + 1)).attr("src", "img/channellist/current_focus.png");
                    } else {
                        $("#chl_scl_type_list_div" + (i + 1)).addClass("chl_scl_left_list_unfocus");
                    }
                }
            }
            break;
        }
    }
}
function chl_ui_hideChannelListLeft() {
    $("#chl_scl_type_listr").html("");
    $("#chl_scl_type_list").html("");
    $("#chl_scl_leftr").css("display", "none");
    $("#chl_scl_left").css("display", "none");
    $("#chl_scl_middle_focus").removeClass("chl_scl_middle_focus_cancel");
    $("#chl_scl_middle_focus").addClass("chl_scl_middle_focus");

    $("#chl_scl_left_top").css("display", "none");
    $("#chl_scl_top_title_list").css("display", "block");
    $("#chl_scl_top_title").removeClass("chl_scl_top_title_unfocus");
    $("#chl_scl_top_title").addClass("chl_scl_top_title_focus");

}

function chl_ui_showProgramList(infoList) {

    $("#chl_showProgramList").css("display", "block");
    $("#chl_spl_top_title").text(infoList.name);
    $("#chl_spl_top_info").text(chl_lang.information);
    $("#chl_spl_middle_ch_num").text(infoList.channelInfo.channelNum);
    //debugPrint("name:" + infoList.channelInfo.channelName);
    $("#chl_spl_middle_ch_name").text(infoList.channelInfo.channelName);
    var imgPath = "img/common/";
    if (infoList.channelInfo.isEncrypt) {
        $("#chl_spl_middle_icon30_1").attr("src", imgPath + "encrypt30.png");
    } else {
        $("#chl_spl_middle_icon30_1").attr("src", "");
    }
    if (infoList.channelInfo.isFav) {
        $("#chl_spl_middle_icon30_2").attr("src", imgPath + "favorite30.png");
    } else {
        $("#chl_spl_middle_icon30_2").attr("src", "");
    }
    if (infoList.channelInfo.isLock) {
        $("#chl_spl_middle_icon30_3").attr("src", imgPath + "lock30.png");
    } else {
        $("#chl_spl_middle_icon30_3").attr("src", "");
    }
    $("#chl_spl_bottom_channellist").text(chl_lang.chlSelect);
    $("#chl_spl_bottom_detail").text(chl_lang.prgDetail);
    chl_data_getProgramForList(infoList.channelInfo);
}

function chl_ui_setProgramListData(infoList) {
    var imgPath = "img/common/";

    for (var i = 0; i < 4; i++) {
        //$("#chl_spl_middle_item" + i).css("display", "none");
        $("#chl_spl_detail_item" + i).text("");
        $("#chl_spl_middle_name" + i).text("");
        if (i == 0) {
            $("#chl_spl_startTime0").text("");
            $("#chl_spl_endTime0").text("");
            continue;
        }
        $("#chl_spl_middle_icon30_" + i + "1").attr("src", "");
        $("#chl_spl_middle_icon30_" + i + "2").attr("src", "");
        $("#chl_spl_middle_time" + i).text("");

    }
    debugPrint("length:" + infoList.programInfo.length);
    for (var i = 0; i < infoList.programInfo.length; i++) {
        $("#chl_spl_progress_bg").css("display", "inline-block");

        if (infoList.programInfo[i].programStatus == "true") {
            var str = infoList.programInfo[i].detail;
            str = str.replace(/\n/g, "<br>");
            var str1 = "";
            if (i == 0) {
                $("#chl_spl_middle_program" + i).removeClass("chl_spl_current_unfocus");
                $("#chl_spl_middle_program" + i).addClass("chl_spl_current_focus");

                $("#chl_spl_middle_name" + i).removeClass("chl_spl_middle_name0");
                $("#chl_spl_middle_name" + i).addClass("chl_spl_middle_name0_focus");

                str1 = suolve(420, str);
            } else {
                $("#chl_spl_middle_program" + i).removeClass("chl_spl_middle_unfocus");
                $("#chl_spl_middle_program" + i).addClass("chl_spl_middle_focus");

                $("#chl_spl_middle_name" + i).removeClass("chl_spl_middle_name");
                $("#chl_spl_middle_name" + i).addClass("chl_spl_middle_name_focus");
                str1 = suolve(365, str);
            }

            $("#chl_spl_detail_item" + i).html(str1);
        } else {
            if (i == 0) {
                $("#chl_spl_middle_program" + i).removeClass("chl_spl_current_focus");
                $("#chl_spl_middle_program" + i).addClass("chl_spl_current_unfocus");
                $("#chl_spl_middle_name" + i).removeClass("chl_spl_middle_name0_focus");
                $("#chl_spl_middle_name" + i).addClass("chl_spl_middle_name0");
            } else {
                $("#chl_spl_middle_program" + i).removeClass("chl_spl_middle_focus");
                $("#chl_spl_middle_program" + i).addClass("chl_spl_middle_unfocus");
                $("#chl_spl_middle_name" + i).removeClass("chl_spl_middle_name_focus");
                $("#chl_spl_middle_name" + i).addClass("chl_spl_middle_name");
            }
            $("#chl_spl_detail_item" + i).text("");
        }

        if (infoList.programInfo[i].isBook != null && infoList.programInfo[i].isBook) {
            $("#chl_spl_middle_icon30_" + i + "1").attr("src", imgPath + "reserve30.png");
        }

        if (infoList.programInfo[i].isRecord != null && infoList.programInfo[i].isRecord) {
            $("#chl_spl_middle_icon30_" + i + "2").attr("src", imgPath + "record30.png");
        }

        $("#chl_spl_middle_name" + i).text(infoList.programInfo[i].title);
        var startStr = utcTimeToLocalTime24(parseInt(infoList.programInfo[i].startTime) * 1000);
        var endStr = utcTimeToLocalTime24(parseInt(infoList.programInfo[i].endTime) * 1000);
        if (i == 0) {
            $("#chl_spl_startTime" + i).text(startStr);
            $("#chl_spl_endTime" + i).text(endStr);
            //var currentTime = model.datetime.getDVBTime();
            var currentTime = "1376651600";
            debugPrint("current time:" + currentTime);
            debugPrint("start   time:" + infoList.programInfo[i].startTime);
            debugPrint("end     time:" + infoList.programInfo[i].endTime);
            if (infoList.programInfo[i].startTime > currentTime || infoList.programInfo[i].endTime < currentTime) {
                debugPrint("start is bigger than current  time or end time is smaller than current!!!!!!!!!!!!!:");
            } else {
                if (infoList.programInfo[i].startTime == currentTime) {
                    $("#chl_spl_progress_color").css("width", 0);
                } else if (currentTime == infoList.programInfo[i].endTime) {
                    $("#chl_spl_progress_color").css("width", 190);
                } else {
                    var width = (currentTime - infoList.programInfo[i].startTime) / (infoList.programInfo[i].endTime - infoList.programInfo[i].startTime) * 190;
                    $("#chl_spl_progress_color").css("width", width);
                }

            }
        } else {
            var str = startStr + " - " + endStr;
            $("#chl_spl_middle_time" + i).text(str);
        }
    }
}

function chl_ui_hideProgramList() {
    $("#chl_showProgramList").css("display", "none");
}

function chl_ui_showAudioOnly(text) {
    $("#chl_showAudioOnly").css("display", "block");
    $("#chl_sao_text").text("" + text);
}
function chl_ui_hideAudioOnly() {
    $("#chl_showAudioOnly").css("display", "none");
}

function chl_ui_showNoSignal(x, y, text, status) {
    //debugPrint("show NoSignal");
    if (status) {
        $("#chl_showNoSignal").css("display", "block");
    }
    $("#chl_showNoSignal").css("left", x);
    $("#chl_showNoSignal").css("top", y);
    $("#chl_sns_text").text("" + text);
}
function chl_ui_hideNoSignal() {
    $("#chl_showNoSignal").css("display", "none");
}

function chl_ui_showPowerOffDialog(content, cancelText, imgShow) {
    $("#chl_showPowerOffDialog").css("display", "block");
    if (imgShow) {
        $("#chl_spd_alert").css("visibility", "visible");
    } else {
        $("#chl_spd_alert").css("visibility", "hidden");
    }
    var str = content;
    str = str.replace(/\n/g, "<br>");
    var str1 = suolve(100, str);
    $("#chl_spd_content").html("" + str1);
    $("#chl_spd_btn_cancel").text("" + cancelText);
}
function chl_ui_hidePowerOffDialog() {
    $("#chl_showPowerOffDialog").css("display", "none");
}

function chl_ui_showDialog(content, okText, cancelText, imgShow) {

    $("#chl_showDialog").css("display", "block");
    if (imgShow) {
        $("#chl_sdg_alert").css("visibility", "visible");
    } else {
        $("#chl_sdg_alert").css("visibility", "hidden");
    }
    var str = content;
    str = str.replace(/\n/g, "<br>");
    var str1 = suolve(100, str);
    $("#chl_sdg_content").html("" + str1);
    $("#chl_sdg_btn_ok").text("" + okText);

    $("#chl_sdg_btn_cancel").text("" + cancelText);
}
function chl_ui_setDialogData(focus) {
    if (focus == 1) {
        $("#chl_sdg_btn_ok").removeClass("chl_sdg_btn_unfocus");
        $("#chl_sdg_btn_ok").addClass("chl_sdg_btn_focus");
        $("#chl_sdg_btn_cancel").removeClass("chl_sdg_btn_focus");
        $("#chl_sdg_btn_cancel").addClass("chl_sdg_btn_unfocus");
    } else {
        $("#chl_sdg_btn_ok").removeClass("chl_sdg_btn_focus");
        $("#chl_sdg_btn_ok").addClass("chl_sdg_btn_unfocus");
        $("#chl_sdg_btn_cancel").removeClass("chl_sdg_btn_unfocus");
        $("#chl_sdg_btn_cancel").addClass("chl_sdg_btn_focus");
    }
}

function chl_ui_hideDialog() {
    $("#chl_showDialog").css("display", "none");
}

function chl_ui_showInputPassword(passwordText) {
    $("#chl_showInputPassword").css("display", "block");
    chl_ui_clearInputPassword();
    $("#chl_sip_zipContainer1").removeClass("chl_sip_zipContainerNormal");
    $("#chl_sip_zipContainer1").addClass("chl_sip_zipContainerFocus");
    var str = passwordText;
    str = str.replace(/\n/g, "<br>");
    var str1 = suolve(100, str);
    $("#chl_sip_text").html(str1);
    $("#chl_sip_input1").focus();
}
function chl_ui_clearInputPassword() {
    for (var i = 1; i < 5; i++) {
        $("#chl_sip_zipContainer" + i).removeClass("chl_sip_zipContainerFocus");
        $("#chl_sip_zipContainer" + i).addClass("chl_sip_zipContainerNormal");
        $("#chl_sip_input" + i).val('');
        $("#chl_sip_input" + i).blur();
    }
}

function chl_getPasswordFromInput() {
    var str = "";
    for (var i = 1; i < 5; i++) {
        str = str + $("#chl_sip_input" + i).val();
    }
    return str;
}

function chl_ui_setInputPasswordFocus(index, num) {
    debugPrint("index", index);
    //chl_ui_clearInputPassword();
    if (index > 1) {
        $("#chl_sip_zipContainer" + (index - 1)).removeClass("chl_sip_zipContainerFocus");
        $("#chl_sip_zipContainer" + (index - 1)).addClass("chl_sip_zipContainerNormal");
        $("#chl_sip_zipContainer" + index).removeClass("chl_sip_zipContainerNormal");
        $("#chl_sip_zipContainer" + index).addClass("chl_sip_zipContainerFocus");
        $("#chl_sip_input" + (index - 1)).val(num);
        $("#chl_sip_input" + (index - 1)).blur();
        $("#chl_sip_input" + index).focus();
    } else {
        $("#chl_sip_input4").val(num);
    }

}

function chl_ui_hideInputPassword() {
    $("#chl_showInputPassword").css("display", "none");
    chl_ui_clearInputPassword();
}


function chl_showFirstPlayTv() {
    debugPrint("chl_showFirstPlayTv!!!");
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    hiWebOsFrame.enablePageKeys(hiWebOsFrame.blankPage, [VK_MUTE, VK_VOLUME_DOWN, VK_VOLUME_UP, VK_KEYPAD_VOLUME_DOWN, VK_KEYPAD_VOLUME_UP]);
    chl_setKeyManager("firstTvShowPage");
    chl_ui_showFirstPlayTv();
    setTimeout(chl_showFirstPvr, 2000);
}

function chl_showFirstPvr() {
    chl_ui_showFirstPvr();
    setTimeout(chl_showFirstWatch, 2000);
}

function chl_showFirstWatch() {
    chl_ui_showFirstWatch();
    setTimeout(chl_showFirstInfo, 2000);
}

function chl_showFirstInfo() {
    chl_ui_showFirstInfo();
    setTimeout(chl_hideFirstPlayTv, 10 * 1000);
}

function chl_hideFirstPlayTv() {
    chl_ui_hideFirstPlayTv();
    chl_setKeyManager("blankPage");
    model.tvservice.setPlaySuccessLiveTV(1);
    hiWebOsFrame.clearEnablePageKeys(hiWebOsFrame.blankPage);
}

function chl_hideShowPowerOffDialog() {
    clearTimeout(chl_g_timer.noSignalTimer);
    chl_g_timer.noSignalTimer = null;
    clearTimeout(chl_g_timer.startToPowerOff);
    chl_g_timer.startToPowerOff = null;
    chl_ui_hidePowerOffDialog();
    chl_g_showPowerOffTimerCnt = 60;
    chl_setKeyManager("blankPage");
}

function chl_showOtherSourceInfoBar(info, flag) {
    if (chl_g_timer.showOtherInfoBarTimer != null) {
        clearTimeout(chl_g_timer.showOtherInfoBarTimer);
        chl_g_timer.showOtherInfoBarTimer = null;
    }
    if (!hiWebOsFrame.isCurrentModule("channelList") || !chl_g_blank_showStatus) {
        return;
    }

    clearTimeout(chl_g_timer.showInfoBarTimer);
    chl_ui_hideInfoBar();
    chl_liveTvUIOpen();
    if (chl_liveTvUIShow != 1) {
        chl_liveTvUIShow = 2;
    }
    chl_ui_showOtherSourceInfoBar(info, flag);
    chl_g_timer.showOtherInfoBarTimer = setTimeout(chl_ui_hideOtherSourceInfoBar, chl_g_timeout.showOtherInfoBarTimeout);
}

function chl_showInfoBarQuick(channelInfo) {
    clearTimeout(chl_g_timer.showInfoBarTimer);
    chl_g_timer.showInfoBarTimer = null;
    chl_g_infoBar_mode = 0;
    chl_ui_hideInfoBarRight();
    chl_g_switchChannelNum = channelInfo.uid;
    chl_ui_hideInfoDetail();
    if (chl_liveTvUIShow != 1) {
        chl_liveTvUIShow = 2;
    }
    chl_liveTvUIOpen();
    chl_ui_showInfoBarQuick(channelInfo);
    chl_g_timer.showInfoBarTimer = setTimeout(chl_ui_hideInfoBar, chl_g_timeout.showInfoBarTimeout);
}


var chl_g_month = ['Jan.', 'Feb.', 'Mar.', 'Apr.', 'May', 'Jun.', 'Jul.', 'Aug.', 'Sep.', 'Oct.', 'Nov.', 'Dec.'],
    chl_g_weekShort = ['Sun.', 'Mon.', 'Tue.', 'Wed.', 'Thu.', 'Fri.', 'Sat.'],
    chl_g_weekFull = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

function chl_longTimeToLocalDate(longTime) {
    var utcdate = new Date(longTime);
    var d = '0' + utcdate.getDate();
    return d.slice(-2) + ' ' + chl_g_month[utcdate.getMonth()];
}
var chl_milliBase = 1000;
function chl_getDVBTime() {

    //tv && model.tvservice.getDateTime();
    //debugPrint("chl_getDVBTime::::::::" + model.tvservice.getDateTime());

    //var d = tv ? model.tvservice.getDateTime() : Math.floor(Date.now() / chl_milliBase);
    var d = model.tvservice.getDateTime();
    debugPrint("chl_getDVBTime::::::::" + d);
    return new Date(d * chl_milliBase + (3600000 * chl_g_timeZone));
}

function chl_showInfoBar(channelInfo) {
    clearTimeout(chl_g_timer.showInfoBarTimer);
    clearTimeout(chl_g_timer.showInfoBarNoInforTimer);
    chl_liveTvUIOpen();
    if (chl_g_timer.showOtherInfoBarTimer != null) {
        clearTimeout(chl_g_timer.showOtherInfoBarTimer);
        chl_g_timer.showOtherInfoBarTimer = null;
        chl_ui_hideOtherSourceInfoBar();
    }
    if (chl_g_timer.showChannelNumTimer != null) {
        clearTimeout(chl_g_timer.showChannelNumTimer);
        chl_ui_hideChannelNum();
    }
    if (!chl_g_blank_showStatus) {
        chl_g_sourceInfo.tvShowInfoBar = true;
        return;
    }

    if (chl_getKeyManager() != "blankPage") {
        if (chl_getKeyManager() == "showInputPassword") {

        } else {
            return;
        }
    }
    chl_liveTvUIOpen();
    if (chl_liveTvUIShow != 1) {
        chl_liveTvUIShow = 2;
    }
    chl_g_infoBar_mode = 0;
    chl_g_sourceInfo.tvShowInfoBar = false;
    var time;
    var timeShow = "";
    var timeStr;
    time = chl_getDVBTime();
    debugPrint("Date time:::::::::::::::::::" + time);
    try {
        if (chl_g_timeFormat == 0) {
            timeStr = utcTimeToLocalTime12(time);
        } else {
            timeStr = utcTimeToLocalTime24(time);
        }
        var dateStr = chl_longTimeToLocalDate(time);
        timeShow = timeStr + "&nbsp;&nbsp;" + chl_g_weekShort[time.getUTCDay()] + "&nbsp;&nbsp;" + dateStr;
    } catch (e) {
        debugPrint(e.message);
    }
    //var dateStr = UTCToLocalDate(time);
    chl_ui_showInfoBar(channelInfo, timeShow, chl_g_tunerMode);
    chl_g_timer.showInfoBarTimer = setTimeout(chl_hideInfoBar, chl_g_timeout.showInfoBarTimeout);
}

function chl_hideInfoBar() {
    clearTimeout(chl_g_timer.showInfoBarTimer);
    clearTimeout(chl_g_timer.showInfoBarNoInforTimer);
    chl_g_timer.showInfoBarTimer = null;
    chl_g_infoBar_mode = CHL_INFO_NOPROGRAM;
    chl_g_timeout.showInfoBarTimeout = 5 * 1000;
    chl_ui_hideInfoBar();
    chl_liveTvUIClose();
}

function chl_showInfoBarRight(flag, action,status) {
    debugPrint("chl_showInfoBarRight:" + chl_getNowEpg_status + action+status);
    if (chl_getNowEpg_status && action) {
        clearTimeout(chl_g_timer.showInfoBarTimer);
        clearTimeout(chl_g_timer.showInfoBarNoInforTimer);
        chl_g_timer.showInfoBarTimer = setTimeout(chl_ui_hideInfoBar, chl_g_timeout.showInfoBarTimeout);
        return;
    }
    clearTimeout(chl_g_timer.showInfoBarTimer);
    clearTimeout(chl_g_timer.showInfoBarNoInforTimer);
    if(!status){
        chl_g_infoBar_mode = CHL_INFO_NORMAL;
    }
    else if(status ||(chl_g_epgNow!=null && chl_g_epgNow.startTime.length == 0) || chl_g_epgNow == null){
        chl_g_infoBar_mode = CHL_INFO_NOPROGRAM;
    }

    var currentTime = model.tvservice.getDateTime();
    var videoInfo = chl_getTvVideoFormatInfo();
    var audioInfo = chl_getTvAudioFormatInfo();
    var sap = null;
    if (chl_g_channelInfo.tvType == CHL_ATV) {
        sap = model.sound.getSap();
    }
    chl_ui_showInfoBarRight(currentTime, videoInfo, audioInfo, chl_g_epgNow, flag, sap);
    chl_g_timer.showInfoBarTimer = setTimeout(chl_ui_hideInfoBar, chl_g_timeout.showInfoBarTimeout);
}

function chl_showInfoBarDetail() {

    clearTimeout(chl_g_timer.showInfoBarTimer);
    clearTimeout(chl_g_timer.showInfoBarNoInforTimer);
    chl_ui_hideInfoBarRight();
    chl_ui_hideInfoBarLeft();
    chl_ui_showInfoBarDetail(chl_g_epgNow);
    var value = model.tvservice.getSignalMainLevels();
    var level = value + "%";
    try {
        if (chl_g_channelInfo.channelName.length == 0) {
            chl_ui_showInfoBarSignal(level, "20%", chl_g_channelInfo.channelNum);
        } else {
            chl_ui_showInfoBarSignal(level, "20%", chl_g_channelInfo.channelName);
        }

    } catch (e) {
        debugPrint(e.message);
    }
    chl_g_timer.showInfoBarTimer = setTimeout(chl_ui_hideInfoBar, chl_g_timeout.showInfoBarTimeout);
}

function chl_liveTvUIOpen(){
    var smooth = model.video.getEnumSmoothMotion();
    if (smooth != 0) {
        var val = 101;
        model.video.setEnumSmoothMotion(val);
        DBG_ALWAYS("chl_liveTvUIOpen  memc close!!!!!!!!!!!!!!!!!!!!!!!!!!!!");

    }
}
function chl_liveTvUIClose() {
    if (chl_liveTvUIShow == 0) {
        model.video.setEnumSmoothMotion(100);
        debugE("chl_liveTvUIClose  memc open!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
    }
}
function chl_showChannelNum(number) {
    if (chl_g_timer.showChannelNumTimer != null) {
        clearTimeout(chl_g_timer.showChannelNumTimer);
    }
    if (chl_g_timer.showInfoBarTimer != null) {
        clearTimeout(chl_g_timer.showInfoBarTimer);
        chl_ui_hideInfoBar();
    }
    chl_liveTvUIOpen();
    if (chl_liveTvUIShow != 1) {
        chl_liveTvUIShow = 2;
    }
    chl_ui_showChannelNum(number);
    chl_g_timer.showChannelNumTimer = setTimeout(chl_hideChannelNum, chl_g_timeout.showChannelNumTimeout);
}

function chl_hideChannelNum() {
    if (chl_liveTvUIShow == 2) {
        chl_liveTvUIShow = 0;
    }
    chl_liveTvUIClose();
    chl_ui_hideChannelNum();
}

function chl_showChannelList(focusIndex) {
    if (chl_g_timer.showChannelListTimer != null) {
        clearTimeout(chl_g_timer.showChannelListTimer);
    }
    debugPrint("chl_g_typeIndex:" + chl_g_typeIndex + "chl_g_channelList.length" + chl_g_channelList.length);
    if (chl_g_typeIndex == null || chl_g_typeIndex == -1 || chl_g_channelList.length == 0) {
        debugPrint("not get the channel list by the current channel!!!!!!!!!!!!!!!!!!!!! ");
//        chl_g_channelTypeList = [];
//        //chl_data_getChannelTypeList();
//        //chl_setRefreshChannelInfoCallback(chl_refreshChannelList);
       // return;
        chl_g_focusIndex = 0;
        focusIndex = 0;
        chl_g_typeIndex = 0;
    }
    if (chl_g_channelList.length > 0) {
        if (chl_g_typeIndex >= chl_g_channelList.length) {
            debugPrint(" channel list has some ting wrong !!!!!!!!!!!!!!!!!!!!! ");
            return;
        }
    }

    try {
        debugPrint("show  channel list focus:" + focusIndex);
        //debugPrint("aa:"+JSON.stringify(chl_g_channelList));
        chl_ui_showChannelList(focusIndex, chl_g_channelList[chl_g_typeIndex]);
    } catch (e) {
        debugPrint(e.message);
    }
    chl_setKeyManager("channelListPage");

    chl_g_timer.showChannelListTimer = setTimeout(function () {
        chl_hideChannelList(true);
    }, chl_g_timeout.showChannelListTimeout);
}

function chl_forceHideChannelList() {
    chl_hideChannelList(true);

}
function chl_hideChannelList(status) {

    if (chl_g_timer.showChannelListTimer != null) {
        clearTimeout(chl_g_timer.showChannelListTimer);
    }
    chl_g_timer.showChannelListTimer = null;
    if (status) {
        //debugPrint("hide!!!!!!!!!!!");
        if (chl_g_channelInfo != null) {
            chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
            if (chl_g_focusIndex == -2) {
                chl_g_focusIndex = 0;
            }
        }
    }
    chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
    chl_ui_hideChannelList();
    chl_setKeyManager("blankPage");
}

function chl_showChannelListLeft() {


    if (chl_g_timer.showChannelListTimer != null) {
        clearTimeout(chl_g_timer.showChannelListTimer);
    }
    if (chl_g_timer.showChannelListLeftTimer != null) {
        clearTimeout(chl_g_timer.showChannelListLeftTimer);
    }
    var i = 0;
    var focus = 0;
    for (i = 0; i < chl_g_channelTypeList.length; i++) {
        // console.log("CHL:",""+chl_g_channelTypeList[i].channelType);
        if (chl_g_channelTypeList[i].uid == chl_g_channelList[chl_g_typeIndex].type) {
            chl_g_channelTypeList[i].focus = true;
            chl_g_channelTypeList[i].current = true;
            chl_g_leftFocusLine = i;
            focus = i;
        } else {
            chl_g_channelTypeList[i].focus = false;
            chl_g_channelTypeList[i].current = false;
        }
    }
    if (focus > 10) {
        chl_g_leftFocusLine = 10;
    }
    chl_ui_showChannelListLeft(chl_g_channelTypeList, focus);
    chl_setKeyManager("channelListLeftPage");
    chl_g_timer.showChannelListLeftTimer = setTimeout(chl_hideChannelListLeft, chl_g_timeout.showChannelListLeftTimeout);
}

function chl_forceHideChannelListLeft() {
    chl_hideChannelListLeft();
    chl_hideChannelList(true);
}

function chl_hideChannelListLeft() {

    clearTimeout(chl_g_timer.showChannelListLeftTimer);
    chl_g_timer.showChannelListLeftTimer = null;
    chl_ui_hideChannelListLeft();
    chl_g_timer.showChannelListTimer = setTimeout(function () {
        chl_hideChannelList(true);
    }, chl_g_timeout.showChannelListTimeout);
    chl_setKeyManager("channelListPage");
}

function chl_showProgramList() {
    if (chl_g_timer.showProgramListTimer != null) {
        clearTimeout(chl_g_timer.showProgramListTimer);
    }
    chl_ui_showProgramList(chl_g_programList);
    chl_setKeyManager("programListPage");
    chl_g_timer.showProgramListTimer = setTimeout(function () {
        chl_hideProgramList(true);
    }, chl_g_timeout.showProgramListTimeout);
}

function chl_forceHideProgramList() {
    chl_hideProgramList(true);
}
function chl_hideProgramList(status) {
    if (chl_g_timer.showProgramListTimer != null) {
        clearTimeout(chl_g_timer.showProgramListTimer);
    }
    chl_g_timer.showProgramListTimer = null;
    if (status) {
        if (chl_g_channelInfo != null) {
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
        }
    }
    chl_ui_hideProgramList();
    chl_setKeyManager("blankPage");
}

function chl_showAudioOnly() {
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    var data = Hisense.File.read(RETAILMODE_FLAG_FILE, 0);
    if (data == "open") { //ePos is running.
        return;
    }
    chl_ui_showAudioOnly(chl_lang.radioChannel);
}
function chl_hideAudioOnly() {
    chl_ui_hideAudioOnly();
}

function chl_showNoSignal() {
    //debugPrint("start to show NoSignal !" + Date.now());
    chl_clearNoSignalCounter();
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    var data = Hisense.File.read(RETAILMODE_FLAG_FILE, 0);
    if (data == "open") { //ePos is running.
        return;
    }

    clearTimeout(chl_g_timer.noSignalTimerShow);
    chl_g_timer.noSignalTimerShow = null;
    clearTimeout(chl_g_timer.noSignalTimer);
    chl_g_timer.noSignalTimer = null;
    chl_loopShowNoSignal(true);
    chl_startNoSignalCounter();
    //chl_g_timer.noSignalTimer = setTimeout(chl_showStartToPowerOff, chl_g_timeout.noSignalTimeOut);
}

function chl_startNoSignalCounter() {

    chl_g_noSignal_cnt++;
    var timer_Num = 420;
    //debugPrint("chl_startNoSignalCounter " + chl_g_noSignal_cnt);
    if(hiWebOsFrame.getCurrentArea()=="SA"){
        timer_Num = 120;
    }
    if (chl_g_noSignal_cnt > timer_Num) {
        debugPrint("hotel.getHotelMode() " + model.hotel.getHotelMode());
        debugPrint("model.hotel.getAutoSleep() " + model.hotel.getAutoSleep());
        if(model.hotel.getHotelMode() == 1 && model.hotel.getAutoSleep()==0){
            //chl_loopShowNoSignal(true);
            debugPrint("it is HotelMode !!!!!!!",DebugLevel.ALWAYS);
            return;
        }
        chl_hideNoSignal();
        chl_showStartToPowerOff();
        return;
    }
    chl_g_timer.noSignalTimer = setTimeout(chl_startNoSignalCounter, 2 * 1000);
}

function chl_showPowerOff(str) {
    chl_ui_showPowerOffDialog(str, chl_lang.cancel, true);
    if (chl_g_showPowerOffTimerCnt > 0) {
        chl_g_showPowerOffTimerCnt--;
    } else {
        chl_startToPowerOff();
    }
    var text = getShowPowerOffText(chl_g_showPowerOffLan, chl_g_showPowerOffTimerCnt);
    chl_g_timer.startToPowerOff = setTimeout(function () {
        chl_showPowerOff(text);
    }, 1000);
}

function chl_showStartToPowerOff() {
    clearTimeout(chl_g_timer.noSignalTimer);
    clearTimeout(chl_g_timer.noSignalTimerShow);
    //debugPrint("start to powerOff!!!!!!!!!!!!! ");
    chl_clearNoSignalCounter();
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus || chl_getKeyManager() != "blankPage") {
        return;
    }
    debugPrint("show PowerOff!!!!" + Date.now());

    hiWebOsFrame.createPage('livetv_auto_standby', null,hiWebOsFrame.getCurrentPage(), null, function (a) {
        hiWebOsFrame.livetv_auto_standby = a;
        a.operateData.powerOffReason = 1;
        a.open();
        a.hiFocus();
    });
//    chl_g_showPowerOffTimerCnt = 60;
//    var str = getShowPowerOffText(chl_g_showPowerOffLan, chl_g_showPowerOffTimerCnt);
//    chl_showPowerOff(str);
//    chl_setKeyManager("showPowerOffDialog");
}



function chl_startToPowerOff() {
    debugPrint("call startToPowerOff!!!!!!!!!!!!");
    clearTimeout(chl_g_timer.startToPowerOff);
    chl_g_timer.startToPowerOff = null;
    chl_hideNoSignal();
    chl_ui_hidePowerOffDialog();
    model.system.SwitchOffTv();
}

function chl_clearNoSignalCounter() {
    debugPrint("chl_clearNoSignalCounter ");
    chl_g_noSignal_cnt = 0;
    clearTimeout(chl_g_timer.noSignalTimer);
    clearTimeout(chl_g_timer.noSignalTimerShow);
    chl_g_timer.noSignalTimer = null;
}

function chl_loopShowNoSignal(status) {

    clearTimeout(chl_g_timer.noSignalTimerShow);

    var left = fRandomBy(0, 1652);
    var top = fRandomBy(0, 930);
    chl_ui_showNoSignal(left, top, chl_lang.noSignal, status);
    chl_g_timer.noSignalTimerShow = setTimeout(function () {
        chl_loopShowNoSignal(false);
    }, 1500);
}

function chl_hideNoSignal() {
    chl_clearNoSignalCounter();
    //if (chl_g_timer.noSignalTimerShow != null) {
    clearTimeout(chl_g_timer.noSignalTimerShow);
    chl_g_timer.noSignalTimerShow = null;
    chl_ui_hideNoSignal();
    clearTimeout(chl_g_timer.noSignalTimer);
    chl_g_timer.noSignalTimer = null;
    chl_g_noSignal_cnt = 0;

}


function chl_forceHideDialog() {
    clearTimeout(chl_g_timer.noSignalTimer);
    chl_g_timer.noSignalTimer = null;
    clearTimeout(chl_g_timer.startToPowerOff);
    chl_g_timer.startToPowerOff = null;
    chl_ui_hideDialog();
    chl_setKeyManager("blankPage");
}

function chl_startToSearch() {
    closePagesOrModuleByPage(hiWebOsFrame.getCurrentPage());
    switch (hiWebOsFrame.getCurrentArea()){
        case "EU":
            LauncherquickopenSetting(2, 0, hiWebOsFrame.blankPage);
            break;
        default :
            startSearchChannelFromLiveTv();
            break;
    }
}
function chl_stopToSearch() {
   // chl_ui_hideDialog();
   // chl_setKeyManager("blankPage");
    if (hiWebOsFrame.getCurrentPageId() != "setting_pic_Source_page") {

        hiWebOsFrame.createPage('setting_pic_Source_page', null, null, null, function (setting_source_page) {
            hiWebOsFrame.setting_source_page = setting_source_page;
            if (!checkAndCloseIfAppOn(setting_source_page)) {
                closePagesOrModuleByPage(hiWebOsFrame.getCurrentPage());
                setting_source_page.open();
                setting_source_page.hiFocus();
            }
            else {
                setting_source_page.origin = hiWebOsFrame.blankPage;
            }
        });
    }
}
function chl_showStartToSearch() {
    if (Hisense.File.read(RETAILMODE_FLAG_FILE, 0) == "open") {
        return;
    }
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus) {
        return;
    }
    if (!chl_g_getChlistFinish) {
        return;
    }
    chl_g_dialogOpts.focus = 2;
    chl_g_dialogOpts.okCommand = chl_startToSearch;
    chl_g_dialogOpts.cancelCommand = chl_stopToSearch;
    chl_ui_setDialogData(2);
    chl_ui_showDialog(chl_lang.toSearch, chl_lang.startSearch, chl_lang.input, false);
    chl_setKeyManager("showDialog");
}

function chl_hideStartToSearchDialog() {
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (!chl_g_blank_showStatus) {
        return;
    }
    var data = Hisense.File.read(RETAILMODE_FLAG_FILE, 0);
    if (data == "open") { //ePos is running.
        return;
    }
    chl_ui_hideDialog();
    if (chl_getKeyManager() == "showDialog") {
        chl_setKeyManager("blankPage");
    }
}

function chl_stopToPlayTv() {
    chl_g_switchChannelNum = chl_g_channelInfo.channelNum;
    chl_ui_hideDialog();
    chl_setKeyManager("blankPage");
}

function chl_stopTimeShiftToPlayTv() {
    debugPrint("chl_stopTimeShiftToPlayTv!!!!!!!!!!!!!");
    try {
        DBG_ALWAYS("model.pvr.StopRecord()");
        model.pvr.StopRecord();
        model.timeshift.Stop();
    }
    catch (ex) {
        debugPrint('setRecorderStates:--' + ex);
    }
    chl_setKeyManager("blankPage");
    if (chl_g_dialogOpts.info != null) {
        chl_startToPlayTv(chl_g_dialogOpts.info, false);
    } else {
//        if (chl_g_dialogOpts.keyCode == hiWebOsFrame.getKeyValues().keyHome) {
//            chl_goHome();
//        } else if (chl_g_dialogOpts.keyCode == hiWebOsFrame.getKeyValues().keyMedia) {
//            goHiMedia(0);
//        }
    }
}

function chl_showStopTimeShiftDialog(info, key) {
    chl_g_dialogOpts.focus = 2;
    chl_g_dialogOpts.info = info;
    chl_g_dialogOpts.keyCode = key;
    chl_g_dialogOpts.okCommand = chl_stopTimeShiftToPlayTv;
    chl_g_dialogOpts.cancelCommand = chl_stopToPlayTv;
    chl_ui_setDialogData(2);
    chl_ui_showDialog(chl_lang.sureExitPvr, chl_lang.ok, chl_lang.cancel, true);
    chl_setKeyManager("showDialog");
}

function chl_showInputPassword() {
    if (!hiWebOsFrame.isCurrentModule("channelList")) {
        return;
    }
    if (getMainInputPasswordStatus()) {
        return;
    }
    if (!chl_g_blank_showStatus) {
        return;
    }
    if (chl_g_timer.showInfoBarTimer != null && (chl_g_infoBar_mode == CHL_INFO_NORMAL || chl_g_infoBar_mode == CHL_INFO_DETAIL|| chl_g_infoBar_mode == CHL_INFO_NOW)) {
        chl_hideInfoBar();
    }
    if (chl_getKeyManager() == "blankPage" || chl_getKeyManager() == "showInputPassword") {
        chl_g_inputPwdFocusIndex = 1;
        chl_ui_showInputPassword(chl_lang.enterPwd);
        chl_setKeyManager("showInputPassword");
    }

}

function chl_forceHideInputPassword() {
    chl_hideInputPassword(true);
}
function chl_hideInputPassword(flag) {
    chl_ui_hideInputPassword();
    if (flag) {
        chl_setKeyManager("blankPage");
    }
}

function chl_data_getProgramForList(info) {
}

function chl_onCurrentSourceVideoFormatChanged(value) {
    debugPrint("chl_onCurrentSourceVideoFormatChanged" + JSON.stringify(value), DebugLevel.ALWAYS);
    if (value.length == 0) {
        return;
    }
    for (var j = 0; j < chl_g_dpm_list.length; j++) {
        if (chl_g_dpm_list[j].name == "showNoSignal") {
            return;
        }
    }
    var wide_str = "";
    var hz_str = "";
    if (chl_g_timer.showOtherInfoBarTimer != null) {
        if (value.length > 0) {
            var array = value.split(",");
            if (chl_g_sourceInfo.uid != 1) {
                if (array.length > 1) {
                    if (array[0] == 0) {
                        return;
                    }
                    wide_str = array[0] + "*" + array[1];
                    if (wide_str != "640*480" && wide_str != "800*600" && wide_str != "1024*768") {
                        if (array[2] == 0) {
                            wide_str = array[0] + "*" + array[1] + "i";
                        } else if (array[2] == 1) {
                            wide_str = array[0] + "*" + array[1] + "p";
                        }
                    }
                }
            } else {
                if (array.length > 1) {
                    if (array[1] == 576) {
                        wide_str = array[1];
                        hz_str = "PAL";
                    } else if (array[1] == 480) {
                        wide_str = array[1];
                        hz_str = "NTSC";
                    }
                    if (array[2] == 0) {
                        wide_str = wide_str + "i";
                    } else if (array[2] == 1) {
                        wide_str = wide_str + "p";
                    }
                }
            }
            $("#chl_sos_text").text(wide_str);
            $("#chl_sos_hz").text(hz_str);
        }
    } else {
        if (!chl_g_sourceInfo.tvSource) {
            if (!hiWebOsFrame.isCurrentModule("channelList")) {
                return;
            }
            chl_showOtherSourceInfoBar(chl_g_sourceInfo, true);
        }

    }
}

function CHL_setSourceRename(uid, newName) {
    debugPrint("CHL_setSourceRename::::" + uid + "newname:" + newName);
    if (uid >= 0 && uid <= 6) {
        chl_source_uid[uid] = newName;
        if (chl_g_sourceInfo.uid == uid) {
            chl_g_sourceInfo.channelName = chl_source_uid[uid];
        }
    }
}

function CH_setSourceLocked(uid, lockFlag) {
    debugPrint("CH_setSourceLocked::::" + uid + "lockFlag:" + lockFlag);
    if (uid >= 0 && uid <= 7) {
        chl_source_lock[uid] = lockFlag;
        if (chl_g_sourceInfo.uid == uid && chl_g_sourceInfo.uid != 0) {
            if (lockFlag == 1) {
                chl_source_lock[uid] = lockFlag;
                debugPrint("::::::" + getMainInputPasswordStatus());
                var lock = getCurrentLockTime();
                if (lock && !getMainInputPasswordStatus()) {
                    for (var i = 0; i < chl_g_dpm_list.length; i++) {
                        if (chl_g_dpm_list[i].name == "showInputPassword") {
                            chl_g_dpm_list.splice(i, 1);
                            break;
                        }
                    }
                    var info = {};
                    info.name = "showInputPassword";
                    info.callback = "chl_showInputPassword";
                    chl_g_dpm_list.push(info);
                    if (chl_g_sourceInfo.uid == 0) {
                        chl_g_password.unLock = false;
                    }
                } else {
                    for (var i = 0; i < chl_g_dpm_list.length; i++) {
                        if (chl_g_dpm_list[i].name == "showInputPassword") {
                            chl_g_dpm_list.splice(i, 1);
                            break;
                        }
                    }
                }
            } else {
                chl_source_lock[uid] = lockFlag;
                if (!getMainInputPasswordStatus()) {
                    for (var i = 0; i < chl_g_dpm_list.length; i++) {
                        if (chl_g_dpm_list[i].name == "showInputPassword") {
                            chl_g_dpm_list.splice(i, 1);
                            chl_g_inputPwdFocusIndex = 1;
                            chl_ui_hideInputPassword();
                            break;
                        }
                    }
                    if (chl_g_sourceInfo.uid == 0) {
                        chl_g_password.unLock = true;
                    }
                }
            }
        } else {
            if(uid == 0){
                if(lockFlag == 1) {
                    // chl_g_password.unLock = false;
                }else{
                    if (chl_g_sourceInfo.uid == 0 && !getMainInputPasswordStatus()) {
                        // chl_g_password.unLock = true;
                        for (var i = 0; i < chl_g_dpm_list.length; i++) {
                            if (chl_g_dpm_list[i].name == "showInputPassword") {
                                chl_g_dpm_list.splice(i, 1);
                                chl_g_inputPwdFocusIndex = 1;
                                chl_ui_hideInputPassword();
                                if(chl_g_channelInfo!=null){
                                    model.tvservice.playChannel(chl_g_channelInfo.playId, chl_g_channelInfo.uid);
                                }
                                break;
                            }
                        }
                    }
                }
            }
        }
    }
}

function chl_cecChangeSource(value) {
    debugPrint("chl_cecChangeSource::::::::::::::::::::::::::::::: " + JSON.stringify(value), DebugLevel.ALWAYS);
    var id = 0;
    if (value >= 48 && value <= 55) {
        id = value - 48;
    }
    if (value >= 0 && value <= 7) {
        id = value;
    }
    if (id == 0) {
        chl_g_sourceInfo.tvSource = true;
    } else {
        chl_g_sourceInfo.tvSource = false;
    }
    if (id == chl_g_sourceInfo.uid) {
        return;
    }
    CHL_clearInputPassword();
    model.source.InputSet(id);
    var lock = getCurrentLockTime();
    if (lock && !getMainInputPasswordStatus()) {
        if (id != 0) {
            if (chl_source_lock[id] == 1) {
                for (var i = 0; i < chl_g_dpm_list.length; i++) {
                    if (chl_g_dpm_list[i].name == "showInputPassword") {
                        chl_g_dpm_list.splice(i, 1);
                        break;
                    }
                }
                var info = {};
                info.name = "showInputPassword";
                info.callback = "chl_showInputPassword";
                chl_g_dpm_list.push(info);
                chl_showInputPassword();
            }
        }
    } else {
        model.parentlock.InputBlock(id, 0, 1);
    }
    ReadInputRecent("" + id);
}

function chl_CurrentSourcePlay(value) {
    debugPrint("chl_CurrentSourcePlay::::::::::::::::::::::::::::::: " + JSON.stringify(value), DebugLevel.ALWAYS);
    var id = 0;
    if (value >= 48 && value <= 55) {
        id = value - 48;
    }
    if (value >= 0 && value <= 7) {
        id = value;
    }
    if (id != 0) {
        pauseHBBTV();
        chl_g_sourceInfo.uid = id;
        chl_g_sourceInfo.channelNum = id;
        chl_g_sourceInfo.channelName = chl_source_uid[id];
        chl_g_sourceInfo.tvSource = false;
        for (var i = 0; i < chl_g_dpm_list.length; i++) {
            if (chl_g_dpm_list[i].name == "showAudioOnly") {
                chl_g_dpm_list.splice(i, 1);
                chl_hideAudioOnly();
            }
        }
        try {
            if (!hiWebOsFrame.isCurrentModule("channelList")) {
                chl_g_sourceInfo.tvShowInfoBar = true;
                return;
            }

            chl_callHideBlankPageBySelf();
            chl_showOtherSourceInfoBar(chl_g_sourceInfo, false);
        } catch (e) {
            debugPrint(e.message);
        }

        //var noSignal = model.source.getCurrentSourceNoSignal();
        //debugPrint("chl_CurrentSourcePlay nosignal::::::::::::::::::::::::::::::: " + noSignal);
    } else {
        chl_g_sourceInfo.uid = id;
        chl_g_sourceInfo.tvSource = true;
        chl_g_sourceInfo.channelNum = "";
        chl_g_sourceInfo.channelName = chl_source_uid[0];
        resumeHBBTV();
    }
}
function getCurrentPlay(value) {
    //$('#debugLog').css('display', 'block');
    debugPrint("getCurrentPlay::::::::::::::::::::::::::::::: " + JSON.stringify(value), DebugLevel.ALWAYS);
    if (!chl_g_sourceInfo.tvSource) {
        if(value.length>0 && value[0].indexOf("e_code") >= 0){
            var array = value[0].split(":");
            if(array.length>1){
                if(array[1] == 9){
                    if (!getMainInputPasswordStatus()) {
                        for (var i = 0; i < chl_g_dpm_list.length; i++) {
                            if (chl_g_dpm_list[i].name == "showInputPassword") {
                                chl_g_dpm_list.splice(i, 1);
                                break;
                            }
                        }
                        var info = {};
                        info.name = "showInputPassword";
                        info.callback = "chl_showInputPassword";
                        chl_g_dpm_list.push(info);
                        //chl_g_password.unLock = false;
                        if (chl_g_blank_showStatus && chl_getKeyManager() == "blankPage") {
                            chl_showInputPassword();
                        }
                    }
                }else if(array[1] == 12){
                    for (var i = 0; i < chl_g_dpm_list.length; i++) {
                        if (chl_g_dpm_list[i].name == "showInputPassword") {
                            chl_g_dpm_list.splice(i, 1);
                            chl_g_inputPwdFocusIndex = 1;
                            chl_ui_hideInputPassword();
                            chl_g_password.unLock = true;
                            if (chl_getKeyManager() == "showInputPassword") {
                                chl_setKeyManager("blankPage");
                            }
                            break;
                        }
                    }
                }
            }

        }
        return;
    }
    if (value.length == 0) {
        chl_g_channelInfo = null;
        debugPrint(" CurrentPlay  is null !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
        return;
    }else if(value.length<7){
        return;
    }
    if(value[1] == 0){
        //chl_g_channelInfo.folderUuid = value[0];
        return;
    }
    if (chl_g_channelInfo != null) {
        if (chl_g_tunerMode == chl_g_channelInfo.folderUuid) {
            if (value[0] == chl_g_channelInfo.uid) {
                //return;
            } else {
                // debugPrint("ui start to play channel1111  ::" , DebugLevel.ALWAYS);
                chl_savePreTVInfo();
                //model.tvservice.playChannel(1, channelInfo.uid);
            }
        } else {
            chl_savePreTVInfo();
            //model.tvservice.playChannel(1, channelInfo.uid);
        }
    }

//    if (chl_g_tunerMode == 1) {
//        for (var i = 0; i < chl_g_dpm_list.length; i++) {
//            if (chl_g_dpm_list[i].name == "showStartToSearchAntenna") {
//                chl_g_dpm_list.splice(i, 1);
//                chl_hideStartToSearchDialog();
//                break;
//            }
//        }
//    } else {
//        for (var i = 0; i < chl_g_dpm_list.length; i++) {
//            if (chl_g_dpm_list[i].name == "showStartToSearchCable") {
//                chl_g_dpm_list.splice(i, 1);
//                chl_hideStartToSearchDialog();
//                break;
//            }
//        }
//    }
    chl_g_sourceInfo.channelNum = value[2];
    chl_g_sourceInfo.channelName = value[3];
    chl_g_sourceInfo.tvSource = true;
    chl_g_channelInfo = {};
    chl_g_channelInfo.folderUuid = value[0];
    chl_g_channelInfo.uid = value[1];
    chl_g_channelInfo.channelNum = value[2];
    chl_g_channelInfo.channelName = value[3];
    chl_g_channelInfo.isLock = chl_isLocked(value[4]);
    chl_g_channelInfo.isEncrypt = chl_isEncrypted(value[4]);
    chl_g_channelInfo.isFav = chl_isFav(value[4]);
    chl_g_channelInfo.tvType = value[5];
    chl_g_channelInfo.playId = (value[6]);
    chl_g_sourceInfo.tvType = chl_g_channelInfo.tvType;
    chl_getNowEpg_status = false;

    //debugPrint("current!!!!!!!!!!!! chl_g_focusIndex: " + chl_g_focusIndex);

    var playStatus = model.tvservice.getPlaySuccessLiveTV();
   // playStatus = 1;
    var array1 = [];
    if(value[7].indexOf("e_code") >= 0){
        array1 = value[7].split(":");
        if(array1.length<2){
            return;
        }
    }else{
        return;
    }
    if (playStatus == 1) {
        //if (chl_g_timer.showInfoBarTimer == null) {
        if (array1[1] == 0) {
            if (chl_g_timer.showInfoBarTimer == null) {
                chl_g_switchChannelNum = chl_g_channelInfo.uid;
                chl_showInfoBar(chl_g_channelInfo);
            }
            chl_g_searchByPlay = 2;
            if (chl_g_getEpg) {
                model.tvservice.getChannelNowPfInfo();
                model.tvservice.getChannelNowPfInfoCallBack = chl_data_getDtvNowInfo;
                model.tvservice.getChannelNextPfInfo();
                model.tvservice.getChannelNextPfInfoCallBack = chl_data_getDtvNextInfo;
                chl_g_epgNow = null;
                chl_g_epgNext = null;
                chl_g_timer.showInfoBarNoInforTimer = setTimeout(function () {
                    chl_showInfoBarRight(true, true,true);
                }, 3000);
            }
            //setTimeout(chl_ui_showInfoBarNoProgram, 2000);
            //}
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "showInputPassword") {
                    chl_g_dpm_list.splice(i, 1);
                    chl_g_inputPwdFocusIndex = 1;
                    chl_ui_hideInputPassword();
                    chl_g_password.unLock = true;
                    if (chl_getKeyManager() == "showInputPassword") {
                        chl_setKeyManager("blankPage");
                    }
                    //break;
                } else if (chl_g_dpm_list[i].name == "showAudioOnly") {
                    chl_g_dpm_list.splice(i, 1);
                    chl_hideAudioOnly();
                } else if (chl_g_dpm_list[i].name == "showNoSignal") {
                    chl_g_dpm_list.splice(i, 1);
                    chl_g_sourceInfo.signal = true;
                    chl_hideNoSignal();
                }
            }
            chl_g_password.unLock = true;
            //chl_setKeyManager("blankPage");
            chl_g_inputPwdFocusIndex = 1;
            chl_ui_hideInputPassword();
            chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
            if (chl_g_typeIndex == null || chl_g_focusIndex == -2) {
                debugPrint("not get the focus index by current!!!!!!!! ", DebugLevel.ALWAYS);
                for (var j = 0; j < chl_g_channelTypeList.length; j++) {
                    if (chl_g_channelInfo.folderUuid == chl_g_channelTypeList[j].uid) {
                        if (!chl_g_channelTypeList[j].get) {
                            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                            chl_data_getChannelList(j, 0);
                            break;
                        }
                    }
                }
            }
        } else if (array1[1] == 5) {
            if (chl_g_timer.showInfoBarTimer == null) {
                chl_g_switchChannelNum = chl_g_channelInfo.uid;
                chl_showInfoBar(chl_g_channelInfo);
            }
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "showAudioOnly") {
                    chl_g_dpm_list.splice(i, 1);
                    chl_hideAudioOnly();
                }
            }
            chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
            if (chl_g_typeIndex == null || chl_g_focusIndex == -2) {
                debugPrint("not get the focus index by current!!!!!!!! ", DebugLevel.ALWAYS);
                for (var j = 0; j < chl_g_channelTypeList.length; j++) {
                    if (chl_g_channelInfo.folderUuid == chl_g_channelTypeList[j].uid) {
                        if (!chl_g_channelTypeList[j].get) {
                            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                            chl_data_getChannelList(j, 0);
                            break;
                        }
                    }
                }
            }

        } else if (array1[1] == 9) {
            if (chl_g_timer.showInfoBarTimer == null) {
                chl_g_switchChannelNum = chl_g_channelInfo.uid;
                chl_showInfoBar(chl_g_channelInfo);
            }
            if (getMainInputPasswordStatus()) {
                for (var i = 0; i < chl_g_dpm_list.length; i++) {
                    if (chl_g_dpm_list[i].name == "showInputPassword") {
                        chl_g_dpm_list.splice(i, 1);
                        chl_g_inputPwdFocusIndex = 1;
                        chl_ui_hideInputPassword();
                        chl_g_password.unLock = true;
                        break;
                    }
                }
                //return;
            }else{
                for (var i = 0; i < chl_g_dpm_list.length; i++) {
                    if (chl_g_dpm_list[i].name == "showInputPassword") {
                        chl_g_dpm_list.splice(i, 1);
                        break;
                    }
                }
                var info = {};
                info.name = "showInputPassword";
                info.callback = "chl_showInputPassword";
                chl_g_dpm_list.push(info);
                chl_g_password.unLock = false;
                if (chl_g_blank_showStatus && chl_getKeyManager() == "blankPage") {
                    setTimeout(chl_showInputPassword, 100);
                }
            }

            chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
            if (chl_g_typeIndex == null || chl_g_focusIndex == -2) {
                debugPrint("not get the focus index by current!!!!!!!! ", DebugLevel.ALWAYS);
                for (var j = 0; j < chl_g_channelTypeList.length; j++) {
                    if (chl_g_channelInfo.folderUuid == chl_g_channelTypeList[j].uid) {
                        if (!chl_g_channelTypeList[j].get) {
                            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                            chl_data_getChannelList(j, 0);
                            break;
                        }
                    }
                }
            }
        } else if (array1[1] == 20) {
            if (chl_g_timer.showInfoBarTimer == null) {
                chl_g_switchChannelNum = chl_g_channelInfo.uid;
                chl_showInfoBar(chl_g_channelInfo);
            }

            chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
            if (chl_g_typeIndex == null || chl_g_focusIndex == -2) {
                debugPrint("not get the focus index by current!!!!!!!! ", DebugLevel.ALWAYS);
                for (var j = 0; j < chl_g_channelTypeList.length; j++) {
                    if (chl_g_channelInfo.folderUuid == chl_g_channelTypeList[j].uid) {
                        if (!chl_g_channelTypeList[j].get) {
                            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                            chl_data_getChannelList(j, 0);
                            break;
                        }
                    }
                }
            }
            for (var i = 0; i < chl_g_dpm_list.length; i++) {
                if (chl_g_dpm_list[i].name == "showAudioOnly") {
                    chl_g_dpm_list.splice(i, 1);
                    break;
                }
            }
            var info = {};
            info.name = "showAudioOnly";
            info.callback = "showAudioOnly";
            chl_g_dpm_list.push(info);
            if (chl_g_blank_showStatus && chl_getKeyManager() == "blankPage") {
                chl_showAudioOnly();
            }
        }
    } else {
        chl_g_switchChannelNum = chl_g_channelInfo.uid;
        if (array1[1] == 0) {
            chl_g_searchByPlay = 2;
            chl_g_password.unLock = true;
        }
        chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
        chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
        if (chl_g_typeIndex == null || chl_g_focusIndex == -2) {
            debugPrint("not get the focus index by current!!!!!!!! ", DebugLevel.ALWAYS);
            for (var j = 0; j < chl_g_channelTypeList.length; j++) {
                if (chl_g_channelInfo.folderUuid == chl_g_channelTypeList[j].uid) {
                    if (!chl_g_channelTypeList[j].get) {
                        chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                        chl_data_getChannelList(j, 0);
                        break;
                    }
                }
            }
        }
        var mode = model.hisfactory.getTofactoryOpition();
        debugPrint("chl_showFirstPlayTv  mode:::"+mode,DebugLevel.ALWAYS);
        if(mode == 0){
            model.tvservice.setPlaySuccessLiveTV(1);
            return;
        }
        chl_showFirstPlayTv();
    }
}

function chl_getFirstPlay() {

    var sourceList = model.source.getInputName();
    debugPrint("getFirstPlay:::::::::::::::::::::::::: " + JSON.stringify(sourceList));
//    if (sourceList.length == 0) {
//        debugPrint("getMainPlay  is null !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ");
//        return;
//    }
    var renameList = [];
    // var lockList = [];
    if (sourceList.length > 0) {
        chl_source_uid = [];
        for (var i = 0; i < sourceList.length / 5; i++) {
            chl_source_uid[i] = sourceList[i * 5 + 1];
            renameList[i] = sourceList[i * 5 + 4];
            chl_source_lock[i] = sourceList[i * 5 + 3];
        }
        for (var j = 0; j < renameList.length; j++) {
            if (renameList[j].length > 0) {
                chl_source_uid[j] = renameList[j];
            }
        }
    }
    var value = model.source.getCurrentSource();
    var id = 0;
    if (value >= 48 && value <= 55) {
        id = value - 48;
    }
    if (value >= 0 && value <= 7) {
        id = value;
    }
    debugPrint("current source : " + value);
    var flag = false;

    if (id != 0) {
        flag = true;
    }
    if (flag) {
        chl_g_sourceInfo.uid = id;
        chl_g_sourceInfo.channelNum = value;
        chl_g_sourceInfo.channelName = chl_source_uid[value];
        chl_g_sourceInfo.tvSource = false;
        try {
            chl_showOtherSourceInfoBar(chl_g_sourceInfo, true);
        } catch (e) {
            debugPrint(e.message);
        }
        if (chl_source_lock[id] == 1) {
            var lock = getCurrentLockTime();
            debugPrint("lock:::::::::::::" + lock);
            if (lock && !getMainInputPasswordStatus()) {
                for (var i = 0; i < chl_g_dpm_list.length; i++) {
                    if (chl_g_dpm_list[i].name == "showInputPassword") {
                        chl_g_dpm_list.splice(i, 1);
                        break;
                    }
                }
                var info = {};
                info.name = "showInputPassword";
                info.callback = "chl_showInputPassword";
                chl_g_dpm_list.push(info);
                if (chl_g_blank_showStatus && chl_getKeyManager() == "blankPage") {
                    chl_showInputPassword();
                }
            }
        }
       // pauseHBBTV();
        var mainPlay = model.tvservice.getMainPlay();
        debugPrint("mainPlay hdmi1 : " + JSON.stringify(mainPlay), DebugLevel.ALWAYS);
        chl_g_channelInfo = {};
        chl_g_channelInfo.folderUuid = mainPlay[0];
        chl_g_channelInfo.uid = mainPlay[1];
        chl_g_channelInfo.channelNum = mainPlay[2];
        chl_g_channelInfo.channelName = mainPlay[3];
        chl_g_channelInfo.isLock = chl_isLocked(mainPlay[4]);
        chl_g_channelInfo.isEncrypt = chl_isEncrypted(mainPlay[4]);
        chl_g_channelInfo.isFav = chl_isFav(mainPlay[4]);
        chl_g_channelInfo.tvType = mainPlay[5];
        chl_g_channelInfo.playId = mainPlay[6];
        chl_g_sourceInfo.tvType = chl_g_channelInfo.tvType;
        chl_g_switchChannelNum = chl_g_channelInfo.uid;
        chl_data_getChannelTypeList();

    } else {
        chl_getNowEpg_status = false;
        chl_g_sourceInfo.uid = id;
        chl_g_sourceInfo.tvSource = true;
        var mainPlay = model.tvservice.getMainPlay();
        debugPrint("mainPlay : " + JSON.stringify(mainPlay), DebugLevel.ALWAYS);
        if (mainPlay.length == 0) {
            chl_data_getChannelTypeList();
            return;
        }
        chl_data_getChannelTypeList();
        //chl_getNoSignalMainChanged(null);
        chl_g_sourceInfo.channelNum = mainPlay[2];
        chl_g_sourceInfo.channelName = mainPlay[3];
        var lockStatus = model.tvservice.getLockStatus();
        debugPrint("lockStatus : " + lockStatus);
       // var lockStatus = 0;
        chl_g_channelInfo = {};
        chl_g_channelInfo.folderUuid = mainPlay[0];
        chl_g_channelInfo.uid = mainPlay[1];
        chl_g_channelInfo.channelNum = mainPlay[2];
        chl_g_channelInfo.channelName = mainPlay[3];
        chl_g_channelInfo.isLock = chl_isLocked(mainPlay[4]);
        chl_g_channelInfo.isEncrypt = chl_isEncrypted(mainPlay[4]);
        chl_g_channelInfo.isFav = chl_isFav(mainPlay[4]);
        chl_g_channelInfo.tvType = mainPlay[5];
        chl_g_channelInfo.playId = mainPlay[6];
        chl_g_sourceInfo.tvType = chl_g_channelInfo.tvType;
        chl_g_switchChannelNum = chl_g_channelInfo.uid;
        debugPrint("current!!!!!!!!!!!!: " + chl_g_channelInfo.channelNum);
        var playStatus = model.tvservice.getPlaySuccessLiveTV();
        debugPrint("current!!!!!!!!!!!! playStatus: " + playStatus);
        if (lockStatus != 0) {
            if (!getMainInputPasswordStatus()) {
                for (var i = 0; i < chl_g_dpm_list.length; i++) {
                    if (chl_g_dpm_list[i].name == "showInputPassword") {
                        chl_g_dpm_list.splice(i, 1);
                        break;
                    }
                }
                var info = {};
                info.name = "showInputPassword";
                info.callback = "chl_showInputPassword";
                chl_g_dpm_list.push(info);
                chl_g_password.unLock = false;
                if (chl_g_blank_showStatus && chl_getKeyManager() == "blankPage") {
                    chl_showInputPassword();
                }
            }
        }
        playStatus = 1;
        if (playStatus == 1) {
            chl_showInfoBar(chl_g_channelInfo);
            //if (chl_g_channelInfo.tvType != CHL_ATV) {
            for (var j = 0; j < chl_g_dpm_list.length; j++) {
                if (chl_g_dpm_list[j].name == "showNoSignal") {
                    return;
                }
            }
            if (!chl_g_password.unLock) {
                return;
            }
            model.tvservice.getChannelNowPfInfo();
            model.tvservice.getChannelNowPfInfoCallBack = chl_data_getDtvNowInfo;
            model.tvservice.getChannelNextPfInfo();
            model.tvservice.getChannelNextPfInfoCallBack = chl_data_getDtvNextInfo;
            //setTimeout(chl_showInfoBarRight, 2000);
            chl_g_epgNow = null;
            chl_g_epgNext = null;
            chl_g_timer.showInfoBarNoInforTimer = setTimeout(function () {
                chl_showInfoBarRight(true, true, true);
            }, 3000);
            //}
        } else {
            chl_showFirstPlayTv();
        }
    }
}


function chl_data_getDtvNowInfo(id, value) {
    debugPrint("chl_data_getDtvNowInfo::::::::::" + JSON.stringify(value), DebugLevel.ALWAYS);
//    if (chl_g_channelInfo.tvType == CHL_ATV){
//        return;
//    }
    if (value.length > 0) {
        //if(value[0].length==0 || value[1].length==0 || value[3].length==0 ){
        //    return;
        //}else{
        chl_g_epgNow = {};
        chl_g_epgNow.startTime = value[0];
        chl_g_epgNow.endTime = value[1];
        if (value[2].length == 0) {
            chl_g_epgNow.cc = 0;
        } else {
            chl_g_epgNow.cc = value[2];
        }
        chl_g_epgNow.title = value[3];
        chl_g_epgNow.detail = value[4];
        chl_g_epgNow.parentalRating = value[5];
        if (chl_g_timer.showInfoBarTimer != null && (chl_g_infoBar_mode == CHL_INFO_NORMAL || chl_g_infoBar_mode == CHL_INFO_NOPROGRAM)) {
            if (chl_g_password.unLock) {
                chl_g_infoBar_mode = 0;
                chl_showInfoBarRight(true, false,false);
                chl_getNowEpg_status = true;
            }
        }
        // }
    }

}

function chl_data_getDtvNextInfo(id, value) {
    debugPrint("chl_data_getDtvNextInfo::::::::::" + JSON.stringify(value), DebugLevel.ALWAYS);
//    if (chl_g_channelInfo.tvType == CHL_ATV){
//        return;
//    }
    if (value.length > 0) {
        if (value[0].length == 0 || value[1].length == 0 || value[3].length == 0) {
            return;
        }
        //chl_getNowEpg_status = true;
        chl_g_epgNext = {};

        chl_g_epgNext.startTime = value[0];
        chl_g_epgNext.endTime = value[1];
        chl_g_epgNext.cc = value[2];
        chl_g_epgNext.title = value[3];
        chl_g_epgNext.detail = value[4];
        chl_g_epgNext.parentalRating = value[5];
        if (chl_g_timer.showInfoBarTimer != null) {
            debugPrint("chl_data_getDtvNextInfo::::::::::" + chl_g_infoBar_mode, DebugLevel.ALWAYS);
            if (chl_g_infoBar_mode == CHL_INFO_NOW) {
                if (chl_g_password.unLock) {
                    if (chl_g_epgNow.title.length > 0) {
                        chl_ui_showInfoBarRightNext(chl_g_epgNext);
                    }
                }
            }
        }
    }

}


function chl_getTvVideoFormatInfo() {
    var value = model.tvservice.getMainPlayVideoFormatInfo();
    debugPrint("chl_getTvVideoFormatInfo:::::::" + value);
    var info = {};
    info.hd_str = " ";
    info.wide_str = " ";
    if (value.length > 0) {
        var array = value.split(",");
        if (array.length > 0) {
            info.hd_str = array[0];
            info.wide_str = array[1];
        }
    }
    return info;
}
function chl_getTvAudioFormatInfo() {
    var value = model.tvservice.getMainPlayAudioFormatInfo();
    var info = {};
    info.str = "";
    info.dolby = "";
    if (value.length > 4) {
        var array = value.split("/");
        if (array.length > 0) {
            if (array.length == 2) {
                info.str = value;
                info.dolby = "X";
            } else if (array.length == 3) {
                info.str = array[0] + "/" + array[1];
                info.dolby = array[2];
            }
        } else {
            info.str = value;
            info.dolby = "X";
        }
    }
    return info;
}

function chl_updateCurrentChannelList() {
    for (var j = 0; j < chl_g_channelTypeList.length; j++) {
        if (chl_g_channelInfo != null && chl_g_channelInfo.folderUuid == chl_g_channelTypeList[j].uid) {
            debugPrint("get current channel  list!!!!!!!!!!!!!!!!!!!!!!" + Date.now());
            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
            chl_data_getChannelList(j, 0);
            break;
        }
        if (j == chl_g_channelTypeList.length - 1) {
            // chl_g_channelInfo = null;
            //chl_searchUpdateCurrent = false;
            for(var i = 0; i < chl_g_channelTypeList.length; i++){
                if(chl_g_channelTypeList[i].uid != null){
                    chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                    chl_data_getChannelList(i, 0);
                    return;
                }
            }
            chl_g_getChlistFinish = true;
            chl_g_getChlistStaus = CHL_GET_DEFAULT;
            chl_g_focusIndex = 0;
            chl_g_typeIndex = chl_data_getChannelTypeListIndex(0);
            debugPrint("the current play channel is not exits in the channel list!!!!!!!!!!!!!!!!!!!!!!!", DebugLevel.ALWAYS);
        }
    }
}

function chl_data_firstGetChannelList(name) {
    debugPrint("chl_data_firstGetChannelList:" + name);
    var delFlag = false;
    try {
        for (var n = chl_g_channelList.length - 1; n >= 0; n--) {
            delFlag = false;
            for (var j = 0; j < chl_g_channelTypeList.length; j++) {
                if (chl_g_channelList[n].type == chl_g_channelTypeList[j].uid) {
                    delFlag = true;
                    break;
                }
            }
            if (!delFlag) {
                chl_g_channelList.splice(n, 1);
            }
        }
    } catch (e) {
        debugPrint(e.message);
    }
    try {
        if (name == null) {
            chl_updateCurrentChannelList();
        } else {
            for (var i = 0; i < chl_g_channelTypeList.length; i++) {
                if(chl_g_channelInfo != null && chl_g_channelInfo.folderUuid == chl_g_channelTypeList[i].uid){
                    if(!chl_g_channelTypeList[i].get){
                        chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                        chl_data_getChannelList(i, false);
                        return;
                    }
                }else if(chl_g_channelInfo == null && chl_g_tunerMode == chl_g_channelTypeList[i].uid){
                    chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                    chl_data_getChannelList(i, false);
                    return;
                }
            }
            for (var i = 0; i < chl_g_channelTypeList.length; i++) {
                if (chl_g_channelTypeList[i].name == name) {
                    debugPrint("chl_updateChannelListForSearchByName:" + name);
                    chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
                    chl_data_getChannelList(i, false);
                    break;
                }
            }
        }
    } catch (e) {
        debugPrint(e.message);
    }

}

function chl_data_onFavoriteListIteratorEvent(event) {

    if (event.type == TableIterator.EVENT_TYPE_ROWS_READ) {
        debugPrint('notify: chl_data_onFavoriteListIteratorEvent:' + JSON.stringify(event), DebugLevel.ALWAYS);
        //m_favoritelistIterator.seekToRow(0, TableIterator.SEEK_SET);
        var i = 0;
        var j = 0;
        if (event.rows.length > 0) {
            debugPrint('notify: chl_g_channelTypeList.length:' + chl_g_channelTypeList.length + ":" + event.rows.length);
            if (chl_g_channelTypeList.length <= 0) {
                chl_g_channelTypeList = [];
                var index = 0;
                for (i = 0; i < event.rows.length; i++) {
                    index = chl_g_channelTypeList.length;
                    chl_g_channelTypeList[index] = {};
                    chl_g_channelTypeList[index].name = event.rows[i][0];
                    // debugPrint('notify name:'+event.rows[i][0]+"</b2>");
                    chl_g_channelTypeList[index].uid = event.rows[i][1];
                    chl_g_channelTypeList[index].attr = event.rows[i][2];
//
                    if (event.rows[i][3] == 1) {
                        chl_g_channelTypeList[index].display = true;
                    } else {
                        chl_g_channelTypeList[index].display = false;
                    }
                }
                chl_data_firstGetChannelList(null);
            }
            else {
                var del = true;
                for (j = chl_g_channelTypeList.length-1; j >= 0; j--) {
                    del = true;
                    for (i = 0; i < event.rows.length; i++) {
                        if (chl_g_channelTypeList[j].uid == event.rows[i][1]) {
                            del = false;
                            break;
                        }
                    }
                    if (del) {
                        chl_g_channelTypeList.splice(j, 1);
                    }
                }
                try {
                    var add = true;
                    var addFinally = false;
                    var addName = null;
                    var index = 0;
                    for (i = 0; i < event.rows.length; i++) {
                        add = true;
                        for (j = 0; j < chl_g_channelTypeList.length; j++) {
                            if (chl_g_channelTypeList[j].uid == event.rows[i][1]) {
                                add = false;
                                chl_g_channelTypeList[j].name = event.rows[i][0];
                                chl_g_channelTypeList[j].uid = event.rows[i][1];
                                chl_g_channelTypeList[j].attr = event.rows[i][2];
                                break;
                            }
                        }
                        debugPrint('notify: chl_g_channelTypeList.length:');
                        if (add) {
                            debugPrint('notify: chl_g_channelTypeList.length:');
                            if (!addFinally) {
                                addFinally = true;
                                addName = event.rows[i][0];
                            }
                            index = chl_g_channelTypeList.length;
                            chl_g_channelTypeList[index] = {};
                            chl_g_channelTypeList[index].name = event.rows[i][0];
                            chl_g_channelTypeList[index].uid = event.rows[i][1];
                            chl_g_channelTypeList[index].attr = event.rows[i][2];
                            chl_g_channelTypeList[index].get = false;
                            if (event.rows[i][3] == 1) {
                                chl_g_channelTypeList[index].display = true;
                            } else {
                                chl_g_channelTypeList[index].display = false;
                            }
                        }
                    }
                    chl_data_firstGetChannelList(null);
//                    if(!chl_g_chlNeedToUpdate){
//                        if (addName == null) {
//                            chl_data_firstGetChannelList(addName);
//                        }
//                        else if (addName == "FAV1" || addName == "FAV2" || addName == "FAV3" || addName == "FAV4") {
//                            chl_data_firstGetChannelList(null);
//                        } else {
//                            chl_data_firstGetChannelList(addName);
//                        }
//                    }
                }
                catch (e) {
                    debugPrint(e.message);
                }
            }
        }
    }
    else if (event.type == TableIterator.EVENT_TYPE_UPDATE) {

    }else if (event.type == TableIterator.EVENT_TYPE_SEEK_TO_ROW) {
    }
}

function chl_data_getChannelTypeList() {
    try {
        readFavoriteLists(chl_data_onFavoriteListIteratorEvent);
    } catch (e) {
        debugPrint(e.message);
    }
}


function chl_isLocked(attr) {
    if (attr & (1 << 8)) {
        return true;
    }
    else {
        return false;
    }
}

function chl_isVisible(attr) {
    if (attr & (1 << 15)) {
        return false;
    }
    else {
        return true;
    }
}
function chl_isEncrypted(attr) {
    if (attr & (1 << 11)) {
        return true;
    }
    else {
        return false;
    }
}
function chl_isFav(attr) {
    if (attr & (1 << 4)) {
        return true;
    }
    else {
        return false;
    }
}
function chl_isHD(attr) {
    if (attr & (1 << 2)) {
        return true;
    }
    else {
        return false;
    }
}

function chl_isSkip(attr) {
    if (attr & (1 << 3)) {
        return false;
    }
    else {
        return true;
    }
}

function chl_refreshChannelTypeIndex(uid) {
    //debugPrint("chl_refreshChannelTypeIndex:::  " + chl_g_channelInfo.folderUuid);
    if (chl_g_channelInfo != null) {
        chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
        chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.uid);
    }else{
        var info = null;
        for (var i = 0; i < chl_g_channelList.length; i++) {
            if (chl_g_channelList[i].type == uid) {
                if (chl_g_channelList[i].list.length > 0) {
                    info = chl_g_channelList[i].list[0];
                    break;
                }
            }
        }
        if(info!=null){
            chl_g_channelInfo = {};
            chl_g_channelInfo.folderUuid = uid;
            chl_g_channelInfo.uid = info.uid;
            chl_g_channelInfo.channelNum = info.channelNum;
            chl_g_channelInfo.channelName = info.channelName;
            chl_g_channelInfo.isLock = info.isLock;
            chl_g_channelInfo.tvType = info.tvType;
            chl_g_typeIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
            chl_g_focusIndex = chl_data_getFocusChannelIndex(chl_g_channelInfo.channelNum);
            chl_g_switchChannelNum = info.uid;
        }
    }
    if (chl_g_focusIndex == -2) {
        chl_g_focusIndex = 0;
        if (chl_g_typeIndex != null && chl_g_channelList[chl_g_typeIndex].list.length > 0) {
            chl_g_switchChannelNum = chl_g_channelList[chl_g_typeIndex].list[0].uid;
        }
    }
    chl_g_getChlistFinish = true;
    chl_g_getChlistStaus = CHL_GET_DEFAULT;
    debugPrint("chl_refreshChannelTypeIndex:::  " + chl_g_typeIndex + "focus:" + chl_g_focusIndex);
}

function chl_data_getChannelListFinishProcess(uid) {

    if (chl_g_wantShow != null) {
        chl_g_wantShow.call(null, uid);
    }
}

function chl_refreshChannelList(uid) {
    if (chl_g_timer.showChannelListTimer == null) {
        chl_g_getChlistFinish = true;
        chl_g_getChlistStaus = CHL_GET_DEFAULT;
        if (chl_g_channelInfo != null) {
            if (chl_g_channelInfo.folderUuid == uid) {
                chl_g_typeIndex = chl_data_getChannelTypeListIndex(uid);
            }
        }
        return;
    }
    debugPrint("chl_refreshChannelList:" + uid);
    chl_g_typeIndex = chl_data_getChannelTypeListIndex(uid);
    chl_g_focusIndex = 0;
    clearTimeout(chl_g_timer.showChannelListLeftTimer);
    chl_g_timer.showChannelListLeftTimer = null;
    chl_ui_hideChannelListLeft();
    chl_showChannelList(chl_g_focusIndex);
    chl_g_getChlistFinish = true;
    chl_g_getChlistStaus = CHL_GET_DEFAULT;

}
function chl_playOtherListChannelByNumberKey(uid) {
    debugPrint("chl_playOtherListChannelByNumberKey:" + uid);
    chl_g_getChlistFinish = true;
    var info = null;
    debugPrint("chl_playOtherListChannelByNumberKey: " + chl_g_channelList.length);
    for (var i = 0; i < chl_g_channelList.length; i++) {
        if (chl_g_channelList[i].type == uid) {
            if (chl_g_channelList[i].list.length > 0) {
                for (var j = 0; j < chl_g_channelList[i].list.length; j++) {
                    if (chl_g_channelList[i].list[j].channelNum == chl_g_channelNum) {
                        info = chl_g_channelList[i].list[j];
                        break;
                    }
                }
                break;
            }
        }
    }
    if (info != null) {
        chl_playTv(info, false);
    }
}

function chl_playOtherListChannel(uid) {
    debugPrint("chl_playOtherListChannel:" + uid);
    chl_g_getChlistFinish = true;
    var info = null;
    debugPrint("chl_playOtherListChannel: " + chl_g_channelList.length);
    for (var i = 0; i < chl_g_channelList.length; i++) {
        if (chl_g_channelList[i].type == uid) {
            if (chl_g_channelList[i].list.length > 0) {
                info = chl_g_channelList[i].list[0];
                break;
            }
        }
    }
    if (info != null) {
        chl_playTv(info, false);
    } else {
        setTimeout(chl_getOtherListChannel, 500);
    }

}
function chl_getOtherListChannel() {

    debugPrint("chl_getOtherListChannel***********************");
    var index = chl_getChannelFolderIndexFromViewListNoGet();
    //debugPrint("index:" + index);
    if (index != null) {
        chl_setRefreshChannelInfoCallback(chl_playOtherListChannel);
        chl_data_getChannelList(index, 3);
    }
}

function chl_data_onServiceListIteratorEvent(servicelist, event) {
    debugPrint('chl_data_onServiceListIteratorEvent:' + JSON.stringify(event.type));
    if (event.type == TableIterator.EVENT_TYPE_ROWS_READ) {
        debugPrint('chl_data_onServiceListIteratorEvent:' + event.rows.length);
        try {
            var channelList = {};
            channelList.list = [];
            if (event.rows.length == 0) {
                channelList.type = servicelist.uid;
                channelList.name = servicelist.name;
                channelList.tvType = 0;

                //debugPrint("list name::::::::::::::"+channelList.name);
            } else {
                channelList.type = servicelist.uid;
                channelList.name = chl_data_getChannelTypeListNameByUid(channelList.type);
                channelList.tvType = 0;

            }
            var i = 0;
            for (i = 0; i < event.rows.length; i++) {
                //debugPrint('channel info:' + JSON.stringify(event.rows[i]));
                var info = {}, row = event.rows[i];
                info.channelNum = row[0];
                info.channelName = row[1];

                info.uid = row[2];
                info.playId = row[5];
                info.tvType = row[3];
                info.attr = row[4];
                info.isEncrypt = chl_isEncrypted(row[4]);
                info.isVisible = chl_isVisible(row[4]);
                info.isLock = chl_isLocked(row[4]);
                info.isHD = chl_isHD(row[4]);
                info.isSkip = chl_isSkip(row[4]);
//                if (info.type == 4) {
//                    info.isRadio = false;
//                } else {
//                    info.isRadio = true;
//                }
                info.isFav = chl_isFav(row[4]);
                for (var j = 0; j < chl_g_channelList.length; j++) {
                    if (channelList.type == chl_g_channelList[j].type) {
                        if (info.isVisible && !info.isSkip) {
                            // debugPrint("channel num :"+info.channelNum+":"+info.channelName+":"+info.attr+":"+info.isFav);
                            chl_g_channelList[j].list.push(info);
                           // chl_g_channelListGlobal[j].list.push(_cloneObj(info));

                        }
                    }
                }
                for (var n = 0; n < chl_g_channelListGlobal.length; n++) {
                    if (channelList.type == chl_g_channelListGlobal[n].type) {
                        if (info.isVisible) {
                            // chl_g_channelListGlobal[n].list.push(info);
                            chl_g_channelListGlobal[n].list.push(_cloneObj(info));
                        }
                        break;
                    }
                }
            }
            if (CHL_ITEM_COUNT == event.rows.length)
                m_servicelistIterator.readNextRows(CHL_ITEM_COUNT);
            else {
                debugPrint("get channel list finish!!!!! end time: " + Date.now());
                // m_servicelistIterator.seekToRow(0, TableIterator.SEEK_SET);
                var index = chl_data_getChannelTypeListIndex(channelList.type);
                debugPrint("get all channel list finish len:" + chl_g_channelListGlobal[index].list.length, DebugLevel.ALWAYS);
                debugPrint("get channel list finish len:" + chl_g_channelList[index].list.length, DebugLevel.ALWAYS);
                chl_g_getChlistFinish = true;
                chl_g_getChlistStaus = CHL_GET_DEFAULT;
                chl_data_getChannelListFinishProcess(channelList.type);
            }
        } catch (e) {
            debugPrint(e.message);
        }

    } else if (event.type == TableIterator.EVENT_TYPE_TOTAL_COUNT) {
        debugPrint("list name: " + servicelist.name + "    chl_g_chlCount:" + event.totalCount);
        if (event.totalCount <= 0) {
            chl_g_getChlistFinish = true;
            chl_g_getChlistStaus = CHL_GET_DEFAULT;
            chl_data_getChannelListFinishProcess(servicelist.uid);
        } else {
            m_servicelistIterator.readNextRows(event.totalCount);
        }
    }
}
var chl_g_searchCntStatus = false;
function chl_updateChannelList() {
//    if (flag) {
//        chl_g_currentFav = false;
//        model.tvservice.setPlayFavChannelList(0);
//        if (chl_g_tunerMode == 1 && getNum > 0) {
//            chl_g_searchCntStatus = true;
//            for (var i = 0; i < chl_g_dpm_list.length; i++) {
//                if (chl_g_dpm_list[i].name == "showStartToSearchAntenna") {
//                    chl_g_dpm_list.splice(i, 1);
//                    chl_hideStartToSearchDialog();
//                    break;
//                }
//            }
//        } else if (chl_g_tunerMode == 2 && getNum > 0) {
//            chl_g_searchCntStatus = true;
//            for (var i = 0; i < chl_g_dpm_list.length; i++) {
//                if (chl_g_dpm_list[i].name == "showStartToSearchCable") {
//                    chl_g_dpm_list.splice(i, 1);
//                    chl_hideStartToSearchDialog();
//                    break;
//                }
//            }
//        }
//    } else {
//        chl_g_searchCntStatus = false;
//    }
    chl_g_getChlistFinish = false;
//    for (var j = 0; j < chl_g_channelTypeList.length; j++) {
//        if (chl_g_tunerMode == chl_g_channelTypeList[j].uid) {
//            debugPrint("refresh channel  list!!!!!!!!!!!!!!!!!!!!!!" + Date.now());
//            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
//            chl_data_getChannelList(j, 0);
//            break;
//        }
//    }
    chl_data_getChannelTypeList();
}

function onChannelListNameUpdate(){
    debugPrint("onChannelListNameUpdate", DebugLevel.ALWAYS);
//    for (var j = 0; j < chl_g_channelTypeList.length; j++) {
//        chl_g_channelTypeList[j].get = false;
//    }
    chl_data_getChannelTypeList();
}

function onChannelListUpdate(id){
    debugPrint("onChannelListUpdate::"+id, DebugLevel.ALWAYS);
    for (var i = 0; i < chl_g_channelTypeList.length; i++) {
        if(id == chl_g_channelTypeList[i].uid){
             chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
             chl_data_getChannelList(i, false);
             return;
        }
    }


}

function chl_updateChannelListForResetParentalLock() {
    for (var i=0;i<=7;i++) {
        chl_source_lock[i] = 0;
    }
    for (var j = 0; j < chl_g_channelTypeList.length; j++) {
        chl_g_channelTypeList[j].get = false;
    }
    chl_updateCurrentChannelList();
}
function chl_data_getChannelList(i, flag) {
    debugPrint('chl_data_getChannelList name:' + chl_g_channelTypeList[i].name);
    if(chl_g_getChlistStaus == CHL_GET_ING){
        return;
    }
    chl_g_channelTypeList[i].get = true;
    chl_g_getChlistFinish = false;
    chl_g_getChlistStaus = CHL_GET_ING;
    var chl_flag = 0;
    var channelList = {};
    channelList.list = [];
    channelList.type = chl_g_channelTypeList[i].uid;
    channelList.name = chl_g_channelTypeList[i].name;
    var list = {};
    list.list = [];
    list.type = chl_g_channelTypeList[i].uid;
    list.name = chl_g_channelTypeList[i].name;

    for (var n = 0; n < chl_g_channelList.length; n++) {
        if (chl_g_channelTypeList[i].uid == chl_g_channelList[n].type) {
            chl_g_channelList[n].list=[];
            chl_g_channelListGlobal[n].list=[];
            chl_flag = 1;
            break;
        }
    }
    if(chl_flag == 0)
    {
        chl_g_channelList.push(channelList);
        chl_g_channelListGlobal.push(list);
    }
    selectServiceList(chl_g_channelTypeList[i], chl_data_onServiceListIteratorEvent);

}


function chl_data_getChannelTypeListIndex(uid) {
    //debugPrint("chl_data_getChannelTypeListIndex: "+uid);
    var i = 0;
    var index = null;
    debugPrint("chl_data_getChannelTypeListIndex: " + chl_g_channelList.length);
    if (chl_g_channelList.length > 0) {
        for (i = 0; i < chl_g_channelList.length; i++) {
            //debugPrint("uid: "+chl_g_channelList[i].type);
            if (chl_g_channelList[i].type == uid) {
                index = i;
                break;
            }
        }
    }
    return index;
}

function chl_getCurrentListIsDisplay(uid) {
    for (var i = 0; i < chl_g_channelTypeList.length; i++) {
        if (chl_g_channelTypeList[i].uid == uid) {
            return chl_g_channelTypeList[i].display;
        }
    }
    return true;
}

function chl_getChannelFolderIndexFromViewListNoGet() {
    var index = null;
    var info = null;
    for (var i = 0; i < chl_g_channelTypeList.length - 1; i++) {
        if (chl_g_channelTypeList[i].display && !chl_g_channelTypeList[i].get) {
            index = i;
            break;
        }
    }
    return index;
}

function chl_getChannelListIndexFromViewList() {
    var i = 0;
    var index = null;
    for (i = 0; i < chl_g_channelTypeList.length - 1; i++) {
        if (chl_g_channelTypeList[i].display && chl_g_channelTypeList[i].get) {
            for (var j = 0; j < chl_g_channelList.length; j++) {
                if (chl_g_channelTypeList[i].uid == chl_g_channelList[j].type) {
                    index = j;
                    break;
                }
            }
            break;
        }
    }
    return index;
}

function chl_getChannelInfoFromViewList() {
    var i = 0;
    var info = null;
    for (i = 0; i < chl_g_channelTypeList.length - 1; i++) {
        if (chl_g_channelTypeList[i].display && chl_g_channelTypeList[i].get) {
            for (var j = 0; j < chl_g_channelList.length; j++) {
                if (chl_g_channelTypeList[i].uid == chl_g_channelList[j].type) {
                    if (chl_g_channelList[j].list.length > 0) {
                        info = chl_g_channelList[j].list[0];
                    }
                    break;
                }
            }
            break;
        }
    }
    return info;
}

function chl_data_getGlobalChannelTypeListIndex(uid) {
    var i = 0;
    var index = null;
    debugPrint("chl_data_chl_g_channelListGlobal: " + chl_g_channelListGlobal.length);
    if (chl_g_channelListGlobal.length > 0) {
        for (i = 0; i < chl_g_channelListGlobal.length; i++) {
            //debugPrint("uid: "+chl_g_channelList[i].type);
            if (chl_g_channelListGlobal[i].type == uid) {
                index = i;
                break;
            }
        }
    }
    return index;
}
function chl_data_getAllChannelList() {
    var index = null;
    if (chl_g_channelInfo != null) {
        index = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
    }
    if (index != null) {
        return chl_g_channelListGlobal[index].list;
    }
    return null;
}

function chl_data_refreshChannelTypeList(uid,display){
    for (var i = 0; i < chl_g_channelTypeList.length; i++) {
        if (chl_g_channelTypeList[i].uid == uid) {
            chl_g_channelTypeList[i].display = display;
        }
    }
}

function chl_data_refreshChannelList(uid) {
    var n = 0;
    var channelIndex = 0;
    var favIndex = 0;
    //debugPrint("channelList:"+JSON.stringify(chl_g_channelList));
    debugPrint("chl_data_refreshChannelList!!!!!!!!!!!!!!!!!:");
    for (n = 0; n < chl_g_channelList.length; n++) {
        if (chl_g_channelList[n].type == uid) {
            chl_g_channelList[n].list = [];
            //channelIndex = n;
        }
    }
    for(n = 0; n < chl_g_channelTypeList.length; n++){
        if(chl_g_channelTypeList[n].uid == uid){
            chl_setRefreshChannelInfoCallback(chl_refreshChannelTypeIndex);
            chl_data_getChannelList(n,false);
        }
    }
}

function chl_data_getFocusChannelIndexByUid(folderIndex, uid) {
    var index = 0;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return -1;
    }
    if (folderIndex >= chl_g_channelList.length) {
        return -1;
    }
    for (i = 0; i < chl_g_channelList[folderIndex].list.length; i++) {
        if (chl_g_channelList[folderIndex].list[i].uid == uid) {
            index = i;
            break;
        }
    }
    return index;
}

function chl_data_getFocusGlobalChannelIndexByUid(folderIndex, uid) {
    var index = 0;
    var i = 0;
    if (chl_g_channelListGlobal.length == 0) {
        return -1;
    }
    if (folderIndex >= chl_g_channelListGlobal.length) {
        return -1;
    }
    for (i = 0; i < chl_g_channelListGlobal[folderIndex].list.length; i++) {
        if (chl_g_channelListGlobal[folderIndex].list[i].uid == uid) {
            index = i;
            break;
        }
    }
    return index;
}

function chl_data_setChannelLockInfo(channelUid, flag) {
    var folderIndex = null;
    if (chl_g_channelInfo != null) {
        folderIndex = chl_data_getChannelTypeListIndex(chl_g_channelInfo.folderUuid);
    }
    if (folderIndex != null && folderIndex >= chl_g_channelList.length) {
        return;
    }

    var channelIndex = chl_data_getFocusChannelIndexByUid(folderIndex, channelUid);
    if (channelIndex == -1) {
        return;
    }
    if (channelIndex >= chl_g_channelList[folderIndex].list.length) {
        return;
    }
    chl_g_channelList[folderIndex].list[channelIndex].isLock = flag;

    var g_folderIndex = chl_data_getGlobalChannelTypeListIndex(chl_g_channelInfo.folderUuid);
    if (g_folderIndex >= chl_g_channelListGlobal.length) {
        return;
    }

    var g_channelIndex = chl_data_getFocusGlobalChannelIndexByUid(g_folderIndex, channelUid);
    if (g_channelIndex == -1) {
        return;
    }
    if (g_channelIndex >= chl_g_channelListGlobal[g_folderIndex].list.length) {
        return;
    }
    chl_g_channelListGlobal[g_folderIndex].list[g_channelIndex].isLock = flag;

    debugPrint("set ChannelLockInfo  end!!!");
}

function chl_data_getFocusChannelIndex(num) {
    var index = -2;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return -1;
    }
    if (chl_g_typeIndex == null) {
        return -1;
    }
    if (chl_g_typeIndex >= chl_g_channelList.length) {
        return -1;
    }
    for (i = 0; i < chl_g_channelList[chl_g_typeIndex].list.length; i++) {
        if (chl_g_channelList[chl_g_typeIndex].list[i].uid == num) {
            index = i;
            break;
        }
    }
    return index;
}

function chl_data_getMaxChannelNum() {
    var tmpNum = 0;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return 0;
    }
    if (chl_g_typeIndex >= chl_g_channelList.length) {
        return 0;
    }
    try {
        tmpNum = chl_g_channelList[chl_g_typeIndex].list[0].channelNum.length;
        //debugPrint("tmp:"+tmpNum );
        for (i = 0; i < chl_g_channelList[chl_g_typeIndex].list.length; i++) {
            //debugPrint("tmp:"+chl_g_channelList[chl_g_typeIndex].list[i].channelNum);
            //debugPrint("tmp:"+chl_g_channelList[chl_g_typeIndex].list[i].channelNum.length);
            if (chl_g_channelList[chl_g_typeIndex].list[i].channelNum.length > tmpNum) {
                tmpNum = chl_g_channelList[chl_g_typeIndex].list[i].channelNum.length;
            }
        }
    }
    catch (e) {
        debugPrint(e.message);
    }
    return tmpNum;
}

function chl_data_getChannelInfoByInputNum(num) {
    var info = null;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return null;
    }
    if (chl_g_typeIndex >= chl_g_channelList.length) {
        return null;
    }
    for (i = 0; i < chl_g_channelList[chl_g_typeIndex].list.length; i++) {
        if (chl_g_channelList[chl_g_typeIndex].list[i].channelNum == num) {
            info = chl_g_channelList[chl_g_typeIndex].list[i];
            break;
        }
    }
    return info;
}

function chl_data_getChannelInfoByInputNumForSA(num) {
    var info = null;
    var i = 0;
    var g_folderIndex = 0;
    if (chl_g_channelInfo != null) {
        g_folderIndex = chl_data_getGlobalChannelTypeListIndex(chl_g_channelInfo.folderUuid);
    }else{
        return null;
    }
    if (g_folderIndex >= chl_g_channelListGlobal.length || g_folderIndex==null) {
        return null;
    }
    for (i = 0; i < chl_g_channelListGlobal[g_folderIndex].list.length; i++) {
        if (chl_g_channelListGlobal[g_folderIndex].list[i].channelNum == num) {
            info = chl_g_channelListGlobal[g_folderIndex].list[i];
            break;
        }
    }
    return info;
}

function chl_data_getChannelInfoByNum(num) {

    var info = null;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return null;
    }
    if (chl_g_typeIndex >= chl_g_channelList.length) {
        return null;
    }
    for (i = 0; i < chl_g_channelList[chl_g_typeIndex].list.length; i++) {
        if (chl_g_channelList[chl_g_typeIndex].list[i].uid == num) {
            info = chl_g_channelList[chl_g_typeIndex].list[i];
            break;
        }
    }
    return info;
}

function chl_data_getNextChannelInfo(num) {
    var info = null;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return null;
    }
    if (chl_g_typeIndex >= chl_g_channelList.length) {
        return null;
    }

    for (i = 0; i < chl_g_channelList[chl_g_typeIndex].list.length; i++) {
        if (chl_g_channelList[chl_g_typeIndex].list[i].uid == num) {
            if (i == chl_g_channelList[chl_g_typeIndex].list.length - 1) {
                info = chl_g_channelList[chl_g_typeIndex].list[0];
            } else {
                info = chl_g_channelList[chl_g_typeIndex].list[i + 1];
            }
            break;
        }
    }
    return info;
}

function chl_data_getPreChannelInfo(num) {
    var info = null;
    var i = 0;
    if (chl_g_channelList.length == 0) {
        return null;
    }
    if (chl_g_typeIndex >= chl_g_channelList.length) {
        return null;
    }
    for (i = 0; i < chl_g_channelList[chl_g_typeIndex].list.length; i++) {
        if (chl_g_channelList[chl_g_typeIndex].list[i].uid == num) {
            if (i == 0) {
                info = chl_g_channelList[chl_g_typeIndex].list[chl_g_channelList[chl_g_typeIndex].list.length - 1];
            } else {
                info = chl_g_channelList[chl_g_typeIndex].list[i - 1];
            }
            break;
        }
    }
    return info;
}

function chl_data_getChannelTypeListNameByUid(uid) {
    var i = 0;
    var name = "";
    if (chl_g_channelTypeList.length > 0) {
        for (i = 0; i < chl_g_channelTypeList.length; i++) {
            if (chl_g_channelTypeList[i].uid == uid) {
                name = chl_g_channelTypeList[i].name;
                break;
            }
        }
    }
    return name;
}


function chl_showProgramDetail(info) {
    // prgrmDetail.openPage('blankPage', info);
    if (!hiWebOsFrame.prgrmDtlPage) {
        hiWebOsFrame.createPage('prgrm_detail_page', null, null, null, function (pageDetail) {
            hiWebOsFrame.prgrmDtlPage = pageDetail;
            prgrmDetail.openPage('blankPage', info);

        });
    }
    else {
        prgrmDetail.openPage('blankPage', info);
    }
}
/*
* 获取当前节目信息
* 返回：
*   当前播放的节目的信息
* */
function getCurrentDTVPragramInfo(keyValue)
{
    debugPrint("get current DTV info!");
    model.tvservice.getChannelNowPfInfo();
    debugPrint("get current DTV info sucessfully!");
    model.tvservice.getChannelNowPfInfoCallBack = getDtvNowInfoForPvr.bind(this, keyValue);
}
/*
* 实现获取当前播放的DTV信息
* */
function getDtvNowInfoForPvr(keyValue, id, value)
{
    debugPrint("keyValue: " +  keyValue);
    debugPrint("DTV now info: " + JSON.stringify(value));
    var curprgrm = null;
    try
    {
        if (!!value && value.length > 0)
        {
            curprgrm = {};
            curprgrm.startTime = value[0];
            curprgrm.endTime = value[1];
            curprgrm.title = value[3];
            debugPrint("current DTV pragram info:" + JSON.stringify(curprgrm));
        }
        chl_startPVRTShiftDialog(curprgrm, keyValue);
    }
    catch (ex)
    {
        debugPrint('current DTV pragram info error:' + ex, DebugLevel.ERROR);
    }
}

//} catch(e){
//    debugPrint("blankPage file has something wrong!!!!!!!!!!!"+e.message, DebugLevel.ERROR);
//}
